window.__require=function e(t,n,a){function o(i,c){if(!n[i]){if(!t[i]){var s=i.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+i+"'")}i=s}var d=n[i]={exports:{}};t[i][0].call(d.exports,function(e){return o(t[i][1][e]||e)},d,d.exports,e,t,n,a)}return n[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<a.length;i++)o(a[i]);return o}({PrincessPea_Cfg:[function(e,t,n){"use strict";var a;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"3a3b8IaP/VEJIIkPhsa352g","PrincessPea_Cfg");var r={symbol:(a={},o(a,1,{node:"s1",win_node:"w1",win_ani:{name:"Wild",zIndex:300}}),o(a,2,{node:"s2",win_node:"w2",stop_ani:{name:"LoveForever_Intro1",zIndex:400},idle_ani:{name:"LoveForever_Loop2",zIndex:400}}),o(a,3,{node:"s3",win_node:"w3",win_ani:{name:"",zIndex:300},stop_ani:{name:"XiaoTaoXin_F_Intro",zIndex:400},idle_ani:{name:"XiaoTaoXin_F_Loop2",zIndex:400}}),o(a,4,{node:"s4",win_node:"w4",win_ani:{name:"H1",zIndex:300}}),o(a,5,{node:"s5",win_node:"w5",win_ani:{name:"H2",zIndex:300}}),o(a,6,{node:"s6",win_node:"w6",win_ani:{name:"H3",zIndex:300}}),o(a,7,{node:"s7",win_node:"w7",win_ani:{name:"H4",zIndex:300}}),o(a,8,{node:"s8",win_node:"w8",win_ani:{name:"H5",zIndex:300}}),o(a,9,{node:"s9",win_node:"w9",win_ani:{name:"L1",zIndex:300}}),o(a,10,{node:"s10",win_node:"w10",win_ani:{name:"L2",zIndex:300}}),o(a,11,{node:"s11",win_node:"w11",win_ani:{name:"L3",zIndex:300}}),o(a,12,{node:"s12",win_node:"w12",win_ani:{name:"L4",zIndex:300}}),o(a,301,{node:"s301",win_node:"w3",win_ani:{name:"",zIndex:300},stop_ani:{name:"XiaoTaoXin_J_Intro",zIndex:400},idle_ani:{name:"XiaoTaoXin_J_Loop2",zIndex:400}}),a),wildId:1,scatterId:2,bonusId:3,freeId:301,scripts:{Top:"LMSlots_Top_Base",Bottom:"LMSlots_Bottom_Base",Slots:"PrincessPea_Slots",Reels:"PrincessPea_Reel",Symbols:"PrincessPea_Symbol"},col:5,row:4,symbolPrefab:"LMSlots_Symbol",symbolSize:{height:104},help_prefab:"games/PrincessPea/prefab/LMSlots_Help_prefab",helpItems:["games/PrincessPea/prefab/LMSlots_Help_item1","games/PrincessPea/prefab/LMSlots_Help_item2","games/PrincessPea/prefab/LMSlots_Help_item3"],autoModelDelay:1,randomSymbols:[1,3,4,5,6,7,8,9,10,11,12],randomSymbolsBySkip:[1,3,4,5,6,7,8,9,10,11,12],kuang:"kuang",speed:1800,reelStopInter:.3,auto_stop_time:1.2,bounce:!0,normalBgm:"ngbgm",AddAntiTime:2.4,reelStateInfo:[{inNormal:!0,id:[3,301],mini:2,counts:[0,0,0,0,1],antiNode:"node_anti",path:"games/PrincessPea/",reelStopSound:"reelstop",symbolStopSound:"reelchip",antSound:"reelfast",antSpeed:2e3}],isEnergyId:function(e){return 3==e},NeedIdleIds:[],StoreItemType:{freeCnt:1,stickyWild:2,randWild:3,roamingWilds:4,removeSymbol:5,extraBonus:6,multWild:7,stickyWildAndRemoveSymbol:8,randomWildAndRemoveSymbol:9,roamingWildAndRemoveSymbol:10,extraBonusAndMultBonus:11}};t.exports=r,cc._RF.pop()},{}],PrincessPea_Character:[function(e,t,n){"use strict";function a(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"68c2cjRNdZBEYygA4eEPWB1","PrincessPea_Character"),cc.Class({extends:cc.Component,properties:{spine_role:sp.Skeleton},hide:function(){this.node.active=!1},show:function(){this.node.active=!0},onLoad:function(){},start:function(){},collectLove:function(e){return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 9:case"end":return e.stop()}},e)}))()}}),cc._RF.pop()},{}],PrincessPea_Collect:[function(e,t,n){"use strict";function a(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"93c22AAcbpEAYHh2Qn5HOcL","PrincessPea_Collect"),cc.Class({extends:cc.Component,properties:{head:cc.Node,tail:cc.Node,progressBar:cc.Node,bar:cc.Node,collect_lock:cc.Node,spine_collect_unlock:sp.Skeleton,tips:cc.Node,stuff_template:cc.Node,stuff_particle:cc.Node,_isOpen:!1,_stuffArr:[]},onLoad:function(){this._initListener()},start:function(){var e=this;this.scheduleOnce(function(){e._init()})},_initListener:function(){var e=this;Global.registerEvent(cc.vv.gameData._EventId.SLOT_TOTALBET_UPDATED,function(){e.showCollect(!1)},this),this.tail.on(cc.Node.EventType.TOUCH_END,this._onEnterHandler.bind(this),this),this.progressBar.on(cc.Node.EventType.TOUCH_END,function(){e._showTips(),e._isOpen||e._openCollect()},this)},_showTips:function(){var e=this;this.tips.active||(this.tips.active=!0,this.tips.opacity=0,cc.tween(this.tips).to(.5,{opacity:255}).delay(2).to(.5,{opacity:0}).call(function(){e.tips.active=!1}).start())},_init:function(){this.setProgress(SlotsFacade.dm.getCollectPercent()),this.showCollect(!0),this._updateEnterBtnIcon()},_onEnterHandler:function(){SlotsFacade.dm.hasFree()||SlotsFacade.bottomCmp.GetSpinBtnState()&&(SlotsFacade.dm.GetAutoModelTime()>0||(SlotsFacade.soundMgr.playEffect("click"),SlotsFacade.bottomCmp.ShowBtnsByState("moveing_1"),SlotsFacade.map.enter(function(){SlotsFacade.bottomCmp.ShowBtnsByState("idle")},!0)))},_openCollect:function(){if(!this._isOpen&&!SlotsFacade.dm.hasFree()&&SlotsFacade.bottomCmp.GetSpinBtnState()){var e=SlotsFacade.dm.GetBetMults(),t=SlotsFacade.dm.getDeskInfo().needBet;if(!(t>e.length)){SlotsFacade.dm.SetBetIdx(t),SlotsFacade.bottomCmp.ShowBetCoin();var n=cc.vv.gameData.GetTotalBet();Global.dispatchEvent(cc.vv.gameData._EventId.SLOT_TOTALBET_UPDATED,n)}}},collectEnergy:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e._stuffArr&&!(e._stuffArr.length<1)){t.next=2;break}return t.abrupt("return");case 2:return SlotsFacade.soundMgr.playEffect("collectFly"),n=e.head.position,e._stuffArr.forEach(function(t){var a=cc.v2(n.x-50,t.y-300);cc.tween(t).then(cc.bezierTo(.5,[a,n,n])).call(function(){t.removeFromParent()}).start();var o=cc.instantiate(e.stuff_particle);o.active=!0,o.parent=e.node,o.position=t.position,cc.tween(o).then(cc.bezierTo(.5,[a,n,n])).call(function(){o.removeFromParent()}).start()}),e._stuffArr=[],t.next=8,SlotsFacade.delayTime(.5);case 8:e._playHeadSpine(),e.setProgress(SlotsFacade.dm.getCollectPercent());case 10:case"end":return t.stop()}},t)}))()},_playHeadSpine:function(){SlotsFacade.soundMgr.playEffect("collectIn");var e=this.head.getChildByName("spine").getComponent(sp.Skeleton);e.setAnimation(0,"ShouJiSuo_Intro",!1),e.addAnimation(0,"ShouJiSuo_Loop",!0)},showCollect:function(e){var t=SlotsFacade.dm.canCollect();t?(this.bar.active=!0,this.collect_lock.active=!1,e||this._isOpen||(SlotsFacade.soundMgr.playEffect("unlock"),this.spine_collect_unlock.node.active=!0,this.spine_collect_unlock.setAnimation(0,"JinDuTiaoJieSuo",!1))):(this.bar.active=!1,this.collect_lock.active=!0,!e&&this._isOpen&&(this.spine_collect_unlock.node.active=!0,this.spine_collect_unlock.setAnimation(0,"JinDuTiaoJieSuo",!1))),this._isOpen=t},playCollectComplete:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return SlotsFacade.soundMgr.playEffect("collectComplete"),(n=e.tail.getChildByName("spine").getComponent(sp.Skeleton)).setAnimation(0,"ShouJiPai_2_Intro",!1),n.addAnimation(0,"ShouJiPai_2_Loop",!0),t.next=6,new Promise(function(e){n.setCompleteListener(function(){n.setCompleteListener(null),e()})});case 6:case"end":return t.stop()}},t)}))()},setProgress:function(e,t){var n=this.progressBar.width,a=e*n-n;if(t){var o=this.bar.getChildByName("spine_bg").getComponent(sp.Skeleton);o.setAnimation(0,"JDT_Intro",!1),o.addAnimation(0,"JDT_Loop",!0),cc.tween(this.bar).to(.5,{x:a}).start()}else this.bar.x=a,0==e&&this._updateEnterBtnIcon()},setEnterEnable:function(e){},_updateEnterBtnIcon:function(){},addAppearanceDrop:function(e){var t=cc.instantiate(this.stuff_template);t.active=!0,t.parent=this.node,t.position=this.node.convertToNodeSpaceAR(e),this._stuffArr.push(t)},hide:function(){this.node.active=!1},show:function(){this.node.active=!0}}),cc._RF.pop()},{}],PrincessPea_FlowCtrl:[function(e,t,n){"use strict";function a(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"dc5dfbr6uRPsJly9iOVlYHR","PrincessPea_FlowCtrl"),cc.Class({extends:cc.Component,enterRoom:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(cc.vv.gameData.GetFreeTime()>0)){t.next=6;break}return n=cc.vv.gameData.GetTotalFreeWin(),SlotsFacade.bottomCmp.SetWin(n),t.next=6,e.enterFreeGame(!0);case 6:return t.next=8,e.enterMap(!0);case 8:return t.next=10,e.enterPickGame(!0);case 10:SlotsFacade.slots.CanDoNextRound();case 11:case"end":return t.stop()}},t)}))()},startMove:function(){return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:SlotsFacade.freeGame.startMove();case 1:case"end":return e.stop()}},e)}))()},onSpinMsg:function(e){return o(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,SlotsFacade.freeGame.onSpinMsg();case 2:SlotsFacade.slots._gameInfo=e,n=e.resultCards,SlotsFacade.slots.SetSlotsResult(n),SlotsFacade.slots.SetReelStateInfo(n);case 6:case"end":return t.stop()}},t)}))()},spinEnd:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.collectEnergy();case 2:return t.next=4,SlotsFacade.freeGame.spinEnd();case 4:return SlotsFacade.slots.ShowWinTrace(),n=cc.vv.gameData.GetGameWin(),a=n,cc.vv.gameData.GetTotalFree()>0&&cc.vv.gameData.GetTotalFree()!=cc.vv.gameData.GetFreeTime()&&(a=cc.vv.gameData.GetGameTotalFreeWin()),t.next=10,new Promise(function(e){SlotsFacade.slots.ShowBottomWin(n,a,!0,e)});case 10:return t.next=12,e.enterPickGame();case 12:return t.next=14,e.enterMap();case 14:return t.next=16,SlotsFacade.delayTime(.5);case 16:if(!SlotsFacade.dm.isTriggerFree()){t.next=33;break}if(o=SlotsFacade.dm.getSpinData().bonusBaseCoin,!SlotsFacade.dm.isFistTriggerFree()){t.next=29;break}return SlotsFacade.soundMgr.playEffect("vo_free"),SlotsFacade.slots.Backup(),t.next=23,SlotsFacade.popup.showWinFreeCnt(SlotsFacade.dm.triggerFreeCnt(),!0,o);case 23:return t.next=25,SlotsFacade.mainPanel.showSceneTransition(2);case 25:return t.next=27,e.enterFreeGame();case 27:t.next=31;break;case 29:return t.next=31,SlotsFacade.popup.showWinFreeCnt(SlotsFacade.dm.triggerFreeCnt(),!1,o);case 31:t.next=44;break;case 33:if(!SlotsFacade.dm.isLastEndFree()){t.next=44;break}return SlotsFacade.bottomCmp.ShowBtnsByState("moveing_1"),SlotsFacade.soundMgr.playEffect("fgend"),t.next=38,SlotsFacade.popup.showWinCoin(SlotsFacade.dm.getFreeWinCoin());case 38:return t.next=40,SlotsFacade.mainPanel.showSceneTransition(2);case 40:return SlotsFacade.freeGame.exit(),SlotsFacade.slots.Resume(),t.next=44,e.enterNormalGame();case 44:SlotsFacade.slots.CanDoNextRound();case 45:case"end":return t.stop()}},t)}))()},enterFreeGame:function(e){return o(regeneratorRuntime.mark(function t(){var n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e&&SlotsFacade.freeGame.reconnect(),SlotsFacade.topCmp.SetBackLobby(!1),SlotsFacade.bottomCmp.ShowBtnsByState("moveing_1"),SlotsFacade.mainPanel.showBg(1),SlotsFacade.soundMgr.playFreeBgm(),n=cc.vv.gameData.GetTotalFree(),a=cc.vv.gameData.GetFreeTime(),SlotsFacade.bottomCmp.ShowFreeModel(!0,n-a,n),SlotsFacade.dm.updateRandomSymbols(),SlotsFacade.collect.hide(),t.next=12,SlotsFacade.delayTime(.5);case 12:case"end":return t.stop()}},t)}))()},enterNormalGame:function(){return o(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(SlotsFacade.dm.updateRandomSymbols(),SlotsFacade.collect.show(),SlotsFacade.bottomCmp.ShowFreeModel(!1),SlotsFacade.mainPanel.showBg(0),SlotsFacade.soundMgr.playBgm("",!0),SlotsFacade.bottomCmp.node.getChildByName("totalBetBg").active=!0,SlotsFacade.freeGame.exit(),!SlotsFacade.dm.isLastEndFree()){e.next=11;break}return t=cc.vv.gameData.GetGameTotalFreeWin(),e.next=11,new Promise(function(e){SlotsFacade.slots.ShowBottomWin(t,t,!0,e)});case 11:case"end":return e.stop()}},e)}))()},collectEnergy:function(){return o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,SlotsFacade.collect.collectEnergy();case 2:case"end":return e.stop()}},e)}))()},enterMap:function(e){return o(regeneratorRuntime.mark(function t(){var n,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(SlotsFacade.dm.energyData.state>0)){t.next=15;break}if(e){t.next=4;break}return t.next=4,SlotsFacade.collect.playCollectComplete();case 4:return SlotsFacade.bottomCmp.ShowBtnsByState("moveing_1"),t.next=7,new Promise(function(e){SlotsFacade.map.enter(e)});case 7:if(!(n=SlotsFacade.dm.energyData.game)||!n.winCoin){t.next=15;break}return a=n.winCoin,SlotsFacade.dm.AddCoin(a),o=a,SlotsFacade.dm.getSpinData()&&(o+=SlotsFacade.dm.GetGameWin()),t.next=15,new Promise(function(e){SlotsFacade.slots.ShowBottomWin(a,o,!0,e)});case 15:case"end":return t.stop()}},t)}))()},enterPickGame:function(e){return o(regeneratorRuntime.mark(function t(){var n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!SlotsFacade.dm.pickBonus){t.next=11;break}return SlotsFacade.topCmp.SetBackLobby(!1),SlotsFacade.bottomCmp.ShowBtnsByState("moveing_1"),t.next=5,new Promise(function(t){SlotsFacade.pickGame.enter(t,e)});case 5:return n=t.sent,SlotsFacade.dm.AddCoin(n),a=n,SlotsFacade.dm.getSpinData()&&(a+=SlotsFacade.dm.GetGameWin()),t.next=11,new Promise(function(e){SlotsFacade.slots.ShowBottomWin(n,a,!0,e)});case 11:case"end":return t.stop()}},t)}))()}}),cc._RF.pop()},{}],PrincessPea_FreeGame:[function(e,t,n){"use strict";function a(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"effb8B0GHxAJpnX+u/O62Pf","PrincessPea_FreeGame");cc.Class({extends:cc.Component,properties:{panel:cc.Node,mask:cc.Node,spine_border:sp.Skeleton,symbols_node:cc.Node,bonus_reel:cc.Node,spine_reel_bg:sp.Skeleton,spine_love_forever:sp.Skeleton,label_free_coin:cc.Label,taoxin_node:cc.Node,spine_taoxin:sp.Skeleton,spine_collect_effect:sp.Skeleton,label_coin:cc.Label,label_free_cnt:cc.Label,collect_coin_particle:cc.Node,collect_love_particle:cc.Node,symbol_template:cc.Node,_symbolArr:null,_data:null},onLoad:function(){this._resetData()},_resetData:function(){this._data={isEnter:!1,bonusCoin:0,freeBaseCoin:0,restFreeCnt:0}},start:function(){},enter:function(){},exit:function(){SlotsFacade.soundMgr.playEffect("reelLightOff"),this._resetData(),SlotsFacade.character.show(),SlotsFacade.collect.show(),this.panel.active=!1,this.mask.active=!1,this.spine_border.node.active=!1,this.taoxin_node.active=!1,this.label_coin.node.active=!1,this.label_coin.string="",this.label_free_cnt.node.active=!1,this.label_free_cnt.string="",this.spine_reel_bg.node.active=!1,this.spine_love_forever.node.active=!1,this.spine_love_forever.node.getChildByName("tip").active=!1,this.label_free_coin.node.active=!1},startMove:function(){this._data.isEnter&&(this.mask.active=!0,this._updateFreeCnt())},_updateFreeCnt:function(){var e=cc.vv.gameData.GetTotalFree(),t=cc.vv.gameData.GetFreeTime();SlotsFacade.bottomCmp.ShowFreeModel(!0,e-t,e),this._data.restFreeCnt=t,this.label_free_cnt.string=t.toString()},onSpinMsg:function(){var e=this;return o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._data.isEnter){t.next=2;break}return t.abrupt("return");case 2:if(!SlotsFacade.dm.GetTotalFree()){t.next=5;break}return e._data.isEnter=!0,t.abrupt("return");case 5:if(!SlotsFacade.dm.getSpinData().bonusTotalCoin){t.next=8;break}return e._data.isEnter=!0,t.abrupt("return");case 8:if(!SlotsFacade.dm.getSpinData().bonusGame){t.next=11;break}return e._data.isEnter=!0,t.abrupt("return");case 11:case"end":return t.stop()}},t)}))()},genASymbol:function(e){var t=cc.instantiate(this.symbol_template);t.active=!0,t.spine=t.getChildByName("spine").getComponent(sp.Skeleton),t.label=t.getChildByName("label").getComponent(cc.Label),t.label_free=t.getChildByName("label_free").getComponent(cc.Label),t.parent=this.symbols_node,e.coin?(t.label.node.active=!0,t.label.string=Global.convertNumToShort(e.coin),t.spine.setAnimation(0,"XiaoTaoXin_F_Loop2",!0)):e.freeCnt&&(t.label_free.node.active=!0,t.label_free.string=e.freeCnt,t.spine.setAnimation(0,"XiaoTaoXin_J_Loop2",!0));var n=SlotsFacade.slots.getIdxGlobalPos(e.idx);return n=this.symbols_node.convertToNodeSpaceAR(n),t.setPosition(n),t},genBonusSymbols:function(){var e=SlotsFacade.dm.getSpinData().bonusInfo;if(e&&!(e.length<1)){this._symbolArr=[],e.sort(function(e,t){var n=(e.idx-1)%5,a=(t.idx-1)%5;return n-a==0?e.idx-t.idx:n-a});for(var t=0;t<e.length;t++){var n=this.genASymbol(e[t]);this._symbolArr.push(n)}}},_processBonusCoin:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,r,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=SlotsFacade.dm.getSpinData(),!((a=n.bonusInfo)&&a.length<1)){t.next=4;break}return t.abrupt("return");case 4:return e._enterBonusState(),e.genBonusSymbols(),t.next=8,SlotsFacade.delayTime(.3);case 8:e.spine_taoxin.setAnimation(0,"DaoTaoXin_N_Loop2",!0),r=e.node.convertToNodeSpaceAR(e.taoxin_node.convertToWorldSpaceAR(cc.v2(0,0))),i=regeneratorRuntime.mark(function t(n){var i,c,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e._symbolArr[n],c="",i.label.node.active?c="XiaoTaoXin_F_Intro":i.label_free.node.active&&(c="XiaoTaoXin_J_Intro"),i.spine.setAnimation(0,c,!1),SlotsFacade.soundMgr.playEffect("fgChipCollect"),s=e.node.convertToNodeSpaceAR(i.convertToWorldSpaceAR(cc.v2(0,0))),(l=cc.instantiate(e.collect_coin_particle)).active=!0,l.parent=e.node,l.position=s,t.next=12,new Promise(function(t){cc.tween(l).to(.5,{position:r}).call(o(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return l.removeFromParent(!0),o.next=3,e.taoxinCollectSymbol(a[n]);case 3:t();case 4:case"end":return o.stop()}},o)}))).start()});case 12:case"end":return t.stop()}},t)}),c=0;case 12:if(!(c<e._symbolArr.length)){t.next=17;break}return t.delegateYield(i(c),"t0",14);case 14:c++,t.next=12;break;case 17:return t.next=19,SlotsFacade.delayTime(1);case 19:e.spine_taoxin.setAnimation(0,"DaoTaoXin_N_Loop",!0);case 20:case"end":return t.stop()}},t)}))()},_processFreeCoin:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,r,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(SlotsFacade.dm.isTriggerFree()){t.next=2;break}return t.abrupt("return");case 2:if(!SlotsFacade.dm.isFistTriggerFree()){t.next=5;break}return t.next=5,e._showBonusReel();case 5:"LoveForever_Loop3"!=e.spine_love_forever.animation&&(e.spine_love_forever.setAnimation(0,"LoveForever_Intro3",!1),e.spine_love_forever.addAnimation(0,"LoveForever_Loop3",!1),e.spine_love_forever.setCompleteListener(function(){e.spine_love_forever.setCompleteListener(null),e.spine_love_forever.node.getChildByName("tip").active=!0})),n=SlotsFacade.dm.getSpinData(),a=n.bonusInfo,r=e.node.convertToNodeSpaceAR(e.bonus_reel.convertToWorldSpaceAR(cc.v2(0,0))),i=regeneratorRuntime.mark(function t(n){var i,c,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=a[n],c=e._symbolArr[n],i.coin){t.next=4;break}return t.abrupt("return","continue");case 4:return SlotsFacade.soundMgr.playEffect("fgChipCollect"),s=e.node.convertToNodeSpaceAR(c.convertToWorldSpaceAR(cc.v2(0,0))),(l=cc.instantiate(c)).parent=e.node,l.position=s,e._data.freeBaseCoin+=i.coin,t.next=12,new Promise(function(t){cc.tween(l).to(.2,{scale:1.3}).to(.5,{position:r,scale:1}).call(o(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:l.removeFromParent(!0),e.label_free_coin.node.active=!0,e.label_free_coin.string=Global.convertNumToShort(e._data.freeBaseCoin),t();case 4:case"end":return n.stop()}},n)}))).start()});case 12:case"end":return t.stop()}},t)}),c=0;case 11:if(!(c<e._symbolArr.length)){t.next=19;break}return t.delegateYield(i(c),"t0",13);case 13:if("continue"!==t.t0){t.next=16;break}return t.abrupt("continue",16);case 16:c++,t.next=11;break;case 19:e._updateFreeCnt();case 20:case"end":return t.stop()}},t)}))()},taoxinCollectSymbol:function(e){var t=this;return o(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.spine_collect_effect.node.active=!0,t.spine_collect_effect.setAnimation(0,"DaoTaoXin_Intro",!1),t.spine_collect_effect.setCompleteListener(function(){t.spine_collect_effect.setCompleteListener(null),t.spine_collect_effect.node.active=!1}),t._data.bonusCoin+=e.coin||0,t._data.restFreeCnt+=e.freeCnt||0,e.coin?(t.label_coin.node.active=!0,t.label_coin.string=Global.convertNumToShort(t._data.bonusCoin)):e.freeCnt&&(t.label_free_cnt.node.active=!0,t.label_free_cnt.string=t._data.restFreeCnt.toString(),t.label_free_cnt.node.getChildByName("tip").getComponent("ImgSwitchCmp").setIndex(t._data.restFreeCnt>1?0:1)),n.next=8,SlotsFacade.delayTime(.2);case 8:case"end":return n.stop()}},n)}))()},_enterBonusState:function(){SlotsFacade.soundMgr.playEffect("reelLightOn"),this.panel.active=!0,SlotsFacade.character.hide(),SlotsFacade.collect.hide(),this.spine_border.node.active=!0,this.taoxin_node.active=!0,this.mask.active=!0},_showBonusReel:function(e){var t=this;return o(regeneratorRuntime.mark(function n(){var a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e=e||!1,SlotsFacade.dm.isFistTriggerFree()||e){n.next=3;break}return n.abrupt("return");case 3:if(SlotsFacade.soundMgr.playEffect("LfExpand"),t.spine_reel_bg.node.active=!0,t.spine_love_forever.node.active=!0,t.spine_love_forever.setAnimation(0,"LoveForever_Loop2",!0),!(a=SlotsFacade.dm.getScatterIdx())){n.next=17;break}return t.spine_love_forever.node.opacity=128,o=t.bonus_reel.convertToNodeSpaceAR(SlotsFacade.slots.getIdxGlobalPos(a)),t.spine_love_forever.node.y=o.y,cc.tween(t.spine_love_forever.node).to(.5,{opacity:255,y:0}).start(),n.next=15,SlotsFacade.delayTime(.6);case 15:n.next=19;break;case 17:t.spine_love_forever.node.opacity=255,t.spine_love_forever.node.y=0;case 19:case"end":return n.stop()}},n)}))()},_showLoveSymbol:function(){var e=SlotsFacade.dm.getScatterIdx();e&&(SlotsFacade.dm.isFistTriggerFree()||SlotsFacade.dm.GetTotalFree()<1&&SlotsFacade.dm.getSpinData().bonusInfo&&SlotsFacade.dm.getSpinData().bonusInfo.length>0)&&(this.spine_love_forever.node.active=!0,this.spine_love_forever.node.y=this.bonus_reel.convertToNodeSpaceAR(SlotsFacade.slots.getIdxGlobalPos(e)).y,this.spine_love_forever.setAnimation(0,"LoveForever_Loop2",!0))},_collectLoveToCharacter:function(){return o(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=SlotsFacade.dm.getScatterIdx()){e.next=3;break}return e.abrupt("return");case 3:if(!(SlotsFacade.dm.isFistTriggerFree()||SlotsFacade.dm.GetTotalFree()<1&&SlotsFacade.dm.getSpinData().bonusInfo&&SlotsFacade.dm.getSpinData().bonusInfo.length>0)){e.next=9;break}return e.next=6,SlotsFacade.character.collectLove(SlotsFacade.slots.getIdxGlobalPos(t));case 6:return SlotsFacade.soundMgr.playEffect("triggering"),e.next=9,SlotsFacade.delayTime(2.5);case 9:case"end":return e.stop()}},e)}))()},spinEnd:function(){var e=this;return o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e._data.isEnter){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e._collectLoveToCharacter();case 4:return e._showLoveSymbol(),t.next=7,e._processBonusCoin();case 7:return t.next=9,e._processFreeCoin();case 9:e._clearBonusSymbol(),e.mask.active=!1,SlotsFacade.dm.GetTotalFree()<1&&e.exit();case 12:case"end":return t.stop()}},t)}))()},_clearBonusSymbol:function(){this._symbolArr=[],this.symbols_node.removeAllChildren(!0)},reconnect:function(){this._enterBonusState();var e=SlotsFacade.dm.getDeskInfo();this.label_coin.node.active=!0,this.label_coin.string=Global.convertNumToShort(e.bonusTotalCoin),this.label_free_cnt.node.active=!0,this.label_free_cnt.string=SlotsFacade.dm.GetFreeTime(),this._showBonusReel(!0)}}),cc._RF.pop()},{}],PrincessPea_GameData:[function(e,t,n){"use strict";cc._RF.push(t,"085eaSljFNPGqcNn1NYiiP3","PrincessPea_GameData"),cc.Class({extends:e("LMSlots_GameData_Base"),properties:{energyData:null,pickBonus:null},init:function(e,t,n){this._super(e,t,n),this.energyData=this._deskInfo.loveCardInfo,this.pickBonus=this._deskInfo.pickBonus},RegisterMsg:function(){this._super(),cc.vv.NetManager.registerMsg(MsgId.SLOT_SUBGAME_DATA,this.onResp,this)},UnregisterMsg:function(){this._super(),cc.vv.NetManager.unregisterMsg(MsgId.SLOT_SUBGAME_DATA,this.onResp,!1,this)},OnRcvNetSpine:function(e){200==e.code&&(this.energyData=e.loveCardInfo,this.pickBonus=e.pickBonus),this._super(e)},SetSubGameData:function(e){this._subGame=e},GetSubGameData:function(){return this._subGame},getSpinData:function(){return this._gameInfo},hasFree:function(){return this.GetFreeTime()>0},isTriggerFree:function(){return this.triggerFreeCnt()>0},triggerFreeCnt:function(){var e=this._gameInfo.freeResult;return e&&e.triFreeCnt&&e.freeInfo&&e.freeInfo.freeCnt?e.freeInfo.freeCnt:0},isFistTriggerFree:function(){return this.hasFree()&&this.GetFreeTime()==this.GetTotalFree()},isLastEndFree:function(){return 0==this.GetFreeTime()&&this.GetTotalFree()>0},getFreeWinCoin:function(){return this._gameInfo.freeWinCoin},getScatterIndexs:function(){return this.triggerFreeCnt()>0?this._gameInfo.freeResult.freeInfo.scatterIdx.concat():[]},getCollectPercent:function(){if(!this.energyData||!this.energyData.progressData)return 0;var e=this.energyData.progressData.totalCnt/this.energyData.progressData.needCnt;return e=Math.min(1,e),e=Math.max(0,e)},canCollect:function(){return this.GetBetIdx()>=this.getDeskInfo().needBet},reqSubGame:function(e){var t={c:MsgId.SLOT_SUBGAME_DATA,gameid:this._gameId,data:e};cc.vv.NetManager.send(t,!0)},onResp:function(e){console.log("reqSubGame-resp:",e),1==e.data.rtype?SlotsFacade.map.onMsg(e):2==e.data.rtype?SlotsFacade.map.onMsg(e):3==e.data.rtype&&SlotsFacade.pickGame.onMsg(e)},updateRandomSymbols:function(){var e=[];SlotsFacade.dm.energyData.freeInfo&&SlotsFacade.dm.energyData.freeInfo.removeSymbol&&(e=SlotsFacade.dm.energyData.freeInfo.removeSymbol.concat());for(var t=cc.vv.gameData.getGameCfg().randomSymbols.concat(),n=0;n<t.length;n++)e.includes(t[n])&&(t.splice(n,1),n--);this.getGameCfg().randomSymbolsBySkip=t},getScatterIdx:function(){if(!this._gameInfo||!this._gameInfo.resultCards)return 0;var e=this._gameInfo.resultCards.indexOf(this.getGameCfg().scatterId);return-1!=e?e+1:0}}),cc._RF.pop()},{LMSlots_GameData_Base:void 0}],PrincessPea_Logic:[function(e,t,n){"use strict";cc._RF.push(t,"98731wYm3pDgI3eB6G/CgAo","PrincessPea_Logic"),cc.Class({extends:e("LMSlots_Logic_Base"),properties:{},onLoad:function(){window.SlotsFacade=this,this.dm=cc.vv.gameData,this.mainPanel=cc.find("safe_node",this.node).addComponent("PrincessPea_MainPanel"),this.soundMgr=this.addComponent("PrincessPea_Sound"),this.InitCommComponent(),this.flowCtrl=this.addComponent("PrincessPea_FlowCtrl"),this.popup=this.mainPanel.popup_node.getComponent("PrincessPea_Popup"),this.character=this.mainPanel.character_node.getComponent("PrincessPea_Character"),this.collect=this.mainPanel.collect_progress.getComponent("PrincessPea_Collect"),this.freeGame=this.mainPanel.free_game.getComponent("PrincessPea_FreeGame"),this.pickGame=this.mainPanel.pick_game.getComponent("PrincessPea_PickGame"),this.map=this.mainPanel.map_game.getComponent("PrincessPea_Map"),this.prizePool=this.mainPanel.jpNode.getComponent("PrincessPea_PrizePool"),this.topCmp=cc.vv.gameData.GetTopScript(),this.bottomCmp=cc.vv.gameData.GetBottomScript(),this.slots=cc.vv.gameData.GetSlotsScript()},onDestroy:function(){window.SlotsFacade=null,this.dm=null},delayTime:function(e){var t=this;return new Promise(function(n,a){t.scheduleOnce(function(){n()},e)})},start:function(){this._super(),SlotsFacade.soundMgr.playEffect("vo_welcome")}}),cc._RF.pop()},{LMSlots_Logic_Base:void 0}],PrincessPea_MainPanel:[function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function r(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var i=e.apply(t,n);function c(e){o(i,a,r,c,s,"next",e)}function s(e){o(i,a,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"ce02fQfO51NCr7pvk6qckig","PrincessPea_MainPanel"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.jpNode=this.node.getChildByName("LMSlots_PrizePool_1"),this.top_node=this.node.getChildByName("top_node"),this.transition_node=this.node.getChildByName("transition_node"),this.popup_node=this.node.getChildByName("popup_node"),this.bg=this.node.getChildByName("bg"),this.map_game=this.node.getChildByName("map_game"),this.slots=this.node.getChildByName("slots"),this.character_node=this.slots.getChildByName("character"),this.collect_progress=this.slots.getChildByName("collect_progress"),this.free_game=this.slots.getChildByName("free_game"),this.pick_game=this.slots.getChildByName("pick_game"),this.showBg(0)},showBg:function(e){e||(e=0),this.bg.getComponent("ImgSwitchCmp").setIndex(e)},showSceneTransition:function(e){var t=this;return r(regeneratorRuntime.mark(function n(){var o,r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=e||1,r=(o={},a(o,1,{time:2.5,spineNode:"spine1",aniName:"BGGuoChang",soundName:"bgTransition"}),a(o,2,{time:2.2,spineNode:"spine2",aniName:"FG_Intro",soundName:"fgTransition"}),a(o,3,{time:2,spineNode:"spine3",aniName:"DaJiangYuGao",soundName:"transition3"}),o)[e],SlotsFacade.soundMgr.playEffect(r.soundName),(i=t.transition_node.getChildByName(r.spineNode).getComponent(sp.Skeleton)).node.active=!0,i.setAnimation(0,r.aniName,!1),2==e?i.setCompleteListener(function(){i.setCompleteListener(null),i.addAnimation(0,"FG_End",!1),i.setCompleteListener(function(){i.setCompleteListener(null),i.node.active=!1})}):i.setCompleteListener(function(){i.setCompleteListener(null),i.node.active=!1}),n.next=9,SlotsFacade.delayTime(r.time);case 9:case"end":return n.stop()}},n)}))()}}),cc._RF.pop()},{}],PrincessPea_Map:[function(e,t,n){"use strict";function a(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"30b09vjk/dFE5cs+lzJAYuq","PrincessPea_Map"),cc.Class({extends:cc.Component,properties:{bgMask:cc.Node,panel:cc.Node,btnClose:cc.Node,label_page:cc.Label,label_pick:cc.Label,label_jackpot:cc.Label,label_multiplier:cc.Label,label_total_win:cc.Label,label_base_price:cc.Label,collect_items_node:cc.Node,collect_items:[cc.Node],pick_result_node:cc.Node,pick_results:[cc.Node],lottery_cards_node:cc.Node,lottery_cards:[cc.Node],_callBack:null,_respData:null,_canTouchCollectItem:!1},onLoad:function(){for(var e=this,t=function(t){var n=e.collect_items[t];n.id=t+1,n.bg=n.getChildByName("bg"),n.back=n.getChildByName("back"),n.front=n.getChildByName("front"),n.icon=n.front.getChildByName("icon").getComponent("ImgSwitchCmp"),n.mask=n.front.getChildByName("mask"),n.effect=n.getChildByName("effect").getComponent(sp.Skeleton),n.on(cc.Node.EventType.TOUCH_END,function(){e._onClickCollectItem(n.id)},e)},n=0;n<this.collect_items.length;n++)t(n);for(var a=0;a<this.lottery_cards.length;a++){var o=this.lottery_cards[a];o.id=a+1,o.back=o.getChildByName("back"),o.front=o.getChildByName("front").getComponent("ImgSwitchCmp"),o.little_card_back=o.getChildByName("little_card_back"),o.spine_effect=o.getChildByName("spine_effect").getComponent(sp.Skeleton)}for(var r=0;r<this.pick_results.length;r++){var i=this.pick_results[r];i.id=r+1,i.bg=i.getChildByName("bg").getComponent("ImgSwitchCmp"),i.label=i.getChildByName("label").getComponent("LabelSwitchCmp"),i.effect=i.getChildByName("effect").getComponent(sp.Skeleton)}this.btnClose.on("click",function(){SlotsFacade.soundMgr.playEffect("button"),e.btnClose.active=!1,e.exit()},this)},_onClickCollectItem:function(e){this._canTouchCollectItem&&(SlotsFacade.soundMgr.playEffect("pairsPick"),SlotsFacade.dm.energyData.game.items[e-1].isOpen||SlotsFacade.dm.reqSubGame({rtype:2,choiceId:e}))},_pickCollectItem:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,o,r,i,c,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e._canTouchCollectItem=!1,n=e._respData.loveCardInfo.game,e.label_pick.string=n.restStep,a=e._respData.result.prevIdx,o=e._respData.result.choiceIdx,r=a&&e.collect_items[a-1],i=e.collect_items[o-1],c=0,a&&n.items[a-1].type==n.items[o-1].type&&(c=n.items[o-1].type),SlotsFacade.soundMgr.playEffect("cardTurn"),cc.tween(i).to(.4,{scaleX:0}).call(function(){i.back.active=!1,i.front.active=!0}).to(.4,{scaleX:1}).start(),t.next=13,SlotsFacade.delayTime(.8);case 13:if(!c){t.next=26;break}return SlotsFacade.soundMgr.playEffect("pairsRight"),t.next=17,SlotsFacade.delayTime(.4);case 17:return cc.tween(r).to(.2,{scale:1.2}).to(.2,{scale:1}).start(),cc.tween(i).to(.2,{scale:1.2}).to(.2,{scale:1}).start(),t.next=21,SlotsFacade.delayTime(.5);case 21:e._setPickResultItem(c,!0,!0),e.label_total_win.string=Global.FormatNumToComma(n.winCoin),e.label_multiplier.string="X"+5*n.pairItems.length,t.next=35;break;case 26:if(!r){t.next=35;break}return SlotsFacade.soundMgr.playEffect("pairsWrong"),t.next=30,SlotsFacade.delayTime(.4);case 30:return SlotsFacade.soundMgr.playEffect("cardClose"),cc.tween(r).to(.4,{scaleX:0}).call(function(){r.back.active=!0,r.front.active=!1}).to(.4,{scaleX:1}).start(),cc.tween(i).to(.4,{scaleX:0}).call(function(){i.back.active=!0,i.front.active=!1}).to(.4,{scaleX:1}).start(),t.next=35,SlotsFacade.delayTime(.8);case 35:if(!n.isEnd){t.next=45;break}for(SlotsFacade.soundMgr.playEffect("cardAllturn"),s=0;s<n.items.length;s++)n.items[s].isOpen||function(){var t=e.collect_items[s];cc.tween(t).to(.4,{scaleX:0}).call(function(){t.back.active=!1,t.front.active=!0,t.mask.active=!0}).to(.4,{scaleX:1}).start()}();return t.next=40,SlotsFacade.delayTime(1.5);case 40:return t.next=42,SlotsFacade.popup.showMapGameCoin(n.winCoin,e._respData.loveCardInfo.page);case 42:e.exit(),t.next=46;break;case 45:e._canTouchCollectItem=!0;case 46:case"end":return t.stop()}},t)}))()},_setPickResultItem:function(e,t,n){var a=this.pick_results[e-1];t?(a.bg.setIndex(1),a.label.setIndex(1),n&&(SlotsFacade.soundMgr.playEffect("mapMult"),a.effect.node.active=!0,a.effect.setAnimation(0,"PuKe_LuoXiaXiao",!1),a.effect.setCompleteListener(function(){a.effect.setCompleteListener(null),a.effect.node.active=!1}))):(a.bg.setIndex(0),a.label.setIndex(0))},_showLotteryCards:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(SlotsFacade.soundMgr.playEffect("cardOpen"),e.lottery_cards_node.active=!0,n=function(t){var n=e.lottery_cards[t];n.active=!0,n.back.active=!0,n.front.node.active=!1,n.little_card_back.active=!1,n.spine_effect.node.active=!1,cc.tween(n).to(1,{x:(n.width/2+10)*(0==t?-1:1)}).call(function(){n.spine_effect.node.active=!0,n.spine_effect.setAnimation(0,"PuKe_Da_Intro",!1),n.spine_effect.addAnimation(0,"PuKe_Da_Loop",!0)}).delay(.2).call(function(){n.on(cc.Node.EventType.TOUCH_END,function(){SlotsFacade.soundMgr.playEffect("cardPick"),e.lottery_cards.forEach(function(e){e.off(cc.Node.EventType.TOUCH_END),e!=n&&(e.spine_effect.node.active=!1),console.log(">>",n.id)}),SlotsFacade.dm.reqSubGame({rtype:1,choiceId:n.id})})}).start()},a=0;a<e.lottery_cards.length;a++)n(a);case 4:case"end":return t.stop()}},t)}))()},_pickLotteryCards:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,o,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e._respData.choiceId,a=e._respData.count,t.next=4,new Promise(function(t){var a=e.lottery_cards[n-1];a.spine_effect.setAnimation(0,"PuKe_LuoXiaDa",!1),a.spine_effect.setCompleteListener(function(){a.spine_effect.setCompleteListener(null),a.spine_effect.node.active=!1,t()})});case 4:return o=e._respData.counts.concat(),-1!=(r=o.indexOf(a))&&o.splice(r,1),i=o[Math.floor(Math.random()*o.length)],SlotsFacade.soundMgr.playEffect("cardTurn"),t.next=11,new Promise(function(t){for(var o=function(o){var r=e.lottery_cards[o];r.id==n?(r.zIndex=10,r.front.setIndex(a-1),r.front.node.color=(new cc.Color).fromHEX("#ffffff")):(r.zIndex=5,r.front.setIndex(i-1),r.front.node.color=(new cc.Color).fromHEX("#8B8B8B"));var c=cc.tween(r).to(.5,{scaleX:0}).call(function(){r.front.node.active=!0,r.back.active=!1}).to(.5,{scaleX:1}).delay(1).to(.5,{x:0});r.id==n&&(c=c.to(.5,{scaleX:0}).call(function(){r.front.node.active=!1,r.little_card_back.active=!0}).to(.5,{scaleX:1}).call(function(){t()})),(c=c.call(function(){r.active=!1})).start()},r=0;r<e.lottery_cards.length;r++)o(r)});case 11:return t.next=13,new Promise(function(t){for(var n=function(n){var o=e.collect_items[e._respData.loveCardInfo.currCnt-a+n],r=e.panel.convertToNodeSpaceAR(o.convertToWorldSpaceAR(cc.v2(0,0))),i=cc.instantiate(e.lottery_cards[0].little_card_back);i.active=!0,i.parent=e.panel,i.position=e.lottery_cards_node.position,cc.tween(i).delay(.2*n).call(function(){SlotsFacade.soundMgr.playEffect("cardFly")}).to(.5,{position:r,scale:1}).call(function(){i.removeFromParent(!0),o.back.active=!0,o.effect.node.active=!0,o.effect.setAnimation(0,"PuKe_Xiao",!1),o.effect.setCompleteListener(function(){o.effect.setCompleteListener(null),o.effect.node.active=!1}),n==a-1&&t()}).start()},o=0;o<a;o++)n(o)});case 13:return t.next=15,SlotsFacade.delayTime(.5);case 15:if(2!=SlotsFacade.dm.energyData.state){t.next=20;break}return t.next=18,e._processCollectFull();case 18:t.next=21;break;case 20:e.exit();case 21:case"end":return t.stop()}},t)}))()},_processCollectFull:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,SlotsFacade.popup.showMapGameStart(e._respData.loveCardInfo.page);case 2:for(e.label_page.node.parent.active=!1,e.label_pick.node.parent.active=!0,n=e._respData.loveCardInfo.game,e.label_pick.string=n.restStep,a=function(t){var a=e.collect_items[t];a.icon.setIndex(n.items[t].type-1),a.effect.node.active=!0,a.effect.setAnimation(0,"PuKe_Xiao",!1),a.effect.setCompleteListener(function(){a.effect.setCompleteListener(null),a.effect.node.active=!1})},o=0;o<e.collect_items.length;o++)a(o);return t.next=10,SlotsFacade.delayTime(.4);case 10:e._canTouchCollectItem=!0;case 11:case"end":return t.stop()}},t)}))()},onMsg:function(e){this._respData=e.data,SlotsFacade.dm.energyData=this._respData.loveCardInfo,1==this._respData.rtype?this._pickLotteryCards():2==this._respData.rtype&&this._pickCollectItem()},_initView:function(){var e=SlotsFacade.dm.energyData;if(this.label_base_price.string=Global.FormatNumToComma(e.startPrice),this.label_jackpot.string=Global.FormatNumToComma(e.loveJackpot),this.label_multiplier.string="",this.label_total_win.string="",2==e.state){var t=e.game;this.label_page.node.parent.active=!1,this.label_pick.node.parent.active=!0,this.label_pick.string=t.restStep,t.winCoin>0&&(this.label_total_win.string=Global.FormatNumToComma(t.winCoin),this.label_multiplier.string="X"+5*t.pairItems.length);for(var n=0;n<this.collect_items.length;n++){var a=t.items[n],o=this.collect_items[n];o.back.active=!a.isOpen,o.front.active=a.isOpen,o.icon.setIndex(t.items[n].type-1)}for(var r=0;r<this.pick_results.length;r++)this._setPickResultItem(r+1,t.pairItems.includes(r+1));this._canTouchCollectItem=!0}else{for(var i=0;i<e.currCnt;i++){this.collect_items[i].back.active=!0}this.label_page.node.parent.active=!0,this.label_page.string=e.page,this.label_pick.node.parent.active=!1}},enter:function(e,t){var n=this;return o(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n._callBack=e,n.bgMask.active=!0,n.panel.scale=0,n.panel.active=!0,cc.tween(n.panel).to(.5,{scale:1},{easing:"backOut"}).start(),a.next=7,SlotsFacade.delayTime(.5);case 7:n._initView(),t?n.btnClose.active=!0:(SlotsFacade.soundMgr.playBgm("mapbgm"),SlotsFacade.collect.setProgress(0),1==SlotsFacade.dm.energyData.state&&n._showLotteryCards());case 9:case"end":return a.stop()}},a)}))()},_reset:function(){var e=SlotsFacade.dm.energyData;e.state=0,e.currCnt=0,e.game=null,this._respData=null,this.label_page.node.parent.active=!0,this.label_page.string=e.page>=5?1:e.page+1,this.label_pick.node.parent.active=!1,this.label_multiplier.string="",this.label_total_win.string="";for(var t=0;t<this.collect_items.length;t++){var n=this.collect_items[t];n.back.active=!1,n.front.active=!1,n.mask.active=!1}for(var a=0;a<this.pick_results.length;a++)this._setPickResultItem(a+1,!1)},exit:function(){var e=this;return o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return SlotsFacade.soundMgr.playEffect("mapOpenClose"),t.next=3,new Promise(function(t){cc.tween(e.panel).to(.5,{scale:0},{easing:"backIn"}).call(function(){e.panel.active=!1,e.bgMask.active=!1,t()}).start()});case 3:2==SlotsFacade.dm.energyData.state&&e._reset(),SlotsFacade.soundMgr.playBgm("",!0),e._callBack&&e._callBack();case 6:case"end":return t.stop()}},t)}))()}}),cc._RF.pop()},{}],PrincessPea_PickGame:[function(e,t,n){"use strict";function a(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"95ad1ePXQBPMKWiJTpSJJ5n","PrincessPea_PickGame");var r={coin:{aniIn:"XiaoTaoXin_F_Intro",aniShake:"XiaoTaoXin_F_Normal1"},jackpot1:{aniIn:"XiaoTaoXin_F_Mini",aniShake:"XiaoTaoXin_V_Normal1"},jackpot2:{aniIn:"XiaoTaoXin_F_Minor",aniShake:"XiaoTaoXin_L_Normal1"},jackpot3:{aniIn:"XiaoTaoXin_F_Major",aniShake:"XiaoTaoXin_Z_Normal1"},jackpot4:{aniIn:"XiaoTaoXin_F_Grand",aniShake:"XiaoTaoXin_H_Normal1"}};cc.Class({extends:cc.Component,properties:{panel:cc.Node,mask:cc.Node,bonus_reel:cc.Node,symbols_node:cc.Node,symbol_template:cc.Node,taoxin_node:cc.Node,spine_taoxin:sp.Skeleton,spine_collect_effect:sp.Skeleton,label_coin:cc.Label,label_pick_cnt:cc.Label,collect_coin_particle:cc.Node,_symbolArr:null,_data:null,_respData:null,_callBack:null},onLoad:function(){var e=this;this._resetData(),this._symbolArr=[],this.scheduleOnce(function(){for(var t=function(t){var n=cc.instantiate(e.symbol_template);n.parent=e.symbols_node,n.id=t+1,n.active=!0,n.spine=n.getChildByName("spine").getComponent(sp.Skeleton),n.label=n.getChildByName("label").getComponent(cc.Label),n.tips_add_pick=n.getChildByName("tips_add_pick"),n.mask=n.getChildByName("mask"),n.position=e.symbols_node.convertToNodeSpaceAR(SlotsFacade.slots.getIdxGlobalPos(t+1+Math.floor(t/4))),n.on(cc.Node.EventType.TOUCH_END,function(){e._onPickItem(n)}),e._symbolArr.push(n)},n=0;n<16;n++)t(n)})},_resetData:function(){this._data={canPick:!1,bonusCoin:0}},_onPickItem:function(e){this._data.canPick&&(SlotsFacade.dm.pickBonus.items[e.id-1].isOpen||(this._data.canPick=!1,SlotsFacade.dm.reqSubGame({rtype:3,choiceId:e.id})))},_pickItem:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,o,i,c,s,l,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e._respData.choiceId,a=e._respData.pickBonus.items[n-1],o=e._symbolArr[n-1],i=null,c=0,a.coin?(c=a.coin,i=r.coin,o.label.node.active=!0,o.label.node.opacity=0,o.label.node.scale=0,o.label.string=Global.convertNumToShort(a.coin),s=cc.tween(o.label.node).to(.2,{scale:1,opacity:255},{easing:"backOut"}),a.repick&&(s=s.delay(.3).call(function(){SlotsFacade.soundMgr.playEffect("bgPickTrans")}).to(.2,{scale:0},{easing:"backIn"}).call(function(){o.tips_add_pick.active=!0,o.tips_add_pick.scale=0,cc.tween(o.tips_add_pick).to(.2,{scale:1},{easing:"backOut"}).delay(.5).to(.2,{scale:0},{easing:"backIn"}).start()}).delay(.9).to(.2,{scale:1},{easing:"backOut"})),s.start()):a.jackpot?(i=r["jackpot".concat(a.jackpot.id)],c=a.jackpot.value):console.log("pick game \u6570\u636e\u51fa\u9519"),o.spine.setAnimation(0,i.aniIn,!1),o.spine.addAnimation(0,i.aniShake,!1),(l=cc.instantiate(e.collect_coin_particle)).active=!0,l.parent=e.node,l.position=e.node.convertToNodeSpaceAR(o.convertToWorldSpaceAR(cc.v2(0,0))),d=e.node.convertToNodeSpaceAR(e.taoxin_node.convertToWorldSpaceAR(cc.v2(0,0))),cc.tween(l).to(.6,{position:d}).call(function(){l.removeFromParent(!0),e.taoxinCollectSymbol({coin:c,pickCnt:a.repick?1:0})}).start(),t.next=16,SlotsFacade.delayTime(1);case 16:if(!a.jackpot){t.next=19;break}return t.next=19,SlotsFacade.popup.showWinJpCoin(a.jackpot.id,a.jackpot.value);case 19:case"end":return t.stop()}},t)}))()},_settlement:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a,o,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._respData.pickBonus.isEnd){t.next=14;break}return t.next=3,SlotsFacade.delayTime(1);case 3:for(SlotsFacade.soundMgr.playEffect("bgbgmend"),n=e._respData.pickBonus,a=0;a<n.items.length;a++)o=n.items[a],i=e._symbolArr[a],o.isOpen?i.scale=1.2:(i.mask.active=!0,i.mask.opacity=0,cc.tween(i.mask).to(.5,{opacity:512}).start(),i.zIndex=100+10*a,c=null,o.coin?(c=r.coin,i.label.string=Global.convertNumToShort(o.coin),i.label.node.active=!0):c=r["jackpot".concat(o.jackpot.id)],i.spine.setAnimation(0,c.aniShake,!1));return t.next=8,SlotsFacade.delayTime(1.5);case 8:return SlotsFacade.soundMgr.playEffect("bgend"),t.next=11,SlotsFacade.popup.showWinCoin(e._respData.pickBonus.winCoin);case 11:e.exit(),t.next=15;break;case 14:e._data.canPick=!0;case 15:case"end":return t.stop()}},t)}))()},onMsg:function(e){this._respData=e.data,SlotsFacade.dm.pickBonus=this._respData.pickBonus,this._updateRestCnt(),this._pickItem(),this._settlement()},taoxinCollectSymbol:function(e){var t=this;return o(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return SlotsFacade.soundMgr.playEffect("chipCollect"),t.spine_collect_effect.node.active=!0,t.spine_collect_effect.setAnimation(0,"DaoTaoXin_Intro",!1),t.spine_collect_effect.setCompleteListener(function(){t.spine_collect_effect.setCompleteListener(null),t.spine_collect_effect.node.active=!1}),t._data.bonusCoin+=e.coin||0,t._data.restPickCnt+=e.pickCnt||0,e.coin?(t.label_coin.node.active=!0,t.label_coin.string=Global.convertNumToShort(t._data.bonusCoin)):e.pickCnt&&(t.label_pick_cnt.node.active=!0,t.label_pick_cnt.string=t._data.restPickCnt.toString(),t.label_pick_cnt.node.getChildByName("tip").getComponent("ImgSwitchCmp").setIndex(t._data.restPickCnt>1?0:1)),n.next=9,SlotsFacade.delayTime(.2);case 9:case"end":return n.stop()}},n)}))()},_showBonusReel:function(e){var t=this;return o(regeneratorRuntime.mark(function n(){var a,o,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=SlotsFacade.dm.getScatterIdx(),e){n.next=8;break}if(!a){n.next=5;break}return n.next=5,SlotsFacade.character.collectLove(SlotsFacade.slots.getIdxGlobalPos(a));case 5:return SlotsFacade.soundMgr.playEffect("triggering"),n.next=8,SlotsFacade.delayTime(2.5);case 8:if(t.bonus_reel.active=!0,SlotsFacade.soundMgr.playEffect("LfExpand"),(o=t.bonus_reel.getChildByName("spine_love_forever")).active=!0,!a){n.next=21;break}return o.opacity=128,r=t.bonus_reel.convertToNodeSpaceAR(SlotsFacade.slots.getIdxGlobalPos(a)),o.y=r.y,cc.tween(o).to(.5,{opacity:255,y:0}).start(),n.next=19,SlotsFacade.delayTime(.6);case 19:n.next=23;break;case 21:o.opacity=255,o.y=0;case 23:case"end":return n.stop()}},n)}))()},_initView:function(){var e=SlotsFacade.dm.pickBonus;this.panel.active=!0,this.taoxin_node.active=!0,this.mask.active=!0;for(var t=e.items,n=0;n<this._symbolArr.length;n++){var a=t[n],o=this._symbolArr[n];if(o.zIndex=n,o.scale=1,o.label.node.active=!1,o.tips_add_pick.active=!1,o.mask.active=!1,a.isOpen){var i=null;a.coin?(o.label.node.active=!0,o.label.string=Global.convertNumToShort(a.coin),i=r.coin):i=r["jackpot".concat(a.jackpot.id)],o.spine.setAnimation(0,i.aniShake,!1)}else o.spine.setAnimation(0,"XiaoTaoXin_F_Loop2",!0)}this.label_coin.node.active=!1,e.winCoin&&(this.label_coin.node.active=!0,this.label_coin.string=Global.convertNumToShort(e.winCoin),this._data.bonusCoin=e.winCoin),this._updateRestCnt()},_updateRestCnt:function(){var e=SlotsFacade.dm.pickBonus.spinCnt;this.label_pick_cnt.node.active=!0,this.label_pick_cnt.string=e.toString(),this.label_pick_cnt.node.getChildByName("tip").getComponent("ImgSwitchCmp").setIndex(e>1?0:1)},enter:function(e,t){var n=this;return o(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n._callBack=e,SlotsFacade.slots.resetAllSymbol(),a.next=4,n._showBonusReel(t);case 4:if(t){a.next=9;break}return a.next=7,SlotsFacade.popup.showPickGameStart();case 7:return a.next=9,SlotsFacade.mainPanel.showSceneTransition(1);case 9:SlotsFacade.mainPanel.showBg(1),SlotsFacade.soundMgr.playBgm("bgbgm"),SlotsFacade.slots.reels_node.active=!1,n._initView(),SlotsFacade.character.hide(),SlotsFacade.collect.hide(),n._data.canPick=!0;case 16:case"end":return a.stop()}},a)}))()},exit:function(){var e=this;return o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,SlotsFacade.mainPanel.showSceneTransition(1);case 2:SlotsFacade.mainPanel.showBg(0),SlotsFacade.soundMgr.playBgm("",!0),e._resetData(),SlotsFacade.character.show(),SlotsFacade.collect.show(),e.panel.active=!1,e.taoxin_node.active=!1,e.mask.active=!1,e.bonus_reel.active=!1,SlotsFacade.slots.reels_node.active=!0,e._callBack&&(e._callBack(SlotsFacade.dm.pickBonus.winCoin),e._callBack=null);case 13:case"end":return t.stop()}},t)}))()}}),cc._RF.pop()},{}],PrincessPea_Popup:[function(e,t,n){"use strict";function a(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"4251d+0fjxEAZ4JVd5HjRnr","PrincessPea_Popup"),cc.Class({extends:cc.Component,properties:{bg:cc.Node,bg_dark:cc.Node},onLoad:function(){},showBg:function(e){this.bg.active=e},showBgDark:function(e){this.bg_dark.active=e},showWinFreeCnt:function(e,t,n){var a=this;return o(regeneratorRuntime.mark(function o(){var r,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return SlotsFacade.soundMgr.playEffect("fgbegin"),a.showBg(!0),(r=a.node.getChildByName("panel_win_free_cnt")).active=!0,r.scale=0,cc.tween(r).to(.5,{scale:1},{easing:"backOut"}).start(),r.getChildByName("label_cnt").getComponent(cc.Label).string=e.toString(),r.getChildByName("label_coin").getComponent(cc.Label).string=Global.convertNumToShort(n),(i=r.getChildByName("btn_ok")).active=t,r.getChildByName("first_tip").active=t,r.getChildByName("extra_tip").active=!t,o.next=16,SlotsFacade.delayTime(.5);case 16:if(!t){o.next=21;break}return o.next=19,new Promise(function(e){i.on(cc.Node.EventType.TOUCH_END,function t(){SlotsFacade.soundMgr.playEffect("button"),i.off(cc.Node.EventType.TOUCH_END,t),cc.tween(r).to(.5,{scale:0},{easing:"backIn"}).call(function(){a.showBg(!1),r.active=!1,e()}).start()})});case 19:o.next=26;break;case 21:return o.next=23,SlotsFacade.delayTime(1.5);case 23:return SlotsFacade.soundMgr.playEffect("button"),o.next=26,new Promise(function(e){cc.tween(r).to(.5,{scale:0},{easing:"backIn"}).call(function(){a.showBg(!1),r.active=!1,e()}).start()});case 26:case"end":return o.stop()}},o)}))()},showWinCoin:function(e){var t=this;return o(regeneratorRuntime.mark(function n(){var a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.showBg(!0),(a=t.node.getChildByName("panel_win_coin")).active=!0,a.scale=0,cc.tween(a).to(.5,{scale:1},{easing:"backOut"}).start(),a.getChildByName("label").getComponent("LabelRollCmp").startRoll(0,e),o=a.getChildByName("btn_ok"),n.next=10,SlotsFacade.delayTime(.5);case 10:return n.next=12,new Promise(function(e){o.on(cc.Node.EventType.TOUCH_END,function(){SlotsFacade.soundMgr.playEffect("button"),o.off(cc.Node.EventType.TOUCH_END),cc.tween(a).to(.5,{scale:0},{easing:"backIn"}).call(function(){t.showBg(!1),a.active=!1,e()}).start()})});case 12:case"end":return n.stop()}},n)}))()},showWinJpCoin:function(e,t){var n=this;return o(regeneratorRuntime.mark(function a(){var o,r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return SlotsFacade.soundMgr.playEffect("JPwin"),n.showBg(!0),(o=n.node.getChildByName("panel_win_jp_coin")).active=!0,o.scale=0,cc.tween(o).to(.5,{scale:1},{easing:"backOut"}).start(),o.getChildByName("label_jp_type").getComponent("ImgSwitchCmp").setIndex(e-1),o.getChildByName("label").getComponent("LabelRollCmp").startRoll(0,t),r=o.getChildByName("btn_ok"),a.next=13,SlotsFacade.delayTime(.5);case 13:return a.next=15,new Promise(function(e){r.on(cc.Node.EventType.TOUCH_END,function(){SlotsFacade.soundMgr.playEffect("button"),r.off(cc.Node.EventType.TOUCH_END),cc.tween(o).to(.5,{scale:0},{easing:"backIn"}).call(function(){n.showBg(!1),o.active=!1,e()}).start()})});case 15:case"end":return a.stop()}},a)}))()},showPickGameStart:function(){var e=this;return o(regeneratorRuntime.mark(function t(){var n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return SlotsFacade.soundMgr.playEffect("bgbegin"),e.showBg(!0),(n=e.node.getChildByName("panel_pick_game_start")).active=!0,n.scale=0,cc.tween(n).to(.5,{scale:1},{easing:"backOut"}).start(),t.next=8,SlotsFacade.delayTime(.5);case 8:return a=n.getChildByName("btn_ok"),t.next=11,new Promise(function(t){a.on(cc.Node.EventType.TOUCH_END,function(){SlotsFacade.soundMgr.playEffect("button"),a.off(cc.Node.EventType.TOUCH_END),cc.tween(n).to(.5,{scale:0},{easing:"backIn"}).call(function(){n.active=!1,e.showBg(!1),t()}).start()})});case 11:case"end":return t.stop()}},t)}))()},showMapGameStart:function(e){var t=this;return o(regeneratorRuntime.mark(function n(){var a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=e||1,SlotsFacade.soundMgr.playEffect("mapbegin"),t.showBg(!0),(a=t.node.getChildByName("panel_map_start")).active=!0,a.scale=0,cc.tween(a).to(.5,{scale:1},{easing:"backOut"}).start(),a.getChildByName("label").getComponent(cc.Label).string=e.toString(),n.next=11,SlotsFacade.delayTime(.5);case 11:return o=a.getChildByName("btn_ok"),n.next=14,new Promise(function(e){o.on(cc.Node.EventType.TOUCH_END,function(){SlotsFacade.soundMgr.playEffect("button"),o.off(cc.Node.EventType.TOUCH_END),cc.tween(a).to(.5,{scale:0},{easing:"backIn"}).call(function(){a.active=!1,t.showBg(!1),e()}).start()})});case 14:case"end":return n.stop()}},n)}))()},showMapGameCoin:function(e,t){var n=this;return o(regeneratorRuntime.mark(function a(){var o,r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=t||1,SlotsFacade.soundMgr.playEffect("mapend"),n.showBg(!0),(o=n.node.getChildByName("panel_map_win_coin")).active=!0,o.scale=0,cc.tween(o).to(.5,{scale:1},{easing:"backOut"}).start(),o.getChildByName("label_page_cnt").getComponent(cc.Label).string=t.toString(),o.getChildByName("label_coin").getComponent("LabelRollCmp").startRoll(0,e),r=o.getChildByName("btn_ok"),a.next=14,SlotsFacade.delayTime(.5);case 14:return a.next=16,new Promise(function(e){r.on(cc.Node.EventType.TOUCH_END,function(){SlotsFacade.soundMgr.playEffect("button"),r.off(cc.Node.EventType.TOUCH_END),cc.tween(o).to(.5,{scale:0},{easing:"backIn"}).call(function(){n.showBg(!1),o.active=!1,e()}).start()})});case 16:case"end":return a.stop()}},a)}))()}}),cc._RF.pop()},{}],PrincessPea_PrizePool:[function(e,t,n){"use strict";cc._RF.push(t,"08c59+tV8NIpJ9h0hfilejI","PrincessPea_PrizePool"),cc.Class({extends:e("LMSlots_PrizePool_Base"),properties:{},start:function(){var e=this;this._super(),this.scheduleOnce(function(){e.node.y>cc.winSize.height/2&&(e.node.y=cc.winSize.height/2)},0)}}),cc._RF.pop()},{LMSlots_PrizePool_Base:void 0}],PrincessPea_Reel:[function(e,t,n){"use strict";function a(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=o(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,i=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw r}}}}function o(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}cc._RF.push(t,"a8288V6yJZIf69NZhXeZ9jo","PrincessPea_Reel"),cc.Class({extends:e("LMSlots_Reel_Base"),properties:{},ShowAntiEffect:function(e,t){if(0==e){if(this._cfg.reelStateInfo){var n,o=a(this._cfg.reelStateInfo);try{for(o.s();!(n=o.n()).done;){var r=n.value,i=cc.find("node_anti",this.node);i&&i.active&&(i.active=!1,this._stopRightNow&&cc.vv.AudioManager.stopEffectByName(r.antSound))}}catch(e){o.e(e)}finally{o.f()}}}else{var c=cc.find("node_anti",this.node);if(c){c.active=!0;var s=c.getComponent(sp.Skeleton);s.setAnimation(0,"TingPai_Intro",!1),s.addAnimation(0,"TingPai_Loop",!0)}else cc.log("\u672a\u627e\u5230\u52a0\u901f\u8282\u70b9\uff1amask/node_anti")}},showBonusAni:function(e){cc.find("node_bonus",this.node).active=e}}),cc._RF.pop()},{LMSlots_Reel_Base:void 0}],PrincessPea_Slots:[function(e,t,n){"use strict";function a(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=o(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,i=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw r}}}}function o(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function i(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(a,o){var r=e.apply(t,n);function c(e){i(r,a,o,c,s,"next",e)}function s(e){i(r,a,o,c,s,"throw",e)}c(void 0)})}}cc._RF.push(t,"5c175xK0IdJT6HiDVU9tDqk","PrincessPea_Slots"),cc.Class({extends:e("LMSlots_Slots_Base"),properties:{mask:cc.Node},onLoad:function(){this._super(),this.mask=this.node.getChildByName("mask"),this.reels_node=this.node.getChildByName("reels")},StartMove:function(){this._super(),SlotsFacade.flowCtrl.startMove(),0==SlotsFacade.dm.GetTotalFree()&&Global.SlotsSoundMgr.playNormalBgm()},onMsgSpine:function(e){SlotsFacade.flowCtrl.onSpinMsg(e)},OnSpinEnd:function(){SlotsFacade.flowCtrl.spinEnd()},ReconnectShow:function(){this.scheduleOnce(function(){SlotsFacade.flowCtrl.enterRoom()})},transferIdx:function(e){return{col:(e-=1)%this._col,row:this._row-Math.floor(e/this._col)-1}},getIdxGlobalPos:function(e){var t=this.transferIdx(e),n=this._reels[t.col],a=n.GetSymbolPosByRow(t.row);return n.node.getChildByName("mask").convertToWorldSpaceAR(a)},getSymbolsByServerIds:function(e){var t=this,n=[];return e.forEach(function(e){n.push(t.GetSymbolByIdx(e))}),n},SetSlotsResult:function(e){for(var t=this,n=e.length/this._col,a=[],o=0;o<e.length;o++){Math.floor(o/n);var r=o%this._col;if(this._cfg.symbol[e[o]]){var i={};i.sid=e[o],i.data={idx:o+1},a[r]||(a[r]=[]),a[r].unshift(i)}}var c=SlotsFacade.dm.energyData.progressData;c&&c.currIdxs&&c.currIdxs.forEach(function(e){var n=t.transferIdx(e);a[n.col][n.row].data.hasStuff=!0});var s=SlotsFacade.dm.getSpinData();s.bonusInfo&&s.bonusInfo.length>0&&s.bonusInfo.forEach(function(e){var n=t.transferIdx(e.idx);e.coin?a[n.col][n.row].data.coin=e.coin:e.freeCnt&&(a[n.col][n.row].data.freeCnt=e.freeCnt)});for(var l=0;l<this._reels.length;l++){var d=this._reels[l],u=a[l];d.SetResult(u)}},SetReelStateInfo:function(e){this._super(e)},ShowWinTrace:function(){for(var e=[],t=0;t<this._gameInfo.zjLuXian.length;t++)for(var n=this._gameInfo.zjLuXian[t],a=0;a<n.indexs.length;a++)e[n.indexs[a]]=1;if(this._gameInfo.scatterZJLuXian&&this._gameInfo.scatterZJLuXian.indexs)for(var o=0;o<this._gameInfo.scatterZJLuXian.indexs.length;o++){e[this._gameInfo.scatterZJLuXian.indexs[o]]=1}for(var r=this._reels,i=r.length,c=0;c<i;c++){for(var s=r[c],l=[!1,!1,!1,!1],d=0;d<4;d++){var u=(3-d)*i+(c+1);1==s._symbols[d].GetShowId()&&e[u]&&(l[d]=!0)}l[0]&&l[1]&&l[2]&&l[3]?(s._symbols[0].wildAniCount=4,s._symbols[1].wildAniCount=0,s._symbols[2].wildAniCount=0,s._symbols[3].wildAniCount=0):l[0]&&l[1]&&l[2]?(s._symbols[0].wildAniCount=3,s._symbols[1].wildAniCount=0,s._symbols[2].wildAniCount=0):l[0]&&l[1]?(s._symbols[0].wildAniCount=2,s._symbols[1].wildAniCount=0):l[1]&&l[2]&&l[3]?(s._symbols[1].wildAniCount=3,s._symbols[2].wildAniCount=0,s._symbols[3].wildAniCount=0):l[1]&&l[2]?(s._symbols[1].wildAniCount=2,s._symbols[2].wildAniCount=0):l[2]&&l[3]&&(s._symbols[2].wildAniCount=2,s._symbols[3].wildAniCount=0)}for(var p in e){var m=this.GetSymbolByIdx(Number(p));m&&(m.playWinAnimation(),m.ShowKuang())}},showMask:function(){this.mask.active=!0,this.mask.opacity=0,cc.tween(this.mask).to(.2,{opacity:140}).start()},hideMask:function(){var e=this;this.mask.active&&cc.tween(this.mask).to(.8,{opacity:0}).call(function(t){e.mask.active=!1}).start()},playTriggerAni:function(e){var t=this;return c(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return SlotsFacade.soundMgr.playEffect("bell"),e.forEach(function(e){t.GetSymbolByIdx(e).playTriggerAnimation()}),n.next=4,SlotsFacade.delayTime(1.5);case 4:case"end":return n.stop()}},n)}))()},updateAllSymbol:function(){SlotsFacade.dm.updateRandomSymbols();var e,t=a(this._reels);try{for(t.s();!(e=t.n()).done;){var n,o=a(e.value._symbols);try{for(o.s();!(n=o.n()).done;){var r=n.value;r.StartMove(),r.ShowRandomSymbol()}}catch(e){o.e(e)}finally{o.f()}}}catch(e){t.e(e)}finally{t.f()}},resetAllSymbol:function(){var e,t=a(this._reels);try{for(t.s();!(e=t.n()).done;){var n,o=a(e.value._symbols);try{for(o.s();!(n=o.n()).done;){n.value.StartMove()}}catch(e){o.e(e)}finally{o.f()}}}catch(e){t.e(e)}finally{t.f()}}}),cc._RF.pop()},{LMSlots_Slots_Base:void 0}],PrincessPea_Sound:[function(e,t,n){"use strict";cc._RF.push(t,"e9ac845OkJOZINX12E+oWjv","PrincessPea_Sound"),cc.Class({extends:cc.Component,properties:{_soundPath:"games/PrincessPea/",_isPlayBgm:!1},playEffect:function(e,t){return cc.vv.AudioManager.playEff(this._soundPath,e,!0,t)},stopEffectByName:function(e){cc.vv.AudioManager.stopEffectByName(e)},stopEffect:function(){cc.vv.AudioManager.stopAudio()},playBgm:function(e,t){e?(Global.SlotsSoundMgr.stopBgm(),Global.SlotsSoundMgr.playBgm(e)):(t=t||!1,Global.SlotsSoundMgr.playNormalBgm(t))},stopBgm:function(){Global.SlotsSoundMgr.stopBgm()},playFreeBgm:function(){this.playBgm("fgbgm")}}),cc._RF.pop()},{}],PrincessPea_Symbol:[function(e,t,n){"use strict";cc._RF.push(t,"d0f04w9qhhP3bkb3cjuTZw8","PrincessPea_Symbol");cc.Class({extends:e("LMSlots_Symbol_Base"),properties:{stuff:cc.Node,label:cc.Label,labelFree:cc.Label},onLoad:function(){this.stuff=this.node.getChildByName("stuff"),this.label=this.node.getChildByName("label").getComponent(cc.Label),this.labelFree=this.node.getChildByName("label_free").getComponent(cc.Label)},StartMove:function(){this._super(),this.showStuff(!1),this.showLabel()},ShowById:function(e,t){this._super(e,t),t?(this.showStuff(!0),this.showLabel(!0)):this.showLabel(!1)},showStuff:function(e){e&&this._data&&this._data.hasStuff?this.stuff.active=!0:this.stuff.active=!1},ShowRandomSymbol:function(){var e=cc.vv.gameData.getGameCfg(),t=Global.random(1,e.randomSymbolsBySkip.length),n=e.randomSymbolsBySkip[t-1],a=null;n==e.bonusId&&((a={}).coin=Global.random(1,10)*SlotsFacade.dm.GetTotalBet()),this.ShowById(n,a)},showLabel:function(e){this.label.node.active=!1,this.labelFree.node.active=!1,e&&this._data&&(this._data.coin?(this.label.node.active=!0,this.label.node.scaleX=1,this.label.string=Global.convertNumToShort(this._data.coin)):this._data.freeCnt&&(this.labelFree.node.active=!0,this.labelFree.node.scaleX=1,this.labelFree.string=Global.convertNumToShort(this._data.freeCnt)))},StopMoveDeep:function(){SlotsFacade.dm.getSpinData()&&(this.GetShowId()==SlotsFacade.dm.getGameCfg().scatterId&&this.playStopAnimation())},StopMoveEnd:function(){this.showStuff(!1),this._data&&this._data.hasStuff&&SlotsFacade.collect.addAppearanceDrop(this.stuff.convertToWorldSpaceAR(cc.v2(0,0)))},playStopAnimation:function(){var e=this._id,t=cc.vv.gameData.getGameCfg();if(t.symbol[e]&&t.symbol[e].win_node&&t.symbol[e].stop_ani&&(this._state="stop",this._showNode&&(this._showNode.active=!1),this._showNode=cc.find(t.symbol[e].win_node,this.node),this._showNode.active=!0,""!=t.symbol[e].stop_ani.name)){this.node.zIndex=t.symbol[e].stop_ani.zIndex-this._symbolIdx+10*this._reelIdx;var n=this._showNode.getComponent(sp.Skeleton);if(n){var a=t.symbol[e].stop_ani,o=t.symbol[e].idle_ani;n.setAnimation(0,a.name,!1),o&&n.addAnimation(0,o.name,!0)}}},playTriggerAnimation:function(){var e=!1,t=this._id,n=cc.vv.gameData.getGameCfg();if(n.symbol[t]&&n.symbol[t].win_node&&n.symbol[t].trigger_ani){this._state="trigger",this._showNode&&(this._showNode.active=!1);var a=this.setAnimationToTop(!0);a.active=!0;var o=cc.find(n.symbol[t].win_node,a);if(o.active=!0,""!=n.symbol[t].trigger_ani.name){a.zIndex=n.symbol[t].trigger_ani.zIndex-this._symbolIdx+10*this._reelIdx,e=!0;var r=o.getComponent(sp.Skeleton);if(r){var i=n.symbol[t].trigger_ani.name;r.setAnimation(0,i,n.symbol[t].trigger_ani.loop)}}var c=a.getChildByName("label");!c.active&&this._data.coin&&(c.active=!0,c.getComponent(cc.Label).string=Global.convertNumToShort(this._data.coin))}return e},ShowKuang:function(e){this._id==SlotsFacade.dm.getGameCfg().scatterId&&(e=!1),this._super(e)},showJpSymbolCoin:function(e,t){var n=this.GetShowId();if((301==n||302==n)&&this._showNode){this._showNode&&(this._showNode.active=!1);var a=cc.vv.gameData.getGameCfg();this._showNode=cc.find(a.symbol[n].win_node,this.node),this._showNode.active=!0,this._showNode.getComponent(sp.Skeleton).setAnimation(0,"animation2",!1);var o=this.node.getChildByName("label").getComponent(cc.Label);o.node.active=!0,o.string=Global.convertNumToShort(e),o.node.scaleX=0,t=t||1.6,cc.tween(o.node).delay(t).to(.5,{scaleX:1}).start()}}}),cc._RF.pop()},{LMSlots_Symbol_Base:void 0}]},{},["PrincessPea_Cfg","PrincessPea_Character","PrincessPea_Collect","PrincessPea_FlowCtrl","PrincessPea_FreeGame","PrincessPea_GameData","PrincessPea_Logic","PrincessPea_MainPanel","PrincessPea_Map","PrincessPea_PickGame","PrincessPea_Popup","PrincessPea_PrizePool","PrincessPea_Reel","PrincessPea_Slots","PrincessPea_Sound","PrincessPea_Symbol"]);