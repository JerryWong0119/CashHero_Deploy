window.__require=function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var _=n[r]={exports:{}};t[r][0].call(_.exports,function(e){return i(t[r][1][e]||e)},_,_.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({TheUnicorn_Cfg:[function(e,t,n){"use strict";var o;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"8dc74tU6EtKHZNPFkSyFfNG","TheUnicorn_Cfg");var a={symbol:(o={},i(o,1,{node:"s1",win_node:"w1",win_ani:{name:"animation",zIndex:100}}),i(o,2,{node:"s11",win_node:"w11",win_ani:{name:"animation",zIndex:200},stop_ani:{name:"animation1",zIndex:300},trigger_ani:{name:"animation",zIndex:400}}),i(o,3,{node:"s12",win_node:"w12",win_ani:{name:"animation",zIndex:100},trigger_ani:{name:"animation",zIndex:300}}),i(o,4,{node:"s2",win_node:"w2",win_ani:{name:"animation",zIndex:100}}),i(o,5,{node:"s3",win_node:"w3",win_ani:{name:"animation",zIndex:100}}),i(o,6,{node:"s4",win_node:"w4",win_ani:{name:"animation",zIndex:100}}),i(o,7,{node:"s5",win_node:"w5",win_ani:{name:"animation",zIndex:100}}),i(o,8,{node:"s6",win_node:"w6",win_ani:{name:"animation",zIndex:100}}),i(o,9,{node:"s7"}),i(o,10,{node:"s8"}),i(o,11,{node:"s9"}),i(o,12,{node:"s10"}),i(o,13,{node:"s0"}),i(o,14,{node:"s13"}),o),scripts:{Top:"LMSlots_Top_Base",Bottom:"LMSlots_Bottom_Base",Slots:"TheUnicorn_Slots",Reels:"TheUnicorn_Reel",Symbols:"TheUnicorn_Symbol"},col:5,row:3,symbolPrefab:"TheUnicorn_Symbol",symbolSize:{width:130,height:112},randomSymbols:[1,2,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12],kuang:"TheUnicorn_Kuang",speed:3e3,reelStopInter:.2,auto_stop_time:1,normalBgm:"base/base_bgm",helpItems:["games/TheUnicorn/prefab/help/HelpPage1","games/TheUnicorn/prefab/help/HelpPage2","games/TheUnicorn/prefab/help/HelpPage3","games/TheUnicorn/prefab/help/HelpPage4","games/TheUnicorn/prefab/help/HelpPage5"],commEffect:{path:"games/TheUnicorn/",win1:["win1","win1end"],win2:["win2","win2end"]},autoModelDelay:.8,bounce:!0,bounceInfo:{distance:30,time:.1},AddAntiTime:1.5,reelStateInfo:[{id:[2],mini:3,counts:[1,1,1,1,1],antiNode:"node_anti",path:"games/TheUnicorn/",reelStopSound:"reel_stop",symbolStopSound:"symbol_scatter",antSound:"reel_notify",antSpeed:2e3},{id:[3],mini:5,counts:[3,3,3,3,3],antiNode:"node_anti",path:"games/TheUnicorn/",reelStopSound:"reel_stop",symbolStopSound:"symbol_bonus",antSound:"reel_notify",antSpeed:2e3}],sysFloatOffsetPos:cc.v2(0,20)};t.exports=a,cc._RF.pop()},{}],TheUnicorn_Collect:[function(e,t,n){"use strict";function o(e,t,n,o,i,a,r){try{var s=e[a](r),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var r=e.apply(t,n);function s(e){o(r,i,a,s,c,"next",e)}function c(e){o(r,i,a,s,c,"throw",e)}s(void 0)})}}cc._RF.push(t,"a1b586/wrRBxLWhBEpi922n","TheUnicorn_Collect"),cc.Class({extends:cc.Component,properties:{_collect:null,_map:null,_bar:null,_pos:null,_tip:null,_islock:!1,_processing:!1,_show:!1,_idx:0},onLoad:function(){this._collect=cc.find("safe_node/slots/collect",this.node),this._collect.on("click",this.onClickCollect.bind(this)),this._bar=cc.find("progress_bg/progress/bar",this._collect),this._pos=cc.find("progress_bg/progress/pos",this._collect),this._tip=cc.find("tip",this._collect),cc.find("ball/map",this._collect).on("click",this.onClickMap.bind(this)),this.onEventTotalbetUpdated(),this._map=cc.find("safe_node/map",this.node),cc.find("layout/btn_back",this._map).on("click",this.onClickBack.bind(this)),Global.registerEvent(cc.vv.gameData._EventId.SLOT_TOTALBET_UPDATED,this.onEventTotalbetUpdated,this)},start:function(){this.refreshProgress(),this.refreshMap()},Sleep:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,o){t.scheduleOnce(function(){n()},e)}));case 1:case"end":return n.stop()}},n)}))()},setProgress:function(e,t){var n=500*(e=Math.min(Math.max(0,e),1));t?(this._bar.runAction(cc.moveTo(.1,n,0)),this._pos.x=n,this._pos.getComponent(sp.Skeleton).setAnimation(0,"animation",!1)):this._bar.x=n},refreshProgress:function(){var e=cc.vv.gameData.getCollectData();this.setProgress(e.num/e.total);var t=e.idx,n="theme140_collect_nextStep_5";3==t?n="theme140_collect_nextStep_1":7==t?n="theme140_collect_nextStep_2":12==t?n="theme140_collect_nextStep_3":18==t&&(n="theme140_collect_nextStep_4");var o=cc.vv.gameData.GetAtlasByName("base");cc.find("progress_bg/next_step",this._collect).getComponent(cc.Sprite).spriteFrame=o.getSpriteFrame(n)},refreshMap:function(){var e=cc.vv.gameData.GetAtlasByName("map"),t=cc.vv.gameData.getCollectData(),n=t.idx;this._idx=n,n<1&&(n=1);for(var o=[4,8,13,19],i=[2,3,4,5],a=0;a<4;a++){var r=cc.find("layout/end"+o[a],this._map);if(n>=o[a])r.getChildByName("completed").active=!0,r.getChildByName("booster").active=!1,r.getChildByName("frame").active=!1;else if(n>1&&n<o[a]&&(0==a||n>o[a-1])){r.getChildByName("completed").active=!1,r.getChildByName("booster").active=!0,r.getChildByName("frame").active=!0;var s=0;s=0==a?n-1:n-o[a-1];for(var c=1;c<=i[a];c++){var l=cc.find("booster/booster"+c,r);c<=s?(l.active=!0,t.extra.indexOf(c)>=0?l.getChildByName("state").getComponent(cc.Sprite).spriteFrame=e.getSpriteFrame("theme140_map_right"):l.getChildByName("state").getComponent(cc.Sprite).spriteFrame=e.getSpriteFrame("theme140_map_wrong")):l.active=!1}}else r.getChildByName("completed").active=!1,r.getChildByName("booster").active=!1,r.getChildByName("frame").active=!0}var _=cc.find("layout/pos",this._map);_.active=-1==o.indexOf(n);for(var h=1;h<=19;h++)if(-1==o.indexOf(h)){var u=cc.find("layout/p"+h,this._map);u.getComponent(cc.Sprite).spriteFrame=h<=n?e.getSpriteFrame("theme140_map_end5"):e.getSpriteFrame("theme140_map_end5_1"),h==n&&(_.position=cc.v2(u.x-4,u.y+4),_.getComponent(sp.Skeleton).setAnimation(0,"animation2",!0))}},onEventTotalbetUpdated:function(){var e=cc.vv.gameData.GetBetIdx()<cc.vv.gameData.getUnlockIdx();e!=this._islock&&(this._islock=e,e?this._collect.getChildByName("lock").getComponent(sp.Skeleton).setAnimation(0,"animation3",!1):(this._collect.getChildByName("lock").getComponent(sp.Skeleton).setAnimation(0,"animation4",!1),Global.SlotsSoundMgr.playEffect("base/unlock")))},onClickCollect:function(){if(cc.vv.gameData.GetBottomScript().GetSpinBtnState()&&!(cc.vv.gameData.GetAutoModelTime()>0||cc.vv.gameData.GetFreeTime()>0)){if(this._islock){var e=cc.vv.gameData.getUnlockIdx();cc.vv.gameData.GetBottomScript().SetBetIdx(e)}this.showTips()}},onClickMap:function(){if(cc.vv.gameData.GetBottomScript().GetSpinBtnState()&&!(cc.vv.gameData.GetAutoModelTime()>0||cc.vv.gameData.GetFreeTime()>0||this._islock)){var e=cc.vv.gameData.getCollectData();this._idx!=e.idx&&this.refreshMap(),this.showMap(!0,!1)}},onClickBack:function(){this.showMap(!1)},showTips:function(){this._tip.stopAllActions(),this._tip.opacity>0?this._tip.runAction(cc.fadeOut(.2)):this._tip.runAction(cc.sequence(cc.fadeIn(.1),cc.delayTime(5),cc.fadeOut(.2)))},showMap:function(e,t){var n=this;return i(regeneratorRuntime.mark(function o(){var i,a,r,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(n._show!=e){o.next=2;break}return o.abrupt("return");case 2:if(n._show=e,n._processing=!1,cc.vv.gameData.GetBottomScript().ShowInputMask(e),(i=n._map.getChildByName("layout")).stopAllActions(),!e){o.next=37;break}if(cc.vv.gameData.GetBottomScript().ShowBtnsByState("moveing_1"),Global.SlotsSoundMgr.playEffect("map/map_open"),n._map.active=!0,i.y=1600,i.runAction(cc.moveTo(.4,0,0)),a=cc.vv.gameData.getCollectData().idx,r=cc.find("layout/path",n._map),s=r.getComponent(sp.Skeleton),!t){o.next=33;break}return cc.find("layout/btn_back",n._map).active=!1,o.next=20,n.Sleep(.5);case 20:return r.active=!0,s.setAnimation(0,"animation"+(a-1),!1),s.addAnimation(0,"animation"+(a-1)+"_1",!1),[4,8,13,19].indexOf(a)>=0?Global.SlotsSoundMgr.playEffect("map/map_move2"):Global.SlotsSoundMgr.playEffect("map/map_move1"),o.next=27,n.Sleep(.5);case 27:return n.refreshMap(),o.next=30,n.Sleep(2.5);case 30:n.onClickBack(),o.next=35;break;case 33:a>1?(r.active=!0,s.setAnimation(0,"animation"+(a-1)+"_1",!1)):r.active=!1,cc.find("layout/btn_back",n._map).active=!0;case 35:o.next=40;break;case 37:cc.vv.gameData.GetBottomScript().CanDoNextRound(),Global.SlotsSoundMgr.playEffect("map/map_close"),i.runAction(cc.sequence(cc.moveTo(.3,0,1600),cc.callFunc(function(){n._map.active=!1})));case 40:case"end":return o.stop()}},o)}))()}}),cc._RF.pop()},{}],TheUnicorn_GameData:[function(e,t,n){"use strict";cc._RF.push(t,"cd369hU0+lN+qkAvlQpRc3f","TheUnicorn_GameData"),cc.Class({extends:e("LMSlots_GameData_Base"),properties:{_isRespin:!1,_collect:null},init:function(e,t,n){this._super(e,t,n),this.setCollectData(e.collect)},getRandomSymbol:function(){var e=cc.vv.gameData.getGameCfg().randomSymbols;return this._isRespin&&(e=[3,13,13]),e[Global.random(0,e.length-1)]},setRespin:function(e){this._isRespin=e},isFirstTriggerFree:function(){return this.GetFreeTime()>0&&this.GetFreeTime()==this.GetTotalFree()},isLastEndFree:function(){return 0==this.GetFreeTime()&&this.GetTotalFree()>0},getFreeWinCoin:function(){return this._gameInfo.freeWinCoin},setCollectData:function(e){e&&(this._collect=e)},getCollectData:function(){return this._collect},getUnlockIdx:function(){return this.getCollectData().min},isLocked:function(){return this.GetBetIdx()<this.getUnlockIdx()},addCollectBooster:function(e){this._collect.extra||(this._collect.extra=[]),this._collect.extra.push(e)},sendGameData:function(e){var t={c:MsgId.SLOT_SUBGAME_DATA,gameid:this._gameId,data:e};cc.vv.NetManager.send(t,!0)}}),cc._RF.pop()},{LMSlots_GameData_Base:void 0}],TheUnicorn_Logic:[function(e,t,n){"use strict";cc._RF.push(t,"1cafdC/UDNAB6xrfDkPz0t0","TheUnicorn_Logic"),cc.Class({extends:e("LMSlots_Logic_Base"),properties:{},onLoad:function(){this._super();var e={};Global.TheUnicorn=e,e.Logic=this,e.Collect=this.node.getComponent("TheUnicorn_Collect"),e.Pop=this.node.getComponent("TheUnicorn_Pop"),e.Wheel=this.node.getComponent("TheUnicorn_Wheel"),e.Slots=cc.find("safe_node/slots",this.node).getComponent("TheUnicorn_Slots")},onDestroy:function(){Global.TheUnicorn=null}}),cc._RF.pop()},{LMSlots_Logic_Base:void 0}],TheUnicorn_Pop:[function(e,t,n){"use strict";function o(e,t,n,o,i,a,r){try{var s=e[a](r),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var r=e.apply(t,n);function s(e){o(r,i,a,s,c,"next",e)}function c(e){o(r,i,a,s,c,"throw",e)}s(void 0)})}}cc._RF.push(t,"a44f1gthINLqJmj7Bzicy6g","TheUnicorn_Pop"),cc.Class({extends:cc.Component,properties:{_pop:null,_frame:null,_respin_trigger:null,_respin_end:null,_respin_press_start:null,_free_start:null,_free_end:null,_wheel_start:null,_wheel_end:null,_super_free_start:null,_super_free_end:null,_freeWin:0,_wheelData:null,_wheelResult:null,_freeStartClicked:!1,_freeEndClicked:!1,_wheelStartClicked:!1,_wheelEndClicked:!1,_superFreeStartClicked:!1,_superFreeEndClicked:!1},onLoad:function(){this._pop=cc.find("safe_node/pop_ui",this.node),this._respin_trigger=this._pop.getChildByName("respin_trigger"),this._respin_end=this._pop.getChildByName("respin_end"),this._respin_press_start=this._pop.getChildByName("respin_press_start"),this._respin_press_start.on("click",this.onClickRespinStart.bind(this)),this._frame=this._pop.getChildByName("frame"),this._free_start=this._frame.getChildByName("free_start"),this._free_start.getChildByName("btn_start").on("click",this.onClickFreeStart.bind(this)),this._free_end=this._frame.getChildByName("free_end"),this._wheel_start=this._frame.getChildByName("wheel_start"),this._wheel_start.getChildByName("btn_start").on("click",this.onClickWheelStart.bind(this)),this._wheel_end=this._frame.getChildByName("wheel_end"),this._super_free_start=this._frame.getChildByName("super_free_start"),this._super_free_start.getChildByName("btn_start").on("click",this.onClickSuperFreeStart.bind(this)),this._super_free_end=this._frame.getChildByName("super_free_end"),this._super_free_end.getChildByName("btn_collect").on("click",this.onClickSuperFreeEnd.bind(this)),cc.vv.NetManager.registerMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,this)},onDestroy:function(){cc.vv.NetManager.unregisterMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,!1,this)},Sleep:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,o){t.scheduleOnce(function(){n()},e)}));case 1:case"end":return n.stop()}},n)}))()},showTransition:function(e,t){var n=this;return i(regeneratorRuntime.mark(function o(){var i,a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if((i=cc.find("safe_node/"+e,n.node)).active=!0,a=i.getComponent(sp.Skeleton),"qieping1"!=e){o.next=11;break}return a.setAnimation(0,"skill",!1),o.next=7,cc.vv.gameData.awaitTime(1.5);case 7:t&&t(),i.active=!1,o.next=13;break;case 11:a.setAnimation(0,"animation",!1),a.setCompleteListener(function(){t&&t(),i.active=!1});case 13:case"end":return o.stop()}},o)}))()},PlayRoleAnimation:function(e,t){},showRespinStart:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e._pop.active=!0,e._respin_trigger.active=!0,Global.showAlertAction(e._respin_trigger,!0,.1,1,null),Global.SlotsSoundMgr.stopBgm(),Global.SlotsSoundMgr.playEffect("bonus/bonus_respin_show"),t.next=7,e.Sleep(2);case 7:return Global.showAlertAction(e._respin_trigger,!1,1,.1,function(){e._respin_trigger.active=!1}),t.next=10,e.Sleep(.4);case 10:return e.showTransition("qieping2"),Global.SlotsSoundMgr.playEffect("base/transition_bonus"),t.next=14,e.Sleep(.8);case 14:return Global.TheUnicorn.Slots.ShowRespinReels(),Global.SlotsSoundMgr.playBgm("bonus/bonus_bgm"),t.next=18,e.Sleep(.8);case 18:e._respin_press_start.active=!0,(n=e._respin_press_start.getChildByName("press").getComponent(sp.Skeleton)).setAnimation(0,"animation1",!1),n.addAnimation(0,"animation",!0),Global.SlotsSoundMgr.playEffect("bonus/bonus_start_show"),cc.vv.gameData.checkAutoPlay(e._respin_press_start,i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Global.SlotsSoundMgr.playEffect("bonus/bonus_start_click"),e._respin_press_start.getChildByName("press").getComponent(sp.Skeleton).setAnimation(0,"animation2",!1),t.next=5,e.Sleep(.5);case 5:return e._respin_press_start.active=!1,e._pop.active=!1,t.next=9,e.Sleep(.5);case 9:Global.TheUnicorn.Slots.CanDoNextRound(),cc.vv.gameData.GetBottomScript().ShowBtnsByState("moveing_1");case 11:case"end":return t.stop()}},t)})));case 24:case"end":return t.stop()}},t)}))()},onClickRespinStart:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e._respin_press_start.stopAllActions(),Global.SlotsSoundMgr.playEffect("bonus/bonus_start_click"),e._respin_press_start.getChildByName("press").getComponent(sp.Skeleton).setAnimation(0,"animation2",!1),t.next=6,e.Sleep(.5);case 6:return e._respin_press_start.active=!1,e._pop.active=!1,t.next=10,e.Sleep(.5);case 10:Global.TheUnicorn.Slots.CanDoNextRound(),cc.vv.gameData.GetBottomScript().ShowBtnsByState("moveing_1");case 12:case"end":return t.stop()}},t)}))()},showRespinEnd:function(e){var t=this;return new Promise(function(n){t._pop.active=!0,t._respin_end.active=!0,Global.showAlertAction(t._respin_end,!0,.1,1,null),Global.SlotsSoundMgr.stopBgm(),Global.SlotsSoundMgr.playEffect("bonus/bonus_respin_show");var o=cc.find("diban/lbl_coin",t._respin_end);o.getComponent("LabelRollCmp").startRoll(0,e,2);var a=cc.find("diban/btn_collect",t._respin_end),r=function(){var r=i(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(Global.SlotsSoundMgr.playEffect("bonus/bonus_start_click"),a.off("click"),!(Global.FormatCommaNumToNum(o.getComponent(cc.Label).string)<e)){i.next=7;break}return o.getComponent("LabelRollCmp").stopRoll(),o.getComponent(cc.Label).string=Global.FormatNumToComma(e),i.next=7,cc.vv.gameData.awaitTime(.3);case 7:Global.showAlertAction(t._respin_end,!1,1,.1,function(){t._respin_end.active=!1,t._pop.active=!1,n()});case 8:case"end":return i.stop()}},i)}));return function(){return r.apply(this,arguments)}}();cc.vv.gameData.checkAutoPlay(a,r),a.off("click"),a.on("click",function(){a.stopAllActions(),r()})})},showFreeStart:function(e){var t=this;Global.SlotsSoundMgr.stopBgm(),this._pop.active=!0,this._frame.active=!0,this._free_start.active=!0,this._free_start.getChildByName("lbl_count").getComponent(cc.Label).string=""+e,Global.showAlertAction(this._frame,!0,.1,1,null),Global.SlotsSoundMgr.playEffect("free/free_dialog_start_show");var n=this._free_start.getChildByName("btn_start");cc.vv.gameData.checkAutoPlay(n,i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._freeStartClicked){e.next=2;break}return e.abrupt("return");case 2:return t._freeStartClicked=!0,Global.SlotsSoundMgr.playEffect("base/common_click"),Global.showAlertAction(t._frame,!1,1,.1,function(){t._pop.active=!1,t._frame.active=!1,t._free_start.active=!1,t.PlayRoleAnimation("animation2",!1),Global.SlotsSoundMgr.playEffect("free/bison_down"),t._freeStartClicked=!1}),e.next=7,t.Sleep(.6);case 7:return t.showTransition("qieping1"),Global.SlotsSoundMgr.playEffect("base/transition_free"),e.next=11,t.Sleep(1);case 11:Global.TheUnicorn.Slots.ShowGameview(!0);case 12:case"end":return e.stop()}},e)})))},onClickFreeStart:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._freeStartClicked){t.next=2;break}return t.abrupt("return");case 2:return e._free_start.getChildByName("btn_start").stopAllActions(),e._freeStartClicked=!0,Global.SlotsSoundMgr.playEffect("base/common_click"),Global.showAlertAction(e._frame,!1,1,.1,function(){e._pop.active=!1,e._frame.active=!1,e._free_start.active=!1,e.PlayRoleAnimation("animation2",!1),Global.SlotsSoundMgr.playEffect("free/bison_down"),e._freeStartClicked=!1}),t.next=9,e.Sleep(.6);case 9:return e.showTransition("qieping1"),Global.SlotsSoundMgr.playEffect("base/transition_free"),t.next=13,e.Sleep(1);case 13:Global.TheUnicorn.Slots.ShowGameview(!0);case 14:case"end":return t.stop()}},t)}))()},showFreeEnd:function(e){var t=this;Global.SlotsSoundMgr.stopBgm(),this._freeWin=e,this._pop.active=!0,this._frame.active=!0,this._free_end.active=!0,Global.showAlertAction(this._frame,!0,.1,1,null);var n=cc.find("lbl_coin",this._free_end);n.getComponent("LabelRollCmp").startRoll(0,e,2),Global.SlotsSoundMgr.playEffect("free/free_dialog_collect_show");var o=this._free_end.getChildByName("btn_collect"),a=function(){var o=i(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!t._freeEndClicked){o.next=2;break}return o.abrupt("return");case 2:if(t._freeEndClicked=!0,Global.SlotsSoundMgr.playEffect("free/free_dialog_click"),!(Global.FormatCommaNumToNum(n.getComponent(cc.Label).string)<e)){o.next=9;break}return n.getComponent("LabelRollCmp").stopRoll(),n.getComponent(cc.Label).string=Global.FormatNumToComma(e),o.next=9,cc.vv.gameData.awaitTime(.3);case 9:return Global.showAlertAction(t._frame,!1,1,.1,function(){t._pop.active=!1,t._frame.active=!1,t._free_end.active=!1,t.showTransition("qieping1"),Global.SlotsSoundMgr.playEffect("base/transition_free"),t._freeEndClicked=!1}),o.next=12,t.Sleep(1.2);case 12:return Global.TheUnicorn.Slots.ShowGameview(!1),Global.TheUnicorn.Slots.ResizeReels(5,3),Global.TheUnicorn.Slots.Resume(),t.PlayRoleAnimation("animation1",!0),Global.SlotsSoundMgr.playNormalBgm(!0),o.next=19,t.Sleep(.6);case 19:Global.TheUnicorn.Slots.ShowBottomWin(t._freeWin,t._freeWin,!0,function(){Global.TheUnicorn.Slots.CanDoNextRound()});case 20:case"end":return o.stop()}},o)}));return function(){return o.apply(this,arguments)}}();cc.vv.gameData.checkAutoPlay(o,a),o.off("click"),o.on("click",function(){o.stopAllActions(),a()})},showWheelStart:function(e){var t=this;Global.SlotsSoundMgr.stopBgm(),this._wheelData=e,this._pop.active=!0,this._frame.active=!0,this._wheel_start.active=!0,Global.showAlertAction(this._frame,!0,.1,1,null),Global.SlotsSoundMgr.playEffect("map/wheel_start_show");var n=this._wheel_start.getChildByName("btn_start");cc.vv.gameData.checkAutoPlay(n,function(){if(!t._wheelStartClicked){t._wheel_start.getChildByName("btn_start");t._wheelStartClicked=!0,Global.SlotsSoundMgr.playEffect("base/common_click"),Global.showAlertAction(t._frame,!1,1,.1,function(){t._pop.active=!1,t._frame.active=!1,t._wheel_start.active=!1,Global.TheUnicorn.Wheel.showSpin(t._wheelData),t._wheelStartClicked=!1})}})},onClickWheelStart:function(){var e=this;this._wheelStartClicked||(this._wheel_start.getChildByName("btn_start").stopAllActions(),this._wheelStartClicked=!0,Global.SlotsSoundMgr.playEffect("base/common_click"),Global.showAlertAction(this._frame,!1,1,.1,function(){e._pop.active=!1,e._frame.active=!1,e._wheel_start.active=!1,Global.TheUnicorn.Wheel.showSpin(e._wheelData),e._wheelStartClicked=!1}))},showWheelEnd:function(e){var t=this;Global.SlotsSoundMgr.stopBgm(),this._wheelResult=e,this._pop.active=!0,this._frame.active=!0,this._wheel_end.active=!0;var n=this._wheel_end.getChildByName("coin"),o=this._wheel_end.getChildByName("booster"),a=n.getChildByName("lbl_coin");a.getComponent("LabelRollCmp").startRoll(0,e.num,2);var r=100,s=250,c=-244;if(e.extra){o.active=!0;var l=cc.vv.gameData.GetAtlasByName("common_map");o.getChildByName("booster").spriteFrame=l.getSpriteFrame("theme140_map_booster"+e.extra)}else r=0,s=130,c=-144,o.active=!1;n.y=r,this._wheel_end.getChildByName("title").y=s,this._wheel_end.getChildByName("btn_collect").y=c,Global.showAlertAction(this._frame,!0,.1,1,null),Global.SlotsSoundMgr.playEffect("map/wheel_end_show");var _=this._wheel_end.getChildByName("btn_collect"),h=function(){var n=i(regeneratorRuntime.mark(function n(){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t._wheelEndClicked){n.next=2;break}return n.abrupt("return");case 2:if(t._wheelEndClicked=!0,Global.SlotsSoundMgr.playEffect("base/common_click"),!(Global.FormatCommaNumToNum(a.getComponent(cc.Label).string)<e.num)){n.next=9;break}return a.getComponent("LabelRollCmp").stopRoll(),a.getComponent(cc.Label).string=Global.FormatNumToComma(e.num),n.next=9,cc.vv.gameData.awaitTime(.3);case 9:return Global.TheUnicorn.Wheel.hide(),Global.showAlertAction(t._frame,!1,1,.1,function(){t._pop.active=!1,t._frame.active=!1,t._wheel_end.active=!1,t._wheelEndClicked=!1}),cc.vv.gameData.getCollectData().num=0,Global.TheUnicorn.Collect.refreshProgress(),n.next=16,t.Sleep(.5);case 16:return Global.TheUnicorn.Collect.showMap(!0,!0),n.next=19,t.Sleep(4);case 19:o=t._wheelResult.num,Global.TheUnicorn.Slots.ShowBottomWin(o,o,!0,function(){Global.TheUnicorn.Slots.CanDoNextRound()});case 21:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}();cc.vv.gameData.checkAutoPlay(_,h),_.off("click"),_.on("click",function(){_.stopAllActions(),h()})},showBoosters:function(e){for(var t=cc.vv.gameData.getCollectData(),n=t.idx,o=[4,8,13,19],i=[2,3,4,5],a=0,r=0;r<4;r++)if(n<=o[r]){a=i[r];break}for(var s=1;s<=5;s++){var c=e.getChildByName("booster"+s);s<=a?(c.active=!0,c.getChildByName("mask").active=t.extra.indexOf(s)<0):c.active=!1}},showSuperFreeStart:function(e){var t=this;Global.SlotsSoundMgr.stopBgm(),this._pop.active=!0,this._frame.active=!0,this._super_free_start.active=!0,this.showBoosters(this._super_free_start.getChildByName("boosters")),this._super_free_start.getChildByName("lbl_count").getComponent(cc.Label).string=""+e,Global.showAlertAction(this._frame,!0,.1,1,null),Global.SlotsSoundMgr.playEffect("free/free_dialog_start_show");var n=this._super_free_start.getChildByName("btn_start");cc.vv.gameData.checkAutoPlay(n,function(){Global.SlotsSoundMgr.playEffect("base/common_click");t._super_free_start.getChildByName("btn_start");cc.vv.gameData.sendGameData({rtype:2})})},onClickSuperFreeStart:function(){Global.SlotsSoundMgr.playEffect("base/common_click"),this._super_free_start.getChildByName("btn_start").stopAllActions(),cc.vv.gameData.sendGameData({rtype:2})},OnMsgSuperFree:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t._superFreeStartClicked){n.next=2;break}return n.abrupt("return");case 2:return t._superFreeStartClicked=!0,Global.showAlertAction(t._frame,!1,1,.1,function(){t._pop.active=!1,t._frame.active=!1,t._super_free_start.active=!1,t.PlayRoleAnimation("animation2",!1),Global.SlotsSoundMgr.playEffect("free/bison_down"),t._superFreeStartClicked=!1}),n.next=6,t.Sleep(.6);case 6:return t.showTransition("qieping1"),Global.SlotsSoundMgr.playEffect("base/transition_free"),n.next=10,t.Sleep(1);case 10:Global.TheUnicorn.Slots.ResizeReels(e.data.col,e.data.row),Global.TheUnicorn.Slots.ShowGameview(!0);case 12:case"end":return n.stop()}},n)}))()},OnRecvMsgSubAction:function(e){200==e.code&&2==e.data.rtype&&this.OnMsgSuperFree(e)},showSuperFreeEnd:function(e){var t=this;Global.SlotsSoundMgr.stopBgm(),this._freeWin=e,this._pop.active=!0,this._frame.active=!0,this._super_free_end.active=!0,this.showBoosters(this._super_free_end.getChildByName("boosters")),Global.showAlertAction(this._frame,!0,.1,1,null),cc.find("lbl_coin",this._super_free_end).getComponent("LabelRollCmp").startRoll(0,e,2),Global.SlotsSoundMgr.playEffect("free/free_dialog_collect_show");var n=this._super_free_end.getChildByName("btn_collect");cc.vv.gameData.checkAutoPlay(n,i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._superFreeEndClicked){e.next=2;break}return e.abrupt("return");case 2:return t._superFreeEndClicked=!0,t._super_free_end.getChildByName("btn_collect"),Global.SlotsSoundMgr.playEffect("base/common_click"),Global.showAlertAction(t._frame,!1,1,.1,function(){t._pop.active=!1,t._frame.active=!1,t._super_free_end.active=!1,t.showTransition("qieping1"),Global.SlotsSoundMgr.playEffect("base/transition_free"),t._superFreeEndClicked=!1}),cc.vv.gameData.getCollectData().num=0,Global.TheUnicorn.Collect.refreshProgress(),e.next=11,t.Sleep(1.2);case 11:return Global.TheUnicorn.Slots.ShowGameview(!1),Global.TheUnicorn.Slots.ResizeReels(5,3),t.PlayRoleAnimation("animation1",!0),Global.SlotsSoundMgr.playNormalBgm(!0),e.next=17,t.Sleep(1.5);case 17:return Global.TheUnicorn.Collect.showMap(!0,!0),e.next=20,t.Sleep(4);case 20:Global.TheUnicorn.Slots.ShowBottomWin(t._freeWin,t._freeWin,!0,function(){Global.TheUnicorn.Slots.CanDoNextRound()});case 21:case"end":return e.stop()}},e)})))},onClickSuperFreeEnd:function(){var e=this;return i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._superFreeEndClicked){t.next=2;break}return t.abrupt("return");case 2:return e._superFreeEndClicked=!0,e._super_free_end.getChildByName("btn_collect").stopAllActions(),Global.SlotsSoundMgr.playEffect("base/common_click"),Global.showAlertAction(e._frame,!1,1,.1,function(){e._pop.active=!1,e._frame.active=!1,e._super_free_end.active=!1,e.showTransition("qieping1"),Global.SlotsSoundMgr.playEffect("base/transition_free"),e._superFreeEndClicked=!1}),cc.vv.gameData.getCollectData().num=0,Global.TheUnicorn.Collect.refreshProgress(),t.next=12,e.Sleep(1.2);case 12:return Global.TheUnicorn.Slots.ShowGameview(!1),Global.TheUnicorn.Slots.ResizeReels(5,3),e.PlayRoleAnimation("animation1",!0),Global.SlotsSoundMgr.playNormalBgm(!0),t.next=18,e.Sleep(1.5);case 18:return Global.TheUnicorn.Collect.showMap(!0,!0),t.next=21,e.Sleep(4);case 21:Global.TheUnicorn.Slots.ShowBottomWin(e._freeWin,e._freeWin,!0,function(){Global.TheUnicorn.Slots.CanDoNextRound()});case 22:case"end":return t.stop()}},t)}))()}}),cc._RF.pop()},{}],TheUnicorn_PrizePool_jp:[function(e,t,n){"use strict";cc._RF.push(t,"86bceSpI2xOMb7v7D2ReCCp","TheUnicorn_PrizePool_jp"),cc.Class({extends:e("LMSlotMachine_PrizePool"),properties:{},updateJackPot:function(){if(this._jackpotLabel)if(this._PauseNum){var e=Global.S2P(this._PauseNum*this._mult);this._jackpotLabel.string=this.convertNumToShort(e,1e3,4)}else{var t=Global.S2P(this._jackpotNum*this._mult);this._jackpotLabel.string=this.convertNumToShort(t,1e3,4)}},convertNumToShort:function(e,t,n,o,i){var a=["","K","M","B","T","Q"],r=0!=e?e/Math.abs(e):1;e=Math.abs(e),o&&(a=o),t=null==t?1e3:t,n=null==n?1:n,i=null==i?t:i;for(var s=0;e>=i;)s++,e/=t;return(e=e.toPrecision(n))*r+a[s]}}),cc._RF.pop()},{LMSlotMachine_PrizePool:void 0}],TheUnicorn_PrizePool:[function(e,t,n){"use strict";cc._RF.push(t,"58228XaFHlGtZnWmcX5fy2p","TheUnicorn_PrizePool"),cc.Class({extends:e("LMSlots_PrizePool_Base"),properties:{},start:function(){}}),cc._RF.pop()},{LMSlots_PrizePool_Base:void 0}],TheUnicorn_Reel:[function(e,t,n){"use strict";cc._RF.push(t,"d0665iOY/hIMqEY6yzS6TuE","TheUnicorn_Reel"),cc.Class({extends:e("LMSlots_Reel_Base"),properties:{},SetCount:function(e){if(this._nCount!=e){if(this._nCount=e,this._symbols.length<this._nCount+1)for(var t=this._nCount+1-this._symbols.length,n=0;n<t;n++)this.CreateOneSymbol();else if(this._symbols.length>this._nCount+1)for(var o=this._symbols.length-(this._nCount+1),i=0;i<o;i++){this._symbols.pop().node.destroy()}this.ReLayOut()}},StartRecycleSymbol:function(e){}}),cc._RF.pop()},{LMSlots_Reel_Base:void 0}],TheUnicorn_Respin:[function(e,t,n){"use strict";var o;function i(e,t,n,o,i,a,r){try{var s=e[a](r),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,i)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var r=e.apply(t,n);function s(e){i(r,o,a,s,c,"next",e)}function c(e){i(r,o,a,s,c,"throw",e)}s(void 0)})}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"a4dccPWtH9A4bKnyDzlTdCn","TheUnicorn_Respin");var s=0,c=1,l=2,_=3;cc.Class({extends:cc.Component,properties:(o={_jp_sandian_01:null,_jp_sandian_02:null,_pick_dj:null,_pick_award:null,_bonuses:[],_processing:!1,_jp:1,_spin_cnt:0,_pick_cnt:0},r(o,"_pick_dj",null),r(o,"_pick_award",null),r(o,"_fly",null),r(o,"_flash",null),r(o,"_effect_layer",null),o),onLoad:function(){var e=this;this._jp_sandian_01=cc.find("Canvas/safe_node/layout/jackpot/jp_sandian_01"),this._jp_sandian_02=cc.find("Canvas/safe_node/layout/jackpot/jp_sandian_02");var t=this.node.getChildByName("layout");this._bonuses=[];for(var n=function(n){var o=t.getChildByName("bonus"+n);o.on("click",function(){this.onClickBonus(o)},e),e._bonuses[n]={node:o,lbl_coin:o.getChildByName("lbl_coin").getComponent(cc.Label),bonus_bg:o.getChildByName("bonus_bg"),diamond:o.getChildByName("diamond"),pick:o.getChildByName("pick"),state:c},o.active=!0},o=1;o<=15;o++)n(o);this._respin_dj=this.node.getChildByName("respin_dj"),this._pick_dj=this.node.getChildByName("pick_dj"),this._pick_award=this.node.getChildByName("pick_award"),this._effect_layer=cc.find("Canvas/safe_node/effect_layer"),this._fly=this._effect_layer.getChildByName("fly"),this._flash=this._effect_layer.getChildByName("flash"),cc.vv.NetManager.registerMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,this)},onDestroy:function(){cc.vv.NetManager.unregisterMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,!1,this)},ShowBonusState:function(e,t,n){if(t!=s)if(e.node.active=!0,e.lbl_coin.node.active=!1,e.bonus_bg.active=!1,e.pick.active=!1,e.diamond.active=!1,e.state=t,t==c)e.diamond.active=!0;else if(t==l){e.pick.active=!0;var o=e.pick.getComponent(sp.Skeleton);o.setAnimation(0,"animation1",!1),o.addAnimation(0,"animation2",!0)}else t==_&&(e.lbl_coin.node.active=!0,e.lbl_coin.node.color=cc.Color.WHITE,e.lbl_coin.string=n?Global.convertNumToShort(n,1e3,0):"",e.bonus_bg.active=!0,e.bonus_bg.color=cc.Color.WHITE);else e.node.active=!1},ShowBounsCoin:function(e,t){e.lbl_coin.node.active=!0,e.lbl_coin.string=t?Global.convertNumToShort(t,1e3,0):"",e.lbl_coin.node.stopAllActions(),e.lbl_coin.node.scale=.1,e.lbl_coin.node.runAction(cc.scaleTo(.2,1))},ShowSpin:function(e){Global.TheUnicorn.Slots.ShowReelsEmpty(),this.node.active=!0;for(var t=1;t<=15;t++)this.ShowBonusState(this._bonuses[t],s);this.UpdateSpin(e,!0)},UpdateSpin:function(e,t){var n=this;return a(regeneratorRuntime.mark(function o(){var i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(n._spin_cnt=e.spin,n.SetSpinCnt(n._spin_cnt),!t){o.next=6;break}n.SetJackpot(e.pool),o.next=8;break;case 6:return o.next=8,n.UpdateJackpot(e.pool);case 8:if(e.cards)for(i=0;i<e.cards.length;i++)3==e.cards[i]?n.ShowBonusState(n._bonuses[i+1],c):n.ShowBonusState(n._bonuses[i+1],s);cc.vv.gameData.SetRespinTime(e.spin);case 10:case"end":return o.stop()}},o)}))()},ShowPick:function(e){if(this._processing=!1,Global.TheUnicorn.Slots.ShowReelsEmpty(),this.node.active=!0,this._pick_cnt=e.pick,this.SetPickCnt(this._pick_cnt),e.cards)for(var t=0;t<e.cards.length;t++)3==e.cards[t]?this.ShowBonusState(this._bonuses[t+1],l):this.ShowBonusState(this._bonuses[t+1],s);if(e.indexs&&e.indexs.all)for(var n=0;n<e.indexs.all.length;n++)this.ShowBonusState(this._bonuses[e.indexs.all[n]],l);if(e.result&&e.result.pick)for(var o=0;o<e.result.pick.length;o++){var i=e.result.pick[o];this.ShowBonusState(this._bonuses[i.idx],_,i.coin)}Global.SlotsSoundMgr.playEffect("bonus/bonus_change"),this.setAutoPlay()},Hide:function(){this._jp_sandian_01.active=!1,this._jp_sandian_02.active=!1,this.node.active=!1},setAutoPlay:function(){for(var e=[],t=1;t<=15;t++)this._bonuses[t].state==l&&e.push(this._bonuses[t].node);if(e.length>0){var n=Global.random(0,e.length-1),o=this;cc.vv.gameData.checkAutoPlay(e[n],function(){o.onClickBonus(e[n])})}},onClickBonus:function(e){if(!this._processing)for(var t=1;t<=15;t++)if(this._bonuses[t].node.stopAllActions(),e==this._bonuses[t].node&&this._bonuses[t].state==l){this.SetPickCnt(this._pick_cnt-1),cc.vv.gameData.sendGameData({rtype:4,idx:t}),this._processing=!0;break}},SetCnt:function(e,t){e=Math.max(0,e),cc.find("progress/lbl_cnt",this.node).getComponent(cc.Label).string=""+e;var n=cc.vv.gameData.GetAtlasByName("base"),o=t+"_1";e>1&&(o=t+"_2"),cc.find("progress/txt_remaining",this.node).getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame(o)},SetSpinCnt:function(e){this.SetCnt(e,"theme140_respin_2")},OnStartSpin:function(){this.SetSpinCnt(this._spin_cnt-1)},SetPickCnt:function(e){this.SetCnt(e,"theme140_respin_3")},UpdateJackpot:function(e){var t=this;return a(regeneratorRuntime.mark(function n(){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t._jp==e){n.next=9;break}return t._jp_sandian_02.active=!0,t._jp_sandian_02.position=cc.find("prizePool_"+e,t._jp_sandian_02.parent).position,o=e>8?"animation1":"animation2",t._jp_sandian_02.getComponent(sp.Skeleton).setAnimation(0,o,!1),n.next=7,t.Sleep(.5);case 7:t.SetJackpot(e),Global.SlotsSoundMgr.playEffect("bonus/bonus_reset");case 9:case"end":return n.stop()}},n)}))()},SetJackpot:function(e){if(this._jp=e,e>0){this._jp_sandian_01.active=!0,this._jp_sandian_01.position=cc.find("prizePool_"+e,this._jp_sandian_01.parent).position;var t=e>8?"animation1":"animation4";this._jp_sandian_01.getComponent(sp.Skeleton).setAnimation(0,t,!0)}else this._jp_sandian_01.active=!1},Sleep:function(e){var t=this;return a(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,o){t.scheduleOnce(function(){n()},e)}));case 1:case"end":return n.stop()}},n)}))()},playClickAni:function(e){var t=this;return a(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t._respin_dj.active=!0,t._respin_dj.position=e,t._respin_dj.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),n.next=5,t.Sleep(.3);case 5:t._pick_dj.active=!0,t._pick_dj.position=e,t._pick_dj.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),Global.SlotsSoundMgr.playEffect("bonus/pick_click");case 9:case"end":return n.stop()}},n)}))()},playAwardAni:function(e,t){this._pick_award.active=!0,this._pick_award.position=e,this._pick_award.getComponent(sp.Skeleton).setAnimation(0,t,!1)},playFlyAni:function(e,t){var n=this._effect_layer.convertToNodeSpaceAR(e),o=this._effect_layer.convertToNodeSpaceAR(t),i=cc.instantiate(this._fly);i.parent=this._effect_layer,i.position=n,i.active=!0,i.runAction(cc.sequence(cc.moveTo(.5,o),cc.fadeOut(.1),cc.destroySelf()))},playFlashAni:function(e,t){var n=this;return a(regeneratorRuntime.mark(function o(){var i,a,r,s,c;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:i=n._effect_layer.convertToNodeSpaceAR(e),a=n._effect_layer.convertToNodeSpaceAR(t),n._flash.active=!0,r=cc.v2(a.x,a.y).sub(cc.v2(i.x,i.y)),s=r.mag(),n._flash.scale=s/220,c=r.signAngle(cc.v2(1,0)),n._flash.angle=-c*cc.macro.DEG-90,n._flash.position=i,n._flash.getComponent(sp.Skeleton).setAnimation(0,"animation",!1);case 11:case"end":return o.stop()}},o)}))()},OpenBonus:function(e,t,n,o){var i=this;return a(regeneratorRuntime.mark(function a(){var r,s,c,l,h,u,p,d,m,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=i._bonuses[e.idx],s=r.node.position,c=r.node.convertToWorldSpaceAR(cc.v2(0,0)),a.next=5,i.playClickAni(s);case 5:return a.next=7,i.Sleep(.5);case 7:if(i.ShowBonusState(r,_),1!=e.prize){a.next=12;break}i.ShowBounsCoin(r,e.coin),a.next=69;break;case 12:if(2!=e.prize){a.next=36;break}return i.playAwardAni(s,"animation2_1"),a.next=16,i.Sleep(.5);case 16:l=0;case 17:if(!(l<o.length)){a.next=33;break}if((h=o[l].idx)==e.idx){a.next=30;break}return i.playAwardAni(s,"animation2_2"),Global.SlotsSoundMgr.playEffect("bonus/pick_upgrade"),a.next=24,i.Sleep(.3);case 24:return i.playFlashAni(c,i._bonuses[h].node.convertToWorldSpaceAR(cc.v2(0,0))),a.next=27,i.Sleep(.3);case 27:return i.ShowBounsCoin(i._bonuses[h],o[l].coin),a.next=30,i.Sleep(.2);case 30:l++,a.next=17;break;case 33:i.playAwardAni(s,"animation2_3"),a.next=69;break;case 36:if(3!=e.prize&&4!=e.prize){a.next=53;break}return i.playAwardAni(s,"animation"+e.prize),a.next=40,i.Sleep(.5);case 40:return Global.SlotsSoundMgr.playEffect("bonus/pick_increase"),u=cc.find("progress/lbl_cnt",i.node),p=u.convertToWorldSpaceAR(cc.v2(0,0)),i.playFlyAni(c,p),a.next=46,i.Sleep(.5);case 46:return(d=cc.find("progress/zj",i.node)).active=!0,d.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),a.next=51,i.Sleep(.5);case 51:a.next=69;break;case 53:if(5!=e.prize){a.next=69;break}return i.playAwardAni(s,"animation1"),a.next=57,i.Sleep(.5);case 57:if(Global.SlotsSoundMgr.playEffect("bonus/pick_jp"),!(m=cc.find("Canvas/safe_node/layout/jackpot/prizePool_"+i._jp))){a.next=68;break}return f=m.convertToWorldSpaceAR(cc.v2(0,0)),i.playFlyAni(c,f),a.next=64,i.Sleep(.5);case 64:return a.next=66,i.UpdateJackpot(n);case 66:a.next=69;break;case 68:cc.warn("prizePool_"+i,_jp+" not exist");case 69:i._pick_cnt=t,i.SetPickCnt(i._pick_cnt),i.ShowBounsCoin(r,e.coin);case 72:case"end":return a.stop()}},a)}))()},ShowResult:function(e){var t=this;return a(regeneratorRuntime.mark(function n(){var o,i,a,r,s,c,l,h,u,p,d,m;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(o=0;o<e.result.other.length;o++)i=e.result.other[o],a=t._bonuses[i.idx],t.ShowBonusState(a,_,i.coin),a.bonus_bg.color=cc.Color.GRAY,a.lbl_coin.node.color=cc.Color.GRAY;return Global.SlotsSoundMgr.stopBgm(),Global.SlotsSoundMgr.playEffect("bonus/bonus_end"),n.next=5,t.Sleep(2);case 5:r=0,s=cc.find("Canvas/safe_node/LMSlots_Bottom/winBg"),c=s.convertToWorldSpaceAR(cc.v2(0,0)),l=0;case 9:if(!(l<e.result.pick.length)){n.next=24;break}return h=e.result.pick[l],u=t._bonuses[h.idx],p=u.node.convertToWorldSpaceAR(cc.v2(0,0)),t.playFlyAni(p,c),Global.SlotsSoundMgr.playEffect("bonus/pick_hit"),n.next=17,t.Sleep(.5);case 17:return r+=h.coin,cc.vv.gameData.GetBottomScript().SetWin(r),n.next=21,t.Sleep(.4);case 21:l++,n.next=9;break;case 24:return(d=cc.find("Canvas/safe_node/layout/jackpot/prizePool_"+t._jp))&&(m=d.convertToWorldSpaceAR(cc.v2(0,0)),t.playFlashAni(m,c),Global.SlotsSoundMgr.playEffect("bonus/bonus_jp")),n.next=28,t.Sleep(.5);case 28:cc.vv.gameData.GetBottomScript().SetWin(e.coin);case 29:case"end":return n.stop()}},n)}))()},OnMsgPick:function(e){var t=this;return a(regeneratorRuntime.mark(function n(){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.data,n.next=3,t.OpenBonus(o.info,o.pick,o.pool,o.result.pick);case 3:if(!(o.pick<=0)){n.next=18;break}return n.next=6,t.ShowResult(o);case 6:return cc.vv.gameData.AddCoin(o.coin),n.next=9,Global.TheUnicorn.Pop.showRespinEnd(o.coin);case 9:return Global.TheUnicorn.Pop.showTransition("qieping2"),n.next=12,t.Sleep(1.2);case 12:return Global.TheUnicorn.Slots.ShowNormalReels(),t.Hide(),Global.SlotsSoundMgr.playNormalBgm(!0),n.next=17,new Promise(function(e){Global.TheUnicorn.Slots.ShowBottomWin(o.coin,o.coin,!0,e)});case 17:Global.TheUnicorn.Slots.CanDoNextRound();case 18:t._processing=!1,t.setAutoPlay();case 20:case"end":return n.stop()}},n)}))()},OnRecvMsgSubAction:function(e){200==e.code&&4==e.data.rtype&&this.OnMsgPick(e)}}),cc._RF.pop()},{}],TheUnicorn_Slots:[function(e,t,n){"use strict";function o(e,t,n,o,i,a,r){try{var s=e[a](r),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var r=e.apply(t,n);function s(e){o(r,i,a,s,c,"next",e)}function c(e){o(r,i,a,s,c,"throw",e)}s(void 0)})}}cc._RF.push(t,"fd7cfiV5t5J1LVoZYGf4KIg","TheUnicorn_Slots");cc.Class({extends:e("LMSlots_Slots_Base"),properties:{_wilds:[],_lbl_free_cnt:null,_lbl_total_cnt:null,_wild_move:null,_respin:null,_jp_sandian:null,_is_respin:!1,_is_super_free:!1},Init:function(){this._sw=130,this._sh=112,this._wild_move=this.node.getChildByName("wild_move").getComponent("TheUnicorn_WildMove"),this._respin=this.node.getChildByName("respin").getComponent("TheUnicorn_Respin"),this._super()},OnReelResized:function(e){var t=cc.Node.isNode(e)&&e.getComponent(cc.Widget);t&&t.alignMode===cc.Widget.AlignMode.ON_WINDOW_RESIZE&&(t.enabled=!0);for(var n=e._children,o=0;o<n.length;o++){var i=n[o];this.OnReelResized(i)}},ResizeReels:function(e,t){if(e>=5&&e<=6&&t>=3&&t<=4&&(this._col!=e||this._row!=t)){this._col=e,this._row=t;var n=5/e,o=130*n,i=112*n*t;cc.find("reels_bg",this.node).height=i,cc.find("reels",this.node).height=i,cc.find("reels_frame",this.node).height=i,cc.find("wild_move",this.node).height=i,cc.find("reels_bg/reel_bg6",this.node).active=e>=6,cc.find("reels/reel6",this.node).active=e>=6,this._topAniNode.scale=n;for(var a=0;a<this._reels.length;a++)for(var r=this._reels[a],s=0;s<r._symbols.length;s++)r._symbols[s].setAnimationToTop(!1);if(this._topAniNode.destroyAllChildren(),this._reels.length<e){var c=this._cfg.scripts.Reels,l=cc.find("reels/reel6",this.node),_=l.getComponent(c);_||(_=l.addComponent(c)).Init(5,t,this._topAniNode),this._reels.push(_)}else this._reels.length>e&&this._reels.pop();for(var h=0;h<this._reels.length;h++)this._reels[h].SetCount(t);for(var u=1;u<=e;u++)cc.find("reels/reel"+u+"/mask/holder",this.node).scale=n;cc.find("wild_move/layout",this.node).scale=n,this._wild_move.SetCol(e),this._wild_move.SetRow(t),this.OnReelResized(this.node);for(var p=1;p<=5;p++)cc.find("reels_bg/reel_bg"+p+"/line",this.node).x=(o-1)/2}},SetSlotsResult:function(e){var t=e.length/this._col,n=[];this._wilds=[];for(var o=0;o<e.length;o++){1!=e[o]&&14!=e[o]||this._wilds.push(o+1);Math.floor(o/t);var i=o%this._col;if(this._cfg.symbol[e[o]]){var a={};a.sid=e[o],a.data=3==e[o],n[i]||(n[i]=[]),n[i].unshift(a)}}for(var r=0;r<this._reels.length;r++){var s=this._reels[r],c=n[r];s.SetResult(c)}},Sleep:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,o){t.scheduleOnce(function(){n()},e)}));case 1:case"end":return n.stop()}},n)}))()},ShowDiamondFly:function(e){if(this._diamond||(this._diamond=cc.instantiate(this.node.getChildByName("diamond"))),!this._diamondEndPos){var t=cc.find("collect/icon",this.node);this._diamondEndPos=this.node.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.v2(0,0)))}var n=cc.instantiate(this._diamond);n.active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"animation",!0);var o=this.node.convertToNodeSpaceAR(e);n.position=o,n.parent=this.node,n.runAction(cc.sequence(cc.moveTo(.5,this._diamondEndPos),cc.destroySelf()))},SetReelsBg:function(e){},ShowReelsEmpty:function(){for(var e=0;e<this._reels.length;e++)for(var t=this._reels[e],n=0;n<t._symbols.length;n++)t._symbols[n].ShowById(13)},ShowRespinReels:function(e){this.Backup(),cc.find("collect",this.node).active=!1,cc.find("Canvas/safe_node/bg_respin").active=!0,this.SetReelsBg("theme140_reel06"),this._topAniNode.destroyAllChildren(),e||(e=this._gameInfo.bonusData),this._respin.ShowSpin(e),this._is_respin=!0,cc.vv.gameData.setRespin(!0)},ShowNormalReels:function(){cc.find("collect",this.node).active=!0,cc.find("Canvas/safe_node/bg_respin").active=!1,this.SetReelsBg("theme140_reel6"),this.Resume(),this._is_respin=!1,cc.vv.gameData.setRespin(!1)},ShowCollectDiamond:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var n,o,i,a,r,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._is_respin){t.next=2;break}return t.abrupt("return");case 2:if(e._gameInfo.collect){t.next=4;break}return t.abrupt("return");case 4:if(!cc.vv.gameData.isLocked()){t.next=6;break}return t.abrupt("return");case 6:for(n=!1,o=0;o<e._reels.length;o++)for(i=e._reels[o],a=0;a<i._symbols.length;a++)(r=i._symbols[a]).GetData()&&(e.ShowDiamondFly(r.node.convertToWorldSpaceAR(cc.v2(0,0))),n=!0);if(!n){t.next=18;break}return Global.SlotsSoundMgr.playEffect("base/fly"),t.next=12,e.Sleep(.5);case 12:return cc.find("collect/icon/spine",e.node).getComponent(sp.Skeleton).setAnimation(0,"animation",!1),t.next=16,e.Sleep(.2);case 16:s=e._gameInfo.collect,Global.TheUnicorn.Collect.setProgress(s.num/s.total,!0);case 18:case"end":return t.stop()}},t)}))()},StartSuperFree:function(){var e=10;cc.vv.gameData.getCollectData().extra.indexOf(1)>=0&&(e=15),cc.vv.gameData.SetFreeTime(e),cc.vv.gameData.SetTotalFree(e),Global.TheUnicorn.Pop.showSuperFreeStart(e),this._is_super_free=!0},AfterSpinEnd:function(){var e=this;return i(regeneratorRuntime.mark(function t(){var n,o,i,a,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.UpdateCollectMap(!0),t.next=3,e.ShowCollectDiamond();case 3:return e._gameInfo.scatterZJLuXian=null,e.ShowWinTrace(),n=cc.vv.gameData.GetGameWin(),o=n,cc.vv.gameData.GetTotalFree()>0&&cc.vv.gameData.GetTotalFree()!=cc.vv.gameData.GetFreeTime()&&(o=cc.vv.gameData.GetGameTotalFreeWin()),t.next=10,new Promise(function(t){e.ShowBottomWin(n,o,!0,t)});case 10:if(i=e._gameInfo.bonusData,!e._is_respin||!i||null==i.cards){t.next=14;break}return t.next=14,e._respin.UpdateSpin(i);case 14:if(a=!0,!cc.vv.gameData.isFirstTriggerFree()){t.next=24;break}return e.playSymbolAnimation(2,"win"),e._wilds=[],a=!1,e._bottomScript.ShowBtnsByState("moveing_1"),t.next=22,e.Sleep(.8);case 22:Global.TheUnicorn.Pop.showFreeStart(cc.vv.gameData.GetFreeTime()),e.Backup();case 24:if(cc.vv.gameData.isLastEndFree()&&(e._wilds=[],e._wild_move.Clear(),a=!1,e._bottomScript.ShowBtnsByState("moveing_1"),e._is_super_free?Global.TheUnicorn.Pop.showSuperFreeEnd(cc.vv.gameData.GetGameTotalFreeWin()):Global.TheUnicorn.Pop.showFreeEnd(cc.vv.gameData.GetGameTotalFreeWin()),e._is_super_free=!1),!e._gameInfo.select||1!=e._gameInfo.select.state){t.next=39;break}if(a=!1,r=e._gameInfo.select,e._bottomScript.ShowBtnsByState("moveing_1"),3!=r.rtype){t.next=38;break}return e.playSymbolAnimation(3,"trigger"),cc.vv.gameData.sendGameData({rtype:3}),t.next=34,e.Sleep(.8);case 34:return t.next=36,Global.TheUnicorn.Pop.showRespinStart();case 36:t.next=39;break;case 38:4==r.rtype?(e._respin.ShowPick(i),cc.vv.gameData.SetRespinTime(0)):1==r.rtype?(Global.SlotsSoundMgr.playEffect("map/full"),Global.TheUnicorn.Pop.showWheelStart(e._gameInfo.collect.turn)):2==r.rtype&&(Global.SlotsSoundMgr.playEffect("map/full"),e.StartSuperFree());case 39:a&&(e.CanDoNextRound(),e._is_respin&&e._bottomScript.ShowBtnsByState("moveing_1"));case 40:case"end":return t.stop()}},t)}))()},OnWildMoveEnd:function(){this.SetStopTime(1.5)},UpdateFreeCnt:function(){var e=cc.vv.gameData.GetTotalFree();if(e>0){var t=cc.vv.gameData.GetFreeTime();this._lbl_free_cnt||(this._lbl_free_cnt=cc.find("Canvas/safe_node/free/lbl_free_cnt").getComponent(cc.Label)),this._lbl_free_cnt.string=""+(e-t),this._lbl_total_cnt||(this._lbl_total_cnt=cc.find("Canvas/safe_node/free/lbl_total_cnt").getComponent(cc.Label)),this._lbl_total_cnt.string=""+e}},UpdateCollectMap:function(e){cc.find("collect/ball/map",this.node).getComponent(cc.Button).interactable=e},StartMove:function(){Global.SlotsSoundMgr.playNormalBgm(),cc.vv.gameData.GetTotalFree()>0&&this._wilds.length>0&&this._wild_move.StartMove(this._wilds,this.OnWildMoveEnd.bind(this)),this.UpdateFreeCnt(),this.UpdateCollectMap(!1),this._is_respin&&this._respin.OnStartSpin(),this._super()},onMsgSpine:function(e){this._super(e),this._gameInfo.collect&&cc.vv.gameData.setCollectData(this._gameInfo.collect),this._gameInfo.freeWildIndexs&&this._wild_move.IsMoving()&&(this._wild_move.SetResult(this._gameInfo.freeWildIndexs.move),this.SetStopTime(20))},OnSpinEnd:function(){this._wild_move.SetVisiable(!1),this.AfterSpinEnd()},ShowGameview:function(e){if(e){Global.SlotsSoundMgr.playBgm("free/free_bgm");var t=cc.vv.gameData.GetTotalFree(),n=cc.vv.gameData.GetFreeTime();this._bottomScript.ShowFreeModel(!0,t-n,t),this.UpdateFreeCnt();var o=cc.vv.gameData.GetTotalFreeWin();this._bottomScript.SetWin(o),this.CanDoNextRound()}else this._bottomScript.ShowFreeModel(!1);cc.find("Canvas/safe_node/bg_base").active=!e,cc.find("Canvas/safe_node/bg_free").active=e,cc.find("Canvas/safe_node/layout/jackpot").active=!e,cc.find("Canvas/safe_node/free").active=e,cc.find("role",this.node).active=!e,cc.find("collect",this.node).active=!e,cc.find("logo",this.node).active=!e},playSymbolAnimation:function(e,t){for(var n=0;n<this._reels.length;n++)for(var o=this._reels[n],i=0;i<this._row;i++){var a=o._symbols[i];a&&a.GetShowId()==e&&("win"==t?a.playWinAnimation():"trigger"==t&&a.playTriggerAnimation())}Global.SlotsSoundMgr.playEffect("base/bell")},ReconnectShow:function(){cc.vv.gameData.GetFreeTime()?this.ShowGameview(!0):this.ShowGameview(!1);var e=cc.vv.gameData.getDeskInfo(),t=e.select;t&&1==t.state&&(3==t.rtype?(this._bottomScript.ShowBtnsByState("moveing_1"),cc.vv.gameData.sendGameData({rtype:3})):1==t.rtype?(this._bottomScript.ShowBtnsByState("moveing_1"),Global.TheUnicorn.Wheel.showSpin(e.collect.turn)):2==t.rtype&&this.StartSuperFree());var n=e.bonusData;n&&n.spin&&n.spin>0&&(this.ShowRespinReels(n),cc.vv.gameData.SetRespinTime(n.spin),cc.vv.gameData.setRespin(!0)),n&&n.pick&&n.pick>0&&(this._bottomScript.ShowBtnsByState("moveing_1"),this.ShowRespinReels(n),this._respin.ShowPick(n),cc.vv.gameData.SetRespinTime(0));var o=cc.vv.gameData.getCollectData();o.col&&o.row&&this.ResizeReels(o.col,o.row)},DoCheckReelAnti:function(e){this._is_respin||this._super(e)}}),cc._RF.pop()},{LMSlots_Slots_Base:void 0}],TheUnicorn_Symbol:[function(e,t,n){"use strict";cc._RF.push(t,"bfa06jVQJhEfrvKEFAvloSo","TheUnicorn_Symbol"),cc.Class({extends:e("LMSlots_Symbol_Base"),ShowRandomSymbol:function(){var e=cc.vv.gameData.getRandomSymbol();this.ShowById(e)}}),cc._RF.pop()},{LMSlots_Symbol_Base:void 0}],TheUnicorn_Wheel:[function(e,t,n){"use strict";cc._RF.push(t,"72574zg4XxH/qmNT9nZiK95","TheUnicorn_Wheel"),cc.Class({extends:cc.Component,properties:{_wheel_node:null,_wheel_wheel:null,_btn_spin:null,_data:null},onLoad:function(){this._wheel_node=cc.find("safe_node/wheel",this.node),this._wheel_wheel=cc.find("layout/wheel",this._wheel_node),this._btn_spin=cc.find("layout/btn_spin",this._wheel_node),this._btn_spin.on("click",this.onClickSpin.bind(this)),cc.vv.NetManager.registerMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,this)},start:function(){},onDestroy:function(){cc.vv.NetManager.unregisterMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,!1,this)},formatNumber:function(e){return e<1e7?Global.FormatNumToComma(Math.floor(e/1e3))+"K":Global.FormatNumToComma(Math.floor(e/1e6))+"M"},showSpin:function(e){var t=this;this._btn_spin.getComponent(cc.Button).interactable=!0,this._btn_spin.getChildByName("zp_01").active=!0,this._wheel_wheel.angle=0,this._wheel_node.active=!0;var n=this._wheel_node.getChildByName("layout");cc.find("result",n).active=!1,Global.showAlertAction(n,!0,.1,1,null),Global.SlotsSoundMgr.playEffect("map/wheel_in");for(var o=cc.vv.gameData.GetAtlasByName("wheel"),i=0;i<e.length;i++){var a=e[i];this._wheel_wheel.getChildByName("lbl_coin"+(i+1)).getComponent(cc.Label).string=this.formatNumber(a.num),0==i&&(this._wheel_wheel.getChildByName("booster").getComponent(cc.Sprite).spriteFrame=o.getSpriteFrame("theme140_wheel_booster"+a.extra))}Global.SlotsSoundMgr.playBgm("map/wheel_bgm"),cc.vv.gameData.checkAutoPlay(this._btn_spin,function(){Global.SlotsSoundMgr.playEffect("base/common_click"),t._btn_spin.getComponent(cc.Button).interactable=!1,t._btn_spin.getChildByName("zp_01").active=!1,cc.vv.gameData.sendGameData({rtype:1})})},hide:function(){var e=this,t=this._wheel_node.getChildByName("layout");Global.showAlertAction(t,!0,.1,1,function(){e._wheel_node.active=!1,Global.SlotsSoundMgr.playNormalBgm(!0)}),Global.SlotsSoundMgr.playEffect("map/wheel_out")},onClickSpin:function(e){Global.SlotsSoundMgr.playEffect("base/common_click"),this._btn_spin.getComponent(cc.Button).interactable=!1,this._btn_spin.stopAllActions(),this._btn_spin.getChildByName("zp_01").active=!1,cc.vv.gameData.sendGameData({rtype:1})},StartSpin:function(e){var t=this,n=2880+90*(4-(e.idx-1)),o=this._btn_spin.getChildByName("zp_03");o.active=!0,o.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),this._wheel_wheel.runAction(cc.sequence(cc.delayTime(1.25),cc.callFunc(function(){Global.SlotsSoundMgr.playEffect("map/wheel_spin")}),cc.rotateTo(6,n).easing(cc.easeQuadraticActionInOut()),cc.callFunc(function(){cc.find("layout/result",t._wheel_node).active=!0,Global.SlotsSoundMgr.playEffect("map/wheel_end")}),cc.delayTime(2.5),cc.callFunc(function(){Global.TheUnicorn.Pop.showWheelEnd(e.result)})))},OnRecvMsgSubAction:function(e){if(200==e.code&&1==e.data.rtype){var t=e.data.data;this.StartSpin(t),t.result.extra&&cc.vv.gameData.addCollectBooster(t.result.extra)}}}),cc._RF.pop()},{}],TheUnicorn_WildMove:[function(e,t,n){"use strict";function o(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=i(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,r=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return r=e.done,e},e:function(e){s=!0,a=e},f:function(){try{r||null==o.return||o.return()}finally{if(s)throw a}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}cc._RF.push(t,"02c5ew2xiZGlKUQE0k54FLQ","TheUnicorn_WildMove"),cc.Class({extends:cc.Component,properties:{_layout:null,_wildx1:null,_wildx2:null,_wilds:[],_result:null,_callback:null},onLoad:function(){this._layout=this.node.getChildByName("layout"),this._wildx1=this.node.getChildByName("wildx1"),this._wildx2=this.node.getChildByName("wildx2"),this._moving=!1,this._sw=130,this._sh=112,this._col=5,this._row=3,this.SetVisiable(!1)},SetSymbolSize:function(e,t){this._sw=e,this._sh=t},SetCol:function(e){this._col=e},SetRow:function(e){this._row=e},SetVisiable:function(e){var t=0;e&&(t=255),this.node.opacity=t},IsMoving:function(){return this._moving},SetWilds:function(e,t){for(var n=0;n<e.length;n++){if(!this._wilds[n]){var o=null;(o=t?cc.instantiate(this._wildx2):cc.instantiate(this._wildx1)).parent=this._layout,o.active=!0,this._wilds[n]=o}this._wilds[n].position=this.GetPos(e[n]),this._wilds[n].zIndex=e[n]}},GetPos:function(e){var t=Math.floor((e-1)/this._col),n=Math.floor((e-1)%this._col),o=4*n;return cc.v2(n*this._sw+this._sw/2+o,(this._row-1-t)*this._sh+this._sh/2)},StartMove:function(e,t,n){Global.SlotsSoundMgr.playEffect("free/free_wild_land"),this._moving=!0,this.SetVisiable(!0),this._result=null,this._callback=t,this.SetWilds(e,n),this._movecnt=0;var i,a=o(this._wilds);try{for(a.s();!(i=a.n()).done;){var r=i.value.getComponent(sp.Skeleton);r.setAnimation(0,"animation2",!1),r.addAnimation(0,"animation3",!0)}}catch(e){a.e(e)}finally{a.f()}this.MoveRandom()},MoveRandom:function(){var e,t=o(this._wilds);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stopAllActions();var i=this.GetPos(Global.random(1,this._col*this._row));n.runAction(cc.moveTo(1.5,i))}}catch(e){t.e(e)}finally{t.f()}this.node.runAction(cc.sequence(cc.delayTime(1.55),cc.callFunc(this.OnMoveRoundEnd.bind(this)))),Global.SlotsSoundMgr.playEffect("free/free_wild_run")},MoveToTarget:function(){for(var e=0;e<this._result.length;e++){var t=this._wilds[e];if(t){t.stopAllActions();var n=this.GetPos(this._result[e]);t.runAction(cc.sequence(cc.moveTo(1.5,n),cc.callFunc(function(e){e.getComponent(sp.Skeleton).setAnimation(0,"animation4",!1),Global.SlotsSoundMgr.stopEffectByName("free_wild_run")})))}}this.node.runAction(cc.sequence(cc.delayTime(1.55),cc.callFunc(this.OnMoveEnd.bind(this)))),Global.SlotsSoundMgr.playEffect("free/free_wild_run")},SetResult:function(e){this._result=e},Clear:function(){this._layout.destroyAllChildren(),this._wilds.length=0},OnMoveRoundEnd:function(){this._movecnt+=1,this._movecnt>=2&&this._result?this.MoveToTarget():this.MoveRandom()},OnMoveEnd:function(){this._moving=!1,this._callback&&this._callback()}}),cc._RF.pop()},{}]},{},["TheUnicorn_Cfg","TheUnicorn_Collect","TheUnicorn_GameData","TheUnicorn_Logic","TheUnicorn_Pop","TheUnicorn_PrizePool","TheUnicorn_PrizePool_jp","TheUnicorn_Reel","TheUnicorn_Respin","TheUnicorn_Slots","TheUnicorn_Symbol","TheUnicorn_Wheel","TheUnicorn_WildMove"]);