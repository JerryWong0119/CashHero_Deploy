window.__require=function e(t,n,o){function i(c,r){if(!n[c]){if(!t[c]){var s=c.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!r&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var h=n[c]={exports:{}};t[c][0].call(h.exports,function(e){return i(t[c][1][e]||e)},h,h.exports,e,t,n,o)}return n[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({TheLegendOfDragon_Cfg:[function(e,t,n){"use strict";var o;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"8f0d7/xTLBA6oR1bEnITiMr","TheLegendOfDragon_Cfg");var a={symbol:(o={},i(o,1,{node:"s1",win_node:"w1",win_ani:{name:"animation",zIndex:100}}),i(o,2,{node:"s2",win_node:"w2",win_ani:{name:"animation",zIndex:100}}),i(o,3,{node:"s3",win_node:"w3",win_ani:{name:"animation",zIndex:100}}),i(o,4,{node:"s4",win_node:"w4",win_ani:{name:"animation",zIndex:100}}),i(o,5,{node:"s5",win_node:"w5",win_ani:{name:"animation",zIndex:100}}),i(o,6,{node:"s6",win_node:"w6",win_ani:{name:"animation",zIndex:100}}),i(o,7,{node:"s7"}),i(o,8,{node:"s8"}),i(o,9,{node:"s9"}),i(o,10,{node:"s10"}),i(o,11,{node:"s11",win_node:"w11",win_ani:{name:"animation",zIndex:200},stop_ani:{name:"animation",zIndex:200},trigger_ani:{name:"animation1",zIndex:300}}),i(o,12,{node:"s12",win_node:"w12",win_ani:{name:"animation",zIndex:200}}),i(o,13,{node:"s13",win_node:"w13",win_ani:{name:"animation",zIndex:200}}),i(o,14,{node:"s14",win_node:"w14",win_ani:{name:"animation",zIndex:200}}),o),scripts:{Top:"LMSlots_Top_Base",Bottom:"LMSlots_Bottom_Base",Slots:"TheLegendOfDragon_Slots",Reels:"LMSlots_Reel_Base",Symbols:"TheLegendOfDragon_Symbol"},col:5,row:4,symbolPrefab:"TheLegendOfDragon_Symbol",symbolSize:{width:126,height:100},randomSymbols:[1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10],kuang:"TheLegendOfDragon_Kuang",speed:3e3,reelStopInter:.2,auto_stop_time:1,normalBgm:"base/base_bgm",helpItems:["games/TheLegendOfDragon/prefab/help/HelpPage1","games/TheLegendOfDragon/prefab/help/HelpPage2","games/TheLegendOfDragon/prefab/help/HelpPage3","games/TheLegendOfDragon/prefab/help/HelpPage4","games/TheLegendOfDragon/prefab/help/HelpPage5","games/TheLegendOfDragon/prefab/help/HelpPage6","games/TheLegendOfDragon/prefab/help/HelpPage7","games/TheLegendOfDragon/prefab/help/HelpPage8"],commEffect:{path:"games/TheLegendOfDragon/",win1:["win1","win1end"],win2:["win2","win2end"]},autoModelDelay:.8,bounce:!0,bounceInfo:{distance:30,time:.1},AddAntiTime:1.5,reelStateInfo:[{id:[11],mini:3,counts:[1,0,1,0,1],antiNode:"node_anti",path:"games/TheLegendOfDragon/",reelStopSound:"reel_stop",symbolStopSound:"symbol_scatter",antSound:"reel_notify",antSpeed:2e3}]};t.exports=a,cc._RF.pop()},{}],TheLegendOfDragon_Collect:[function(e,t,n){"use strict";function o(e,t,n,o,i,a,c){try{var r=e[a](c),s=r.value}catch(e){return void n(e)}r.done?t(s):Promise.resolve(s).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var c=e.apply(t,n);function r(e){o(c,i,a,r,s,"next",e)}function s(e){o(c,i,a,r,s,"throw",e)}r(void 0)})}}cc._RF.push(t,"37933LZV0RJN6oLoGOE6Kwo","TheLegendOfDragon_Collect"),cc.Class({extends:cc.Component,properties:{_roles:[],_boxes:[],_lblNum:null,_lblNum2:null,_store:null,_progress:null,_reduce:null,_prize_x2:null,_lack_ingot_tip:null,_islock:!1,_idx:1,_processing:!1,_reopen:!1},onLoad:function(){this._idx=cc.vv.gameData.getDragonIdx(),this.showRole(this._idx),this._progress=cc.find("safe_node/slots/collect_progress",this.node),this._progress.on("click",this.onClickShowStore.bind(this)),this._store=cc.find("safe_node/collect_game",this.node),this._lblNum=cc.find("bg/lbl_num",this._progress).getComponent(cc.Label),this._lblNum2=cc.find("layout/money_bg/lbl_money",this._store).getComponent(cc.Label),this.refreshIngotNum(),cc.vv.NetManager.registerMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,this),Global.registerEvent(cc.vv.gameData._EventId.SLOT_TOTALBET_UPDATED,this.onEventTotalbetUpdated,this)},onDestroy:function(){cc.vv.NetManager.unregisterMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,!1,this)},start:function(){this.initStore(),this.onEventTotalbetUpdated()},refreshIngotNum:function(){var e=cc.vv.gameData.getIngot();this._lblNum.string=Global.FormatNumToComma(e),this._lblNum2.string=Global.FormatNumToComma(e)},_isCdOk:function(e,t){t=t||500;var n=(new Date).getTime();if(!e.time||n-e.time>=t){var o=e.getComponent(cc.Button);return o&&(o.interactable=!1,o.scheduleOnce(function(){o.interactable=!0},t/1e3)),e.time=n,!0}return!1},initStore:function(){var e=this;cc.find("layout/btn_close",this._store).on("click",this.onBtnClose.bind(this));var t=cc.find("layout/btn_left",this._store);t.on("click",function(){e._isCdOk(t)&&e.onBtnLeft()});var n=cc.find("layout/btn_right",this._store);n.on("click",function(){e._isCdOk(n)&&e.onBtnRight()});for(var o=1;o<=9;o++){var i=cc.find("layout/box_bg/item"+o,this._store);i.on("click",this.onBtnBox.bind(this)),this._boxes[o]={node:i,icon:i.getChildByName("icon"),spine:i.getChildByName("spine"),moneybg:i.getChildByName("money_bg"),lblcoin:cc.find("lbl_wincoin",i).getComponent(cc.Label),lblprice:cc.find("money_bg/lbl_money",i).getComponent(cc.Label)}}this.refreshData()},onEventTotalbetUpdated:function(){var e=cc.vv.gameData.GetBetIdx()<cc.vv.gameData.getUnlockIdx();e!=this._islock&&(this._islock=e,e?(this._progress.getChildByName("lock").getComponent(sp.Skeleton).setAnimation(0,"animation1",!1),Global.TheLegendOfDragon.playEffect("base/lock")):(this._progress.getChildByName("lock").getComponent(sp.Skeleton).setAnimation(0,"animation2",!1),Global.TheLegendOfDragon.playEffect("base/unlock")))},onDropItem:function(e,t){cc.vv.gameData.addItem(t,e);var n=cc.vv.gameData.GetAtlasByName("coins_store"),o=cc.vv.gameData.GetAtlasByName("base");if(t==this._idx){var i=cc.find("layout/material_bg/item_"+e,this._store);if(i){var a=i.getChildByName("material");a.active=!0,a.getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("theme177_collect_material"+t+"_"+e),i.getChildByName("text").active=!0}}var c=cc.find("safe_node/slots/collect_prompt",this.node);c.getComponent(cc.Sprite).spriteFrame=o.getSpriteFrame("theme177_collect_prompt_"+e),c.getChildByName("material").getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("theme177_collect_material"+t+"_"+e),c.scale=.1,c.position=cc.v2(0,0),c.active=!0,cc.tween(c).to(.4,{scale:1},{easing:"backInOut"}).delay(.8).to(.05,{scale:1.05}).to(.35,{scale:0,position:cc.v2(-220,280)}).start()},hide:function(){1==this._store.active&&(this._store.active=!1,cc.vv.gameData.GetBottomScript().ShowInputMask(!1))},onClickShowStore:function(){cc.vv.gameData.GetBottomScript().GetSpinBtnState()&&(cc.vv.gameData.GetAutoModelTime()>0||cc.vv.gameData.GetFreeTime()>0||this.showStore())},showStore:function(){if(this._islock){var e=cc.vv.gameData.getUnlockIdx();cc.vv.gameData.GetBottomScript().SetBetIdx(e)}else{this._store.active=!0,this._processing=!1,this._reopen=!1,this.refreshData();var t=this._store.getChildByName("layout");t.stopAllActions(),t.scale=.5,t.runAction(cc.scaleTo(.25,1)),Global.TheLegendOfDragon.playEffect("shop/shop_show"),cc.vv.gameData.GetBottomScript().ShowInputMask(!0),cc.vv.gameData.GetBottomScript().ShowBtnsByState("moveing_1")}},onBtnClose:function(){if(Global.TheLegendOfDragon.playEffect("shop/shop_close"),!this._processing){cc.vv.gameData.setDragonIdx(this._idx),this.showRole(this._idx);var e={c:MsgId.SLOT_SUBGAME_DATA,gameid:cc.vv.gameData.getGameId()};e.data={rtype:3,didx:this._idx},cc.vv.NetManager.send(e,!0),this.hide(),Global.TheLegendOfDragon.Slots.CanDoNextRound()}},showRole:function(e){for(var t=1;t<=6;t++){cc.find("safe_node/roles/role"+t,this.node).active=t==e}},setBoxAnim:function(e,t){if("null"==t)e.spine.active=!1;else{e.spine.active=!0;var n=e.spine.getComponent(sp.Skeleton);"unopen"==t?n.setAnimation(0,"animation1",!0):"opening"==t?n.setAnimation(0,"animation",!1):"locked"==t?n.setAnimation(0,"animation2",!1):"locking"==t?n.setAnimation(0,"animation1_1",!1):"unlocking"==t&&(n.setAnimation(0,"animation2_1",!1),n.addAnimation(0,"animation1",!0))}},showBoxInfo:function(e,t){e.icon.active=!0,e.moneybg.active=!1;var n=cc.vv.gameData.GetAtlasByName("coins_store");1==t.tp?(e.lblcoin.string=Global.convertNumToShort(t.coin,1e3,0),e.icon.getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("theme177_collect_bg3")):2==t.tp?(e.lblcoin.string="",e.icon.getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("theme177_collect_logo1")):3==t.tp&&(e.lblcoin.string="",e.icon.getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("theme177_collect_logo2"))},refreshData:function(){var e=cc.vv.gameData,t=cc.vv.gameData.getDragon(this._idx),n=cc.vv.gameData.GetAtlasByName("coins_store");cc.find("layout/title_bg/title",this._store).getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("theme177_collect_name"+this._idx);for(var o=1;o<=5;o++){var i=cc.find("layout/material_bg/item_"+o,this._store),a=e.hasItem(this._idx,o),c=i.getChildByName("material");c.active=a,a&&(c.getComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("theme177_collect_material"+this._idx+"_"+o)),i.color=a?cc.Color.WHITE:cc.color(96,96,96,255),i.getChildByName("text").color=a?cc.Color.WHITE:cc.color(96,96,96,255)}var r=cc.find("layout/level_bg",this._store);r.getChildByName("lbl_lv").getComponent(cc.Label).string=""+t.lv;for(var s=1;s<=5;s++)r.getChildByName("lv"+s).active=s<=t.lv;for(var l=cc.find("layout/character_bg",this._store),h=1;h<=6;h++){var d=l.getChildByName("spine"+h);d.active=h==this._idx,h==this._idx&&(cc.log("dragon",t,t.lock),d.color=0==t.lock?cc.Color.WHITE:cc.Color.GRAY,l.getChildByName("lock").active=0!=t.lock)}for(var f=1;f<=6;f++)cc.find("layout/choose_bg/choose"+f+"/choosed",this._store).active=f==this._idx;for(var g=1;g<=9;g++){var _=e.getChest(this._idx,g),p=this._boxes[g];if(0==_.tp){p.icon.active=!1,p.moneybg.active=!0,p.lblcoin.string="",p.lblprice.string=Global.FormatNumToComma(_.price);var u=_.price;e.hasItem(this._idx,5)&&(u-=200),e.getIngot()>=u&&!e.isChestLocked(this._idx,g)?this.setBoxAnim(p,"unopen"):this.setBoxAnim(p,"locked")}else this.showBoxInfo(p,_),this.setBoxAnim(p,"null")}var m=cc.find("layout/lock_lv2",this._store);m.active=t.lv<2,t.lv<2&&m.getComponent(sp.Skeleton).setAnimation(0,"animation1",!1);var v=cc.find("layout/lock_lv4",this._store);v.active=t.lv<4,t.lv<4&&v.getComponent(sp.Skeleton).setAnimation(0,"animation2",!1),this.refreshIngotNum()},doExchangeAction:function(e,t){e.stopAllActions(),e.x=0,e.runAction(cc.sequence(cc.spawn(cc.fadeTo(.15,63),cc.moveBy(.15,t,0)),cc.spawn(cc.fadeTo(.15,255),cc.moveBy(.15,-t,0))))},refreshDataWithAction:function(e){var t=this;this.scheduleOnce(function(){t.refreshData()},.15),this.doExchangeAction(cc.find("layout/title_bg",this._store),e),this.doExchangeAction(cc.find("layout/character_bg",this._store),e),this.doExchangeAction(cc.find("layout/box_bg",this._store),e)},onBtnLeft:function(){Global.TheLegendOfDragon.playEffect("shop/shop_click"),this._processing||(this._idx=this._idx-1,this._idx<1&&(this._idx=6),this.refreshDataWithAction(-20))},onBtnRight:function(){Global.TheLegendOfDragon.playEffect("shop/shop_click"),this._processing||(this._idx=this._idx+1,this._idx>6&&(this._idx=1),this.refreshDataWithAction(20))},showLackIngot:function(e){this._lack_ingot_tip||(this._lack_ingot_tip=cc.find("layout/lack_ingot_tip",this._store)),this._lack_ingot_tip.active=!0,this._lack_ingot_tip.stopAllActions();var t=e.convertToWorldSpaceAR(cc.v2(0,60));this._lack_ingot_tip.position=this._lack_ingot_tip.parent.convertToNodeSpaceAR(t),this._lack_ingot_tip.scale=0,this._lack_ingot_tip.runAction(cc.sequence(cc.scaleTo(.5,1),cc.delayTime(2),cc.scaleTo(.5,0)))},onBtnBox:function(e){if(!this._processing)for(var t=1;t<=9;t++)if(e.node==this._boxes[t].node){cc.log("buy box",this._idx,t);var n=cc.vv.gameData;if(0!=n.getDragon(this._idx).lock)return;if(n.isChestLocked(this._idx,t))return;var o=n.getChest(this._idx,t);if(0!=o.tp)return;var i=o.price;if(n.hasItem(this._idx,5)&&(i-=200),n.getIngot()<i)return void this.showLackIngot(e.node);var a={c:MsgId.SLOT_SUBGAME_DATA,gameid:cc.vv.gameData.getGameId()};a.data={rtype:2,didx:this._idx,cidx:t},cc.vv.NetManager.send(a),this._processing=!0;break}},Sleep:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,o){t.scheduleOnce(function(){n()},e)}));case 1:case"end":return n.stop()}},n)}))()},showOpenBox:function(e,t,n,o){var a=this;return i(regeneratorRuntime.mark(function i(){var c,r,s,l,h;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(c=a._boxes[e],!n){i.next=12;break}return a._reduce||(a._reduce=cc.find("layout/reduce",a._store)),a._reduce.active=!0,r=c.node.convertToWorldSpaceAR(cc.v2(0,-40)),a._reduce.position=a._reduce.parent.convertToNodeSpaceAR(r),a._reduce.active=!0,a._reduce.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),i.next=10,a.Sleep(.5);case 10:s=c.lblprice.string,c.lblprice.string=Global.FormatNumToComma(parseInt(s)-200);case 12:return a.setBoxAnim(c,"opening"),Global.TheLegendOfDragon.playEffect("shop/open"),i.next=16,a.Sleep(.5);case 16:if(!o){i.next=29;break}return l=t.coin,t.coin=Math.floor(l/2),a.showBoxInfo(c,t),i.next=22,a.Sleep(1);case 22:a._prize_x2||(a._prize_x2=cc.find("layout/prize_x2",a._store)),a._prize_x2.active=!0,h=c.node.convertToWorldSpaceAR(cc.v2(0,0)),a._prize_x2.position=a._prize_x2.parent.convertToNodeSpaceAR(h),a._prize_x2.active=!0,a._prize_x2.getComponent(sp.Skeleton).setAnimation(0,"animation1",!1),t.coin=l;case 29:return i.next=31,a.Sleep(.5);case 31:a.showBoxInfo(c,t);case 32:case"end":return i.stop()}},i)}))()},onMsgBuyBox:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){var o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(0==e.spcode){n.next=3;break}return t._processing=!1,n.abrupt("return");case 3:return(o=cc.vv.gameData).setDragonLv(e.didx,e.lv),e.unlock_didx>0&&o.unlockDragon(e.unlock_didx),o.updateChest(e.didx,e.cidx,e.chest.tp,e.chest.coin),o.setIngot(e.num),e.reset&&(o.resetChests(e.didx,e.chests),o.resetItems(e.didx,e.items)),n.next=11,t.showOpenBox(e.cidx,e.chest,e.dec_ingot,e.prize_x2);case 11:return n.next=13,t.Sleep(1);case 13:e.reset&&Global.TheLegendOfDragon.playEffect("shop/level_up"),t.refreshData(),1==e.chest.tp?(cc.vv.gameData.GetBottomScript().SetWin(e.chest.coin),cc.vv.gameData.AddCoin(e.chest.coin),cc.vv.gameData.GetTopScript().ShowCoin()):2==e.chest.tp?(t._reopen=!0,i=e.free.cnt,cc.vv.gameData.SetFreeTime(i),cc.vv.gameData.SetTotalFree(i),Global.TheLegendOfDragon.Pop.showFreeStart(i,!0,e.free.inc_wild)):3==e.chest.tp&&(t._reopen=!0,Global.TheLegendOfDragon.Pop.showPickStart(e.pick)),t._processing=!1;case 17:case"end":return n.stop()}},n)}))()},OnRecvMsgSubAction:function(e){200==e.code&&(2==e.data.rtype?this.onMsgBuyBox(e.data):3==e.data.rtype&&cc.log("choose dragon",e.data.didx))}}),cc._RF.pop()},{}],TheLegendOfDragon_GameData:[function(e,t,n){"use strict";cc._RF.push(t,"38fbf7GzbVE3IWTOBpRH5xS","TheLegendOfDragon_GameData"),cc.Class({extends:e("LMSlots_GameData_Base"),properties:{_collect:null},init:function(e,t,n){this._super(e,t,n),this._collect=this._deskInfo.collect},isFirstTriggerFree:function(){return this.GetFreeTime()>0&&this.GetFreeTime()==this.GetTotalFree()},isLastEndFree:function(){return 0==this.GetFreeTime()&&this.GetTotalFree()>0},getFreeWinCoin:function(){return this._gameInfo.freeWinCoin},getPickState:function(){return this._gameInfo.pick?this._gameInfo.pick.state:0},getCollectData:function(){return this._collect},getDragonIdx:function(){return this._collect.didx},getDragon:function(e){return this._collect.dragons[e-1]},setDragonIdx:function(e){this._collect.didx=e},getUnlockIdx:function(){return this._collect.unlockidx},getIngot:function(){return this._collect.num},setIngot:function(e){this._collect.num=e},modifyIngot:function(e){this._collect.num+=e},addItem:function(e,t){this.hasItem(e,t)||this._collect.dragons[e-1].items.push(t)},hasItem:function(e,t){return this._collect.dragons[e-1].items.indexOf(t)>=0},resetItems:function(e,t){this._collect.dragons[e-1].items=t},getChest:function(e,t){return this._collect.dragons[e-1].chests[t-1]},isChestLocked:function(e,t){if(1==this._collect.dragons[e-1].lock)return!0;var n=Math.floor((t-1)/3);return this._collect.dragons[e-1].lv<[0,2,4][n]},updateChest:function(e,t,n,o){var i=this._collect.dragons[e-1].chests[t-1];i.tp=n,i.coin=o},resetChests:function(e,t){this._collect.dragons[e-1].chests=t},getDragonLv:function(e){return this._collect.dragons[e-1].lv},setDragonLv:function(e,t){this._collect.dragons[e-1].lv=t},unlockDragon:function(e){this._collect.dragons[e-1].lock=0}}),cc._RF.pop()},{LMSlots_GameData_Base:void 0}],TheLegendOfDragon_Logic:[function(e,t,n){"use strict";cc._RF.push(t,"611675cgzlG+rDxzh4yud1n","TheLegendOfDragon_Logic"),cc.Class({extends:e("LMSlots_Logic_Base"),properties:{},onLoad:function(){var e={};Global.TheLegendOfDragon=e,e.playEffect=function(e){cc.vv.AudioManager.playEff("games/TheLegendOfDragon/",e,!0)},e.stopEffect=function(e){cc.vv.AudioManager.stopEffectByName(e)},e.Logic=this,e.Pick=this.node.getComponent("TheLegendOfDragon_Pick"),e.Collect=this.node.getComponent("TheLegendOfDragon_Collect"),e.Wheel=this.node.getComponent("TheLegendOfDragon_Wheel"),e.Pop=this.node.getComponent("TheLegendOfDragon_Pop"),this._super(),e.Slots=cc.find("safe_node/slots",this.node).getComponent("TheLegendOfDragon_Slots"),this.StartSlot()},start:function(){},onDestroy:function(){Global.TheLegendOfDragon=null},showTransition:function(e,t){var n=cc.find("safe_node/"+e,this.node);n.active=!0;var o=n.getComponent(sp.Skeleton);o.setAnimation(0,"animation",!1),o.setCompleteListener(function(){t&&t(),n.active=!1})}}),cc._RF.pop()},{LMSlots_Logic_Base:void 0}],TheLegendOfDragon_Pick:[function(e,t,n){"use strict";function o(e,t,n,o,i,a,c){try{var r=e[a](c),s=r.value}catch(e){return void n(e)}r.done?t(s):Promise.resolve(s).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var c=e.apply(t,n);function r(e){o(c,i,a,r,s,"next",e)}function s(e){o(c,i,a,r,s,"throw",e)}r(void 0)})}}cc._RF.push(t,"c2851Zkqx9ENIL7d2HXDCY+","TheLegendOfDragon_Pick"),cc.Class({extends:cc.Component,properties:{_pick:null,_data:null,_boxes:[],_columns:[],_fanpai:null,_fly:null,_processing:!1,_tip:null},onLoad:function(){var e=this;this._pick=cc.find("safe_node/pick_game",this.node);for(var t=cc.find("box_bg",this._pick).children,n=this,o=function(o,i){var a=t[o-1];e._boxes[o]=a,a.on("click",function(){n.onBtnBox(a)})},i=1,a=t.length;i<=a;++i)o(i);for(var c=1;c<=5;c++){var r=cc.find("columns/c"+c,this._pick);this._columns[c]=r}this._fanpai=cc.find("fanpai",this._pick),this._fly=cc.find("fly",this._pick),this._tip=cc.find("tip",this._pick),this._tip.opacity=0,cc.vv.NetManager.registerMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,this)},onDestroy:function(){cc.vv.NetManager.unregisterMsg(MsgId.SLOT_SUBGAME_DATA,this.OnRecvMsgSubAction,!1,this)},start:function(){var e=cc.vv.gameData.getDeskInfo().pick;e&&1==e.state&&this.show(e,1,!0)},Sleep:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,o){t.scheduleOnce(function(){n()},e)}));case 1:case"end":return n.stop()}},n)}))()},show:function(e,t){var n=this;return i(regeneratorRuntime.mark(function o(){var i,a,c,r,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:for(Global.SlotsSoundMgr.playBgm("pick/pick_bgm"),cc.vv.gameData.GetBottomScript().ShowBtnsByState("moveing_1"),n._pick.active=!0,n._processing=!0,n._data=e,i=1;i<=20;i++)n.showBoxInfo(n._boxes[i],0,!1),n._boxes[i].getChildByName("win").active=!1;for(a=1;a<=5;a++)n.showColumnInfo(a,0);return o.next=9,n.Sleep(t||2);case 9:if(!e.remove_mini){o.next=16;break}return Global.TheLegendOfDragon.Pop.showRemoveMini(),o.next=13,n.Sleep(1.2);case 13:cc.find("columns/lock",n._pick).active=!0,o.next=17;break;case 16:cc.find("columns/lock",n._pick).active=!1;case 17:for(c=1;c<=20;c++)r=e.remove_mini&&1==e.cards[c-1],n.showBoxInfo(n._boxes[c],e.cards[c-1],!1,r);for(s=1;s<=5;s++)n.showColumnInfo(s,e.progs[s-1]);return o.next=21,n.Sleep(1);case 21:n.showTip(),n._processing=!1,n.setAutoPlay();case 24:case"end":return o.stop()}},o)}))()},hide:function(){1==this._pick.active&&(this._pick.active=!1)},showTip:function(){this._tip.stopAllActions(),this._tip.opacity=255,this._tip.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,.7),cc.scaleTo(.5,.6))))},showBoxInfo:function(e,t,n,o){var i=cc.vv.gameData.GetAtlasByName("pick"),a=e.getChildByName("icon");a.color=o?cc.Color.GRAY:cc.Color.WHITE;a.getComponent(cc.Sprite).spriteFrame=i.getSpriteFrame(["theme177_pick_frame1","theme177_pick_r_4","theme177_pick_r_3","theme177_pick_r_2","theme177_pick_r_1","theme177_pick_r_0"][t]);var c=e.getChildByName("jackpot");if(c.active=t>0&&!o,t>0){if(o||c.getComponent(sp.Skeleton).setAnimation(0,["","animation4","animation3","animation2","animation1","animation0"][t],!0),n){a.opacity=0,a.runAction(cc.fadeIn(.5));var r=a.convertToWorldSpaceAR(cc.v2(0,0)),s=this._pick.convertToNodeSpaceAR(r),l=cc.instantiate(this._fanpai);l.parent=this._pick,l.position=s,l.active=!0,l.runAction(cc.sequence(cc.delayTime(1),cc.destroySelf()));var h=cc.instantiate(this._fly);h.parent=this._pick,h.position=s,h.opacity=0,h.active=!0,h.runAction(cc.sequence(cc.delayTime(.5),cc.fadeIn(0),cc.callFunc(function(){Global.TheLegendOfDragon.playEffect("pick/card_fly")}),cc.moveTo(.5,cc.v2([280,-280,140,-140,0][t-1],0)),cc.delayTime(.2),cc.destroySelf()))}}},showColumnInfo:function(e,t){var n=this._columns[e],o=n.getChildByName("circle"),i=[0,2,2,3,3,5];o.active=t!=i[e]+1,0==t&&(o.y=0);for(var a=1;a<=i[e];a++){var c=n.getChildByName("circle"+a);if(a<=t){if(c.active=!1,a==t){var r=c.position;o.runAction(cc.moveTo(.5,r))}}else c.active=!0}n.getChildByName("column").getComponent(sp.Skeleton).setAnimation(0,"animation"+t,!1)},showWinCard:function(e){for(var t=1;t<=20;t++)this._data.cards[t-1]==e&&(this._boxes[t].getChildByName("win").active=!0)},showLeftCards:function(e){for(var t=1;t<=20;t++)if(0==this._data.cards[t-1]){var n=e.shift();if(n){this.showBoxInfo(this._boxes[t],n,!1,!0);var o=this._boxes[t].getChildByName("icon");o.scale=.1,o.runAction(cc.scaleTo(.3,1))}}},setAutoPlay:function(){for(var e=[],t=1;t<=20;t++)0==this._data.cards[t-1]&&e.push(t);var n=Global.random(0,e.length-1),o=this;cc.vv.gameData.checkAutoPlay(this._boxes[e[n]],function(){o.onBtnBox(o._boxes[e[n]])})},onBtnBox:function(e){if(!this._processing){this._tip.opacity>0&&(this._tip.stopAllActions(),this._tip.runAction(cc.fadeOut(.2)));for(var t=1;t<=20;t++)if(this._boxes[t].stopAllActions(),e==this._boxes[t]&&0==this._data.cards[t-1]){var n={c:MsgId.SLOT_SUBGAME_DATA,gameid:cc.vv.gameData.getGameId(),data:{rtype:1,idx:t}};cc.vv.NetManager.send(n),this._processing=!0,Global.TheLegendOfDragon.playEffect("pick/card")}}},OnMsgPick:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){var o,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.data.idx,i=e.data.card,t._data.cards[o-1]=i,t._data.progs[i-1]=e.data.prog,t.showBoxInfo(t._boxes[o],i,!0),t.scheduleOnce(function(){t.showColumnInfo(i,e.data.prog)},1),!(e.data.wincoin>0)){n.next=18;break}return n.next=9,t.Sleep(.8);case 9:return t.showWinCard(i),t.showLeftCards(e.data.leftcards),n.next=13,t.Sleep(2);case 13:a=e.data.wincoin,cc.vv.gameData.AddCoin(a),Global.TheLegendOfDragon.Pop.showCollectJp(i,a),n.next=22;break;case 18:return n.next=20,t.Sleep(1.5);case 20:t._processing=!1,t.setAutoPlay();case 22:case"end":return n.stop()}},n)}))()},OnRecvMsgSubAction:function(e){200==e.code&&0==e.data.spcode&&1==e.data.rtype&&this.OnMsgPick(e)}}),cc._RF.pop()},{}],TheLegendOfDragon_Pop:[function(e,t,n){"use strict";function o(e,t,n,o,i,a,c){try{var r=e[a](c),s=r.value}catch(e){return void n(e)}r.done?t(s):Promise.resolve(s).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var c=e.apply(t,n);function r(e){o(c,i,a,r,s,"next",e)}function s(e){o(c,i,a,r,s,"throw",e)}r(void 0)})}}cc._RF.push(t,"52596ctYbBNLoAMhGFFNDB4","TheLegendOfDragon_Pop"),cc.Class({extends:cc.Component,properties:{_pop:null,_pick_start:null,_collect_jp:null,_free:null,_free_start:null,_free_end:null,_jpWin:0,_freeWin:0,_pickData:null,_incWild:!1,_pickStartClicked:!1,_collectJpClicked:!1,_freeStartClicked:!1,_freeEndClicked:!1},onLoad:function(){this._pop=cc.find("safe_node/node_pop_ui",this.node),this._pick_start=this._pop.getChildByName("pick_start"),this._pick_start.getChildByName("btn_start").on("click",this.onClickPickStart.bind(this)),this._collect_jp=this._pop.getChildByName("collect_jp"),this._collect_jp.getChildByName("btn_collect").on("click",this.onClickCollectJp.bind(this)),this._free=this._pop.getChildByName("free"),this._free_start=this._free.getChildByName("start"),this._free_start.getChildByName("btn_start").on("click",this.onClickFreeStart.bind(this)),this._free_end=this._free.getChildByName("end"),this._free_end.getChildByName("btn_collect").on("click",this.onClickFreeEnd.bind(this))},showPickStart:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){var o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t._pickData=e,t._pop.active=!0,t._pick_start.active=!0,Global.showAlertAction(t._pick_start,!0,.1,1,null),t.showNodePopAnimation(t._pick_start.getChildByName("btn_start"),.2),Global.SlotsSoundMgr.stopBgm(),Global.TheLegendOfDragon.playEffect("pick/pick_start_show"),o=t._pick_start.getChildByName("btn_start"),i=function(){if(t._pickStartClicked)return!1;t._pickStartClicked=!0,Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(t._pick_start,!1,1,.1,function(){t._pop.active=!1,t._pick_start.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping1"),Global.TheLegendOfDragon.playEffect("base/transition_bonus"),t._pickStartClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),t.scheduleOnce(function(){Global.TheLegendOfDragon.Pick.show(t._pickData,2)},1.5),Global.TheLegendOfDragon.Collect.hide()},n.next=11,cc.vv.gameData.awaitTime(.7);case 11:cc.vv.gameData.checkAutoPlay(o,i);case 12:case"end":return n.stop()}},n)}))()},onClickPickStart:function(){var e=this;if(this._pickStartClicked)return!1;this._pick_start.getChildByName("btn_start").stopAllActions(),this._pickStartClicked=!0,Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(this._pick_start,!1,1,.1,function(){e._pop.active=!1,e._pick_start.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping1"),Global.TheLegendOfDragon.playEffect("base/transition_bonus"),e._pickStartClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),this.scheduleOnce(function(){Global.TheLegendOfDragon.Pick.show(e._pickData,2)},1.5),Global.TheLegendOfDragon.Collect.hide()},showCollectJp:function(e,t){var n=this,o=5-e;this._jpWin=t,this._pop.active=!0,this._collect_jp.active=!0,this._collect_jp.scale=1,cc.find("coin_bg/lbl_coin",this._collect_jp).getComponent("LabelRollCmp").startRoll(0,t,2);var i=this._collect_jp.getChildByName("spine_bg").getComponent(sp.Skeleton);i.setAnimation(0,"animation"+o,!1),i.addAnimation(0,"animation"+o+"_"+o,!0);Global.TheLegendOfDragon.playEffect("pick/"+["","mini","minor","major","maxi","grand"][e]),Global.SlotsSoundMgr.stopBgm(),Global.TheLegendOfDragon.playEffect("pick/jackpot_show");var a=this._collect_jp.getChildByName("btn_collect");cc.vv.gameData.checkAutoPlay(a,function(){n._collectJpClicked||(n._collectJpClicked=!0,Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(n._collect_jp,!1,1,.1,function(){n._pop.active=!1,n._collect_jp.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping1"),Global.TheLegendOfDragon.playEffect("base/transition_bonus"),n._collectJpClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),n.scheduleOnce(function(){Global.SlotsSoundMgr.playNormalBgm(!0),Global.TheLegendOfDragon.Pick.hide()},1),n.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowBottomWin(n._jpWin,n._jpWin,!0,function(){Global.TheLegendOfDragon.Collect._reopen?Global.TheLegendOfDragon.Collect.showStore():Global.TheLegendOfDragon.Slots.CanDoNextRound()})},2.5))})},onClickCollectJp:function(){var e=this;this._collectJpClicked||(this._collectJpClicked=!0,this._collect_jp.getChildByName("btn_collect").stopAllActions(),Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(this._collect_jp,!1,1,.1,function(){e._pop.active=!1,e._collect_jp.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping1"),Global.TheLegendOfDragon.playEffect("base/transition_bonus"),e._collectJpClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),this.scheduleOnce(function(){Global.SlotsSoundMgr.playNormalBgm(!0),Global.TheLegendOfDragon.Pick.hide()},1),this.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowBottomWin(e._jpWin,e._jpWin,!0,function(){Global.TheLegendOfDragon.Collect._reopen?Global.TheLegendOfDragon.Collect.showStore():Global.TheLegendOfDragon.Slots.CanDoNextRound()})},2.5))},showNodePopAnimation:function(e,t){e.scale=0,e.runAction(cc.sequence(cc.delayTime(t),cc.scaleTo(.3,1.2),cc.scaleTo(.2,1)))},showFreeStart:function(e,t,n){var o=this;return i(regeneratorRuntime.mark(function t(){var i,a,c,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o._incWild=n,o._pop.active=!0,o._free.active=!0,o._free.scale=1,o._free_start.active=!0,(i=o._free_start.getChildByName("lbl_count").getComponent(cc.Label)).string=""+e,(a=o._free.getChildByName("spine_bg").getComponent(sp.Skeleton)).setAnimation(0,"animation1_1",!1),a.addAnimation(0,"animation1_2",!0),o.showNodePopAnimation(o._free_start.getChildByName("lbl_count"),.5),o.showNodePopAnimation(o._free_start.getChildByName("btn_start"),.8),e>8&&(i.string="8",(c=o._free_start.getChildByName("more")).active=!0,c.getComponent(sp.Skeleton).setAnimation(0,"animation",!1),c.getComponent(sp.Skeleton).setCompleteListener(function(){i.string=""+e})),Global.SlotsSoundMgr.stopBgm(),Global.TheLegendOfDragon.playEffect("free/free_dialog_start_show"),t.next=17,cc.vv.gameData.awaitTime(1.3);case 17:r=o._free_start.getChildByName("btn_start"),cc.vv.gameData.checkAutoPlay(r,function(){o._freeStartClicked||(o._freeStartClicked=!0,Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(o._free,!1,1,.1,function(){o._pop.active=!1,o._free.active=!1,o._free_start.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping2"),Global.TheLegendOfDragon.playEffect("base/transition_free"),o._freeStartClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),o.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowGameview(!0)},.8),o.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.CanDoNextRound()},1.8),o._incWild&&o.scheduleOnce(function(){o.showIncWild()},2.4),Global.TheLegendOfDragon.Collect.hide())});case 19:case"end":return t.stop()}},t)}))()},onClickFreeStart:function(){var e=this;this._freeStartClicked||(this._freeStartClicked=!0,this._free_start.getChildByName("btn_start").stopAllActions(),Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(this._free,!1,1,.1,function(){e._pop.active=!1,e._free.active=!1,e._free_start.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping2"),Global.TheLegendOfDragon.playEffect("base/transition_free"),e._freeStartClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),this.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowGameview(!0)},.8),this.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.CanDoNextRound()},1.8),this._incWild&&this.scheduleOnce(function(){e.showIncWild()},2.4),Global.TheLegendOfDragon.Collect.hide())},showFreeEnd:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){var o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t._freeWin=e,t._pop.active=!0,t._free.active=!0,t._free.scale=1,t._free_end.active=!0,cc.find("coin_bg/lbl_coin",t._free_end).getComponent("LabelRollCmp").startRoll(0,e,2),(o=t._free.getChildByName("spine_bg").getComponent(sp.Skeleton)).setAnimation(0,"animation2_1",!1),o.addAnimation(0,"animation2_2",!0),t.showNodePopAnimation(t._free_end.getChildByName("coin_bg"),.5),t.showNodePopAnimation(t._free_end.getChildByName("btn_collect"),.8),Global.SlotsSoundMgr.stopBgm(),Global.TheLegendOfDragon.playEffect("free/free_dialog_collect_show"),i=t._free_end.getChildByName("btn_collect"),n.next=16,cc.vv.gameData.awaitTime(1.3);case 16:cc.vv.gameData.checkAutoPlay(i,function(){t._freeEndClicked||(t._freeEndClicked=!0,Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(t._free,!1,1,.1,function(){t._pop.active=!1,t._free.active=!1,t._free_end.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping2"),Global.TheLegendOfDragon.playEffect("base/transition_free"),t._freeEndClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),t.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowGameview(!1),Global.TheLegendOfDragon.Slots.Resume(),Global.SlotsSoundMgr.playNormalBgm(!0)},.6),t.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowBottomWin(t._freeWin,t._freeWin,!0,function(){Global.TheLegendOfDragon.Collect._reopen?Global.TheLegendOfDragon.Collect.showStore():Global.TheLegendOfDragon.Slots.CanDoNextRound()})},1.5))});case 17:case"end":return n.stop()}},n)}))()},onClickFreeEnd:function(){var e=this;this._freeEndClicked||(this._freeEndClicked=!0,this._free_end.getChildByName("btn_collect").stopAllActions(),Global.TheLegendOfDragon.playEffect("base/common_click"),Global.showAlertAction(this._free,!1,1,.1,function(){e._pop.active=!1,e._free.active=!1,e._free_end.active=!1,Global.TheLegendOfDragon.Logic.showTransition("qieping2"),Global.TheLegendOfDragon.playEffect("base/transition_free"),e._freeEndClicked=!1}),Global.TheLegendOfDragon.playEffect("base/popup_out"),this.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowGameview(!1),Global.TheLegendOfDragon.Slots.Resume(),Global.SlotsSoundMgr.playNormalBgm(!0)},.6),this.scheduleOnce(function(){Global.TheLegendOfDragon.Slots.ShowBottomWin(e._freeWin,e._freeWin,!0,function(){Global.TheLegendOfDragon.Collect._reopen?Global.TheLegendOfDragon.Collect.showStore():Global.TheLegendOfDragon.Slots.CanDoNextRound()})},1.5))},showLizi:function(e,t){var n=cc.find("safe_node/slots/tips",this.node),o=cc.instantiate(n.getChildByName("lizi"));o.parent=this.node,o.position=this.node.convertToNodeSpaceAR(n.convertToWorldSpaceAR(cc.v2(0,0))),o.active=!0,o.opacity=0;var i=this.node.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.v2(0,0)));o.runAction(cc.sequence(cc.delayTime(1.2),cc.fadeIn(0),cc.callFunc(function(){Global.TheLegendOfDragon.playEffect("free/num_fly")}),cc.moveTo(.6,i),cc.callFunc(function(){t&&t()}),cc.destroySelf()))},showAddFreeCnt:function(e){var t=cc.find("safe_node/slots/tips",this.node),n=t.getChildByName("add_free_cnt");t.active=!0,n.active=!0;var o=n.getComponent(sp.Skeleton);o.setAnimation(0,"animation",!1),o.setCompleteListener(function(){t.active=!1,n.active=!1}),Global.TheLegendOfDragon.playEffect("free/free_dialog_more_show"),this.showLizi(cc.find("safe_node/LMSlots_Bottom/free_time",this.node),e)},showAddFreeMulti:function(e,t){var n=1;2==e?n=1:3==e?n=2:5==e?n=3:10==e&&(n=4);var o=cc.find("safe_node/slots/tips",this.node),i=o.getChildByName("add_free_multi");o.active=!0,i.active=!0;var a=i.getComponent(sp.Skeleton);a.setAnimation(0,"animation"+n,!1),a.setCompleteListener(function(){o.active=!1,i.active=!1}),Global.TheLegendOfDragon.playEffect("free/free_dialog_more_show"),this.showLizi(cc.find("safe_node/slots/free_multi",this.node),t)},showWheelStart:function(){var e=cc.find("safe_node/slots/tips",this.node),t=e.getChildByName("wheel_start");e.active=!0,t.active=!0;var n=t.getComponent(sp.Skeleton);n.setAnimation(0,"animation",!1),n.setCompleteListener(function(){e.active=!1,t.active=!1})},showRemoveMini:function(){var e=this._pop;e.active=!0;var t=e.getChildByName("remove_mini");t.active=!0,t.scale=.2,cc.tween(t).to(.25,{scale:1},{easing:"backInOut"}).delay(.7).to(.25,{scale:.2},{easing:"backInOut"}).call(function(){e.active=!1,t.active=!1}).start()},showIncWild:function(){var e=cc.find("safe_node/slots/spr_inc_wild",this.node);e.active=!0,e.scale=0,cc.tween(e).to(.25,{scale:1},{easing:"backInOut"}).delay(1.5).to(.25,{scale:0},{easing:"backInOut"}).call(function(){e.active=!1}).start()}}),cc._RF.pop()},{}],TheLegendOfDragon_Slots:[function(e,t,n){"use strict";function o(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=i(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,c=!0,r=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return c=e.done,e},e:function(e){r=!0,a=e},f:function(){try{c||null==o.return||o.return()}finally{if(r)throw a}}}}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function c(e,t,n,o,i,a,c){try{var r=e[a](c),s=r.value}catch(e){return void n(e)}r.done?t(s):Promise.resolve(s).then(o,i)}function r(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var a=e.apply(t,n);function r(e){c(a,o,i,r,s,"next",e)}function s(e){c(a,o,i,r,s,"throw",e)}r(void 0)})}}cc._RF.push(t,"9db64GfHXxDKJQ53ou7VRz8","TheLegendOfDragon_Slots");cc.Class({extends:e("LMSlots_Slots_Base"),properties:{_ingot:null,_ingotEndPos:null,_result:[]},SetSlotsResult:function(e){var t=this._gameInfo.collect,n=e.length/this._col,o=[];this._result=[];for(var i=0;i<e.length;i++){Math.floor(i/n);var a=i%this._col;if(this._cfg.symbol[e[i]]){var c={};c.sid=e[i],c.data=!1,t&&-1!=t.pos.indexOf(i+1)&&(c.data=!0),o[a]||(o[a]=[]),o[a].unshift(c),this._result[a]||(this._result[a]=[]),this._result[a].unshift(e[i])}}for(var r=0;r<this._reels.length;r++){var s=this._reels[r],l=o[r];s.SetResult(l)}},Sleep:function(e){var t=this;return r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise(function(n,o){t.scheduleOnce(function(){n()},e)}));case 1:case"end":return n.stop()}},n)}))()},AfterSpinEnd:function(){var e=this;return r(regeneratorRuntime.mark(function t(){var n,i,a,c,r,s,l,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e._gameInfo.collect)){t.next=11;break}i=o(n.pos);try{for(i.s();!(a=i.n()).done;)c=a.value,(r=e.GetSymbolByIdx(c))&&(e.ShowIngotFly(r.GetIngotWPos()),r.ShowIngot(!1))}catch(e){i.e(e)}finally{i.f()}return Global.TheLegendOfDragon.playEffect("base/collect"),t.next=7,e.Sleep(.7);case 7:cc.find("collect_progress/bg/icon/spine",e.node).getComponent(sp.Skeleton).setAnimation(0,"animation",!1),cc.vv.gameData.setIngot(n.num),Global.TheLegendOfDragon.Collect.refreshIngotNum();case 11:if(!e._gameInfo.spFree){t.next=14;break}return t.next=14,e.ShowSpecialFree(e._gameInfo.spFree);case 14:return e.ShowWinTrace(),s=cc.vv.gameData.GetGameWin(),l=s,cc.vv.gameData.GetTotalFree()>0&&cc.vv.gameData.GetTotalFree()!=cc.vv.gameData.GetFreeTime()&&(l=cc.vv.gameData.GetGameTotalFreeWin()),t.next=20,new Promise(function(t){e.ShowBottomWin(s,l,!0,t)});case 20:h=!0,cc.vv.gameData.isFirstTriggerFree()&&(h=!1,e._bottomScript.ShowBtnsByState("moveing_1"),Global.TheLegendOfDragon.Pop.showFreeStart(cc.vv.gameData.GetFreeTime(),!1,!1),Global.TheLegendOfDragon.playEffect("base/bell"),e.Backup()),cc.vv.gameData.isLastEndFree()&&(h=!1,e._bottomScript.ShowBtnsByState("moveing_1"),Global.TheLegendOfDragon.Pop.showFreeEnd(cc.vv.gameData.GetGameTotalFreeWin())),1==cc.vv.gameData.getPickState()&&(h=!1,e._bottomScript.ShowBtnsByState("moveing_1"),Global.TheLegendOfDragon.Pop.showPickStart(e._gameInfo.pick)),e._gameInfo.bonus&&(h=!1,e._bottomScript.ShowBtnsByState("moveing_1"),e.OnBonusEnd(e._gameInfo.bonus)),h&&e.CanDoNextRound();case 26:case"end":return t.stop()}},t)}))()},StartMove:function(){this._super(),Global.SlotsSoundMgr.playNormalBgm(),Global.TheLegendOfDragon.Wheel.showEnd();var e=this.node.getChildByName("bonus_tw");this.scheduleOnce(function(){e.active=!0,e.getComponent(sp.Skeleton).setAnimation(0,"animation",!1)},.55)},onMsgSpine:function(e){this._super(e),e.bonus&&this.OnBonusStart(e.bonus),e.item&&Global.TheLegendOfDragon.Collect.onDropItem(e.item.id,e.item.didx)},OnReelSpinEnd:function(e){this._super(e)},OnSpinEnd:function(){this.AfterSpinEnd()},ShowGameview:function(e){if(e){Global.SlotsSoundMgr.playBgm("free/free_bgm");var t=cc.vv.gameData.GetTotalFree(),n=cc.vv.gameData.GetFreeTime();this._bottomScript.ShowFreeModel(!0,t-n,t);var o=cc.vv.gameData.GetTotalFreeWin();this._bottomScript.SetWin(o)}else this._bottomScript.ShowFreeModel(!1),this.node.getChildByName("free_multi").active=!1;var i=cc.find("Canvas/safe_node/bg_base"),a=cc.find("Canvas/safe_node/bg_free");a&&(i&&(i.active=!e),a.active=e)},ShowSpecialFree:function(e){var t=this;return r(regeneratorRuntime.mark(function n(){var o,i,a,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.total_cnt){n.next=6;break}return n.next=3,new Promise(function(e){Global.TheLegendOfDragon.Pop.showAddFreeCnt(e)});case 3:o=cc.vv.gameData.GetTotalFree(),i=cc.vv.gameData.GetFreeTime(),t._bottomScript.ShowFreeModel(!0,o-i,o);case 6:if(!e.total_mul){n.next=13;break}return n.next=9,new Promise(function(t){Global.TheLegendOfDragon.Pop.showAddFreeMulti(e.total_mul,t)});case 9:a=t.node.getChildByName("free_multi"),c=cc.vv.gameData.GetAtlasByName("base"),a.getChildByName("num").getComponent(cc.Sprite).spriteFrame=c.getSpriteFrame("theme177_free_ui_num"+e.total_mul),a.active||(a.opacity=0,a.active=!0,a.runAction(cc.fadeIn(.2)));case 13:case"end":return n.stop()}},n)}))()},ShowIngotFly:function(e){if(this._ingot||(this._ingot=cc.instantiate(this.node.getChildByName("ingot"))),!this._ingotEndPos){var t=cc.find("collect_progress/bg/icon",this.node);this._ingotEndPos=this.node.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.v2(0,0)))}var n=cc.instantiate(this._ingot);n.active=!0,n.getComponent(sp.Skeleton).setAnimation(0,"animation",!0);var o=this.node.convertToNodeSpaceAR(e);n.position=o,n.parent=this.node,n.runAction(cc.sequence(cc.moveTo(.7,this._ingotEndPos),cc.destroySelf()))},ShowBonusWild:function(e,t){var n,i=cc.find("bonus_wilds/layout",this.node),a=o(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;i.getChildByName("w"+c).active=t}}catch(e){a.e(e)}finally{a.f()}},OnBonusStart:function(e){var t=this;return r(regeneratorRuntime.mark(function n(){var o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t._bottomScript.ShowBtnsByState("moveing_1"),t.SetStopTime(20),Global.shakeNode(cc.find("Canvas/safe_node"),8,1),o=cc.vv.gameData.getDragonIdx(),(i=cc.find("Canvas/safe_node/roles/role"+o)).getComponent(sp.Skeleton).setAnimation(0,"attack",!1),i.getComponent(sp.Skeleton).addAnimation(0,"idle",!0),n.next=9,t.Sleep(1.2);case 9:return Global.TheLegendOfDragon.Pop.showWheelStart(),n.next=12,t.Sleep(1);case 12:return cc.find("bonus_wilds",t.node).active=!0,n.next=15,new Promise(function(t){Global.TheLegendOfDragon.Wheel.showSpin(e,t)});case 15:return n.next=17,t.Sleep(1);case 17:1==e.idx?t.ShowBonusWild(e.pos,!0):cc.find("bonus_wilds",t.node).active=!1,t.SetStopTime(3);case 19:case"end":return n.stop()}},n)}))()},OnBonusEnd:function(e){var t=this;return r(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return 1==e.idx&&(t.ShowBonusWild(e.pos,!1),cc.find("bonus_wilds",t.node).active=!1),n.next=3,t.Sleep(1);case 3:t.CanDoNextRound();case 4:case"end":return n.stop()}},n)}))()}}),cc._RF.pop()},{LMSlots_Slots_Base:void 0}],TheLegendOfDragon_Symbol:[function(e,t,n){"use strict";cc._RF.push(t,"d1173zadhxB1LgVA46HhUdR","TheLegendOfDragon_Symbol"),cc.Class({extends:e("LMSlots_Symbol_Base"),properties:{_ingot:null},ingot:function(){return this._ingot||(this._ingot=this.node.getChildByName("ingot")),this._ingot},ShowIngot:function(e){this.ingot().active=e},ShowById:function(e,t){this._super(e,t),this.ShowIngot(t||!1)},GetIngotWPos:function(){return this.ingot().convertToWorldSpaceAR(cc.v2(0,0))},Resume:function(e){this._super(e),this.ShowIngot(!1)},StopMoveBefore:function(){var e=this._id,t=cc.vv.gameData.getGameCfg();if(e>=12&&e<=14&&t.symbol[e]&&t.symbol[e].win_node&&t.symbol[e].win_ani&&(this._showNode&&(this._showNode.active=!1),this._showNode=cc.find(t.symbol[e].win_node,this.node),this._showNode.active=!0,""!=t.symbol[e].win_ani.name)){this.node.zIndex=t.symbol[e].win_ani.zIndex-this._symbolIdx+10*this._reelIdx;var n=this._showNode.getComponent(sp.Skeleton);n&&n.setAnimation(0,t.symbol[e].win_ani.name,!1)}}}),cc._RF.pop()},{LMSlots_Symbol_Base:void 0}],TheLegendOfDragon_Wheel:[function(e,t,n){"use strict";function o(e,t,n,o,i,a,c){try{var r=e[a](c),s=r.value}catch(e){return void n(e)}r.done?t(s):Promise.resolve(s).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var c=e.apply(t,n);function r(e){o(c,i,a,r,s,"next",e)}function s(e){o(c,i,a,r,s,"throw",e)}r(void 0)})}}cc._RF.push(t,"517a9SRfUZDA4vyrHWTcxSf","TheLegendOfDragon_Wheel"),cc.Class({extends:cc.Component,properties:{_data:null,_movenode:null,_wheel:null,_reels:[],_rounds:[],_res:null,_spining:!1,_xjl:null,_show:!1,_onSpinEndCallBack:null},onLoad:function(){this._movenode=cc.find("safe_node/layout/move_node",this.node),this._wheel=cc.find("wheel_game",this._movenode),this._xjl=cc.find("safe_node/xiaojinlong",this.node);for(var e=1;e<=3;e++){for(var t=this._wheel.getChildByName("reel"+e),n=cc.find("mask/holder",t),o=[],i=1;i<=2;i++){var a=n.getChildByName("symbol"+i);o.push(a)}this._reels.push({holder:n,symbols:o,anim1:cc.find("title_bg/anim",t),anim2:cc.find("frame/anim",t)})}},showXiaoJinLong:function(e,t){var n=this;this._xjl.active=!0,this._xjl.scaleX=t||1,this._xjl.getComponent(sp.Skeleton).setAnimation(0,e,!1),this._xjl.getComponent(sp.Skeleton).setCompleteListener(function(){n._xjl.active=!1})},showSpin:function(e,t){var n=this;if(!this._spining){this._show=!0,this._reels[1].symbols[0].getChildByName("what").active=!0,this._reels[1].symbols[0].getChildByName("icon").scale=0,this._reels[2].symbols[0].getChildByName("what").active=!0,this._reels[2].symbols[0].getChildByName("lbl_multipler").scale=0;for(var o=0;o<3;o++)this._reels[o].holder.y=0,this._reels[o].symbols[0].y=0,this._reels[o].symbols[1].y=180;this._res=e,this._onSpinEndCallBack=t,this._rounds=[21,31,41],this._rounds[e.idx-1]+=1,cc.tween(this._movenode).by(2,{position:cc.v2(-1008,0)}).delay(.5).call(function(){n._spining=!0,Global.TheLegendOfDragon.playEffect("base/wheel")}).start(),this.showXiaoJinLong("animation1",-1),Global.TheLegendOfDragon.playEffect("base/dragon_fly")}},showEnd:function(){var e=this;this._show&&(this._show=!1,cc.tween(this._movenode).call(function(){for(var t=0;t<3;t++)e._reels[t].anim1.active=!1,e._reels[t].anim2.active=!1}).by(1.8,{position:cc.v2(1008,0)}).start(),this.showXiaoJinLong("animation1"),Global.TheLegendOfDragon.playEffect("base/jp_move"))},onSpinEnd:function(e){var t=this;return i(regeneratorRuntime.mark(function n(){var o,i,a,c,r,s,l,h,d,f;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:Global.TheLegendOfDragon.playEffect("base/wheel_stop"),e==t._res.idx-1&&((o=t._reels[e]).anim1.active=!0,o.anim2.active=!0),2==e&&(Global.TheLegendOfDragon.stopEffect("base/wheel"),Global.TheLegendOfDragon.playEffect("base/wheel_wild"),t._spining=!1,i=t._res,a=0,c="animation2",r=1,1==i.idx?(c="animation2",a=.1):2==i.idx?((s=t._reels[i.idx-1].symbols[0]).getChildByName("what").active=!1,l=s.getChildByName("icon"),h=cc.vv.gameData.GetAtlasByName("base"),l.getComponent(cc.Sprite).spriteFrame=h.getSpriteFrame("theme177_wheel_ui_s"+i.card),l.scale=0,l.runAction(cc.sequence(cc.scaleTo(.6,1.1),cc.scaleTo(.2,1))),c="animation2",r=-1,a=.8):3==i.idx&&((d=t._reels[i.idx-1].symbols[0]).getChildByName("what").active=!1,(f=d.getChildByName("lbl_multipler")).getComponent(cc.Label).string="X"+i.mul,f.scale=0,f.runAction(cc.sequence(cc.scaleTo(.6,1.1),cc.scaleTo(.2,1))),c="animation3",a=.8),t.scheduleOnce(function(){t.showXiaoJinLong(c,r),Global.TheLegendOfDragon.playEffect("base/bonus_notify"),t._onSpinEndCallBack&&t._onSpinEndCallBack()},a));case 3:case"end":return n.stop()}},n)}))()},update:function(e){if(this._spining)for(var t=0;t<3;t++)if(!(this._rounds[t]<=0)){var n=this._reels[t],o=n.holder.y-1600*e;if(o<=-180){o=0;var i=n.symbols[0].getPosition(),a=cc.v2(i.x,i.y),c=n.symbols[1].getPosition(),r=cc.v2(c.x,c.y);n.symbols[0].position=r,n.symbols[1].position=a,this._rounds[t]-=1,this._rounds[t]<=0&&this.onSpinEnd(t)}n.holder.y=o}}}),cc._RF.pop()},{}]},{},["TheLegendOfDragon_Cfg","TheLegendOfDragon_Collect","TheLegendOfDragon_GameData","TheLegendOfDragon_Logic","TheLegendOfDragon_Pick","TheLegendOfDragon_Pop","TheLegendOfDragon_Slots","TheLegendOfDragon_Symbol","TheLegendOfDragon_Wheel"]);